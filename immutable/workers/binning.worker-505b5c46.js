var f=Object.defineProperty;var g=(e,t,i)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var b=(e,t,i)=>(g(e,typeof t!="symbol"?t+"":t,i),i);(function(){"use strict";class e{constructor(i,n,o,a,s){b(this,"xDomain");b(this,"yDomain");b(this,"binWidth",1);b(this,"binHeight",1);b(this,"_bins",{});this.xDomain=n,this.yDomain=o,this.binWidth=a??this.binWidth,this.binHeight=s??this.binHeight,this.makeBins(),this.binPoints(i)}makeBins(){for(let i=this.xDomain[0],n=this.xDomain[1];i<n;i+=this.binWidth)for(let o=this.yDomain[0],a=this.yDomain[1];o<a;o+=this.binHeight){const s=Math.floor(i/this.binWidth),h=Math.floor(o/this.binHeight),r=s+"-"+h,c=s*this.binWidth,d=h*this.binHeight;this._bins[r]=Object.assign(new Array,{nx:s,ny:h,x:c,y:d})}}binPoints(i){for(const n of i){const o=Math.floor(n.x/this.binWidth),a=Math.floor(n.y/this.binHeight),s=o+"-"+a,h=this._bins[s];if(h===void 0)throw`Error: Could not find bin for point with id ${s}`;h.push(n)}}get bins(){return Object.values(this._bins).filter(i=>i.length>0)}}addEventListener("message",t=>{if(t.data.command==="getBins"){const{drawings:i,side:n,binWidth:o,binHeight:a,width:s,height:h}=t.data.params;if(i.length===0){self.postMessage({event:"bins",params:{side:n,bins:[]}});return}let r=[];for(const d of i)d.drawnPoints&&(r=[...r,...d.drawnPoints]);const c=new e(r,[0,s],[0,h],o,a);self.postMessage({event:"bins",params:{side:n,bins:c.bins}})}})})();
