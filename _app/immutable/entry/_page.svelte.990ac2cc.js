var kf=Object.defineProperty;var $f=(i,e,t)=>e in i?kf(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var bt=(i,e,t)=>($f(i,typeof e!="symbol"?e+"":e,t),t);import{_ as hs}from"../chunks/preload-helper.41c905a7.js";import{J as yf,S as rt,i as nt,s as He,k as ee,q as xe,a as be,l as te,m as q,r as Ue,h as C,c as _e,n as E,K as dt,b as X,G as N,L as $t,u as yt,g as R,v as it,d as z,f as ot,M as on,N as Cf,C as lr,D as ir,E as or,F as fr,O as Ef,w as lt,P as Mf,Q as Ar,H as je,R as Ff,p as ln,T as mr,e as Ke,U as ur,V as Ht,y as he,z as ge,A as pe,W as fn,X as un,B as de,Y as Pr,Z as If,_ as ct,$ as ht,a0 as gs,o as Sr,a1 as Ma}from"../chunks/index.61358ee6.js";var ps=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ds(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var vs={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(i,e){(function(t,r){i.exports=r()})(ps,function t(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},n=!r.document&&!!r.postMessage,s=r.IS_PAPA_WORKER||!1,o={},c=0,f={parse:function(m,v){var M=(v=v||{}).dynamicTyping||!1;if(W(M)&&(v.dynamicTypingFunction=M,M={}),v.dynamicTyping=M,v.transform=!!W(v.transform)&&v.transform,v.worker&&f.WORKERS_SUPPORTED){var B=function(){if(!f.WORKERS_SUPPORTED)return!1;var re=(Re=r.URL||r.webkitURL||null,De=t.toString(),f.BLOB_URL||(f.BLOB_URL=Re.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",De,")();"],{type:"text/javascript"})))),oe=new r.Worker(re),Re,De;return oe.onmessage=ie,oe.id=c++,o[oe.id]=oe}();return B.userStep=v.step,B.userChunk=v.chunk,B.userComplete=v.complete,B.userError=v.error,v.step=W(v.step),v.chunk=W(v.chunk),v.complete=W(v.complete),v.error=W(v.error),delete v.worker,void B.postMessage({input:m,config:v,workerId:B.id})}var j=null;return f.NODE_STREAM_INPUT,typeof m=="string"?(m=function(re){return re.charCodeAt(0)===65279?re.slice(1):re}(m),j=v.download?new w(v):new T(v)):m.readable===!0&&W(m.read)&&W(m.on)?j=new J(v):(r.File&&m instanceof File||m instanceof Object)&&(j=new k(v)),j.stream(m)},unparse:function(m,v){var M=!1,B=!0,j=",",re=`\r
`,oe='"',Re=oe+oe,De=!1,Z=null,Te=!1;(function(){if(typeof v=="object"){if(typeof v.delimiter!="string"||f.BAD_DELIMITERS.filter(function(Y){return v.delimiter.indexOf(Y)!==-1}).length||(j=v.delimiter),(typeof v.quotes=="boolean"||typeof v.quotes=="function"||Array.isArray(v.quotes))&&(M=v.quotes),typeof v.skipEmptyLines!="boolean"&&typeof v.skipEmptyLines!="string"||(De=v.skipEmptyLines),typeof v.newline=="string"&&(re=v.newline),typeof v.quoteChar=="string"&&(oe=v.quoteChar),typeof v.header=="boolean"&&(B=v.header),Array.isArray(v.columns)){if(v.columns.length===0)throw new Error("Option columns is empty");Z=v.columns}v.escapeChar!==void 0&&(Re=v.escapeChar+oe),(typeof v.escapeFormulae=="boolean"||v.escapeFormulae instanceof RegExp)&&(Te=v.escapeFormulae instanceof RegExp?v.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var ae=new RegExp(ne(oe),"g");if(typeof m=="string"&&(m=JSON.parse(m)),Array.isArray(m)){if(!m.length||Array.isArray(m[0]))return at(null,m,De);if(typeof m[0]=="object")return at(Z||Object.keys(m[0]),m,De)}else if(typeof m=="object")return typeof m.data=="string"&&(m.data=JSON.parse(m.data)),Array.isArray(m.data)&&(m.fields||(m.fields=m.meta&&m.meta.fields||Z),m.fields||(m.fields=Array.isArray(m.data[0])?m.fields:typeof m.data[0]=="object"?Object.keys(m.data[0]):[]),Array.isArray(m.data[0])||typeof m.data[0]=="object"||(m.data=[m.data])),at(m.fields||[],m.data||[],De);throw new Error("Unable to serialize unrecognized input");function at(Y,we,U){var H="";typeof Y=="string"&&(Y=JSON.parse(Y)),typeof we=="string"&&(we=JSON.parse(we));var fe=Array.isArray(Y)&&0<Y.length,Se=!Array.isArray(we[0]);if(fe&&B){for(var ke=0;ke<Y.length;ke++)0<ke&&(H+=j),H+=Ve(Y[ke],ke);0<we.length&&(H+=re)}for(var K=0;K<we.length;K++){var $e=fe?Y.length:we[K].length,Me=!1,Ge=fe?Object.keys(we[K]).length===0:we[K].length===0;if(U&&!fe&&(Me=U==="greedy"?we[K].join("").trim()==="":we[K].length===1&&we[K][0].length===0),U==="greedy"&&fe){for(var Be=[],Ye=0;Ye<$e;Ye++){var qe=Se?Y[Ye]:Ye;Be.push(we[K][qe])}Me=Be.join("").trim()===""}if(!Me){for(var Oe=0;Oe<$e;Oe++){0<Oe&&!Ge&&(H+=j);var vt=fe&&Se?Y[Oe]:Oe;H+=Ve(we[K][vt],Oe)}K<we.length-1&&(!U||0<$e&&!Ge)&&(H+=re)}}return H}function Ve(Y,we){if(Y==null)return"";if(Y.constructor===Date)return JSON.stringify(Y).slice(1,25);var U=!1;Te&&typeof Y=="string"&&Te.test(Y)&&(Y="'"+Y,U=!0);var H=Y.toString().replace(ae,Re);return(U=U||M===!0||typeof M=="function"&&M(Y,we)||Array.isArray(M)&&M[we]||function(fe,Se){for(var ke=0;ke<Se.length;ke++)if(-1<fe.indexOf(Se[ke]))return!0;return!1}(H,f.BAD_DELIMITERS)||-1<H.indexOf(j)||H.charAt(0)===" "||H.charAt(H.length-1)===" ")?oe+H+oe:H}}};if(f.RECORD_SEP=String.fromCharCode(30),f.UNIT_SEP=String.fromCharCode(31),f.BYTE_ORDER_MARK="\uFEFF",f.BAD_DELIMITERS=["\r",`
`,'"',f.BYTE_ORDER_MARK],f.WORKERS_SUPPORTED=!n&&!!r.Worker,f.NODE_STREAM_INPUT=1,f.LocalChunkSize=10485760,f.RemoteChunkSize=5242880,f.DefaultDelimiter=",",f.Parser=le,f.ParserHandle=I,f.NetworkStreamer=w,f.FileStreamer=k,f.StringStreamer=T,f.ReadableStreamStreamer=J,r.jQuery){var h=r.jQuery;h.fn.parse=function(m){var v=m.config||{},M=[];return this.each(function(re){if(!(h(this).prop("tagName").toUpperCase()==="INPUT"&&h(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var oe=0;oe<this.files.length;oe++)M.push({file:this.files[oe],inputElem:this,instanceConfig:h.extend({},v)})}),B(),this;function B(){if(M.length!==0){var re,oe,Re,De,Z=M[0];if(W(m.before)){var Te=m.before(Z.file,Z.inputElem);if(typeof Te=="object"){if(Te.action==="abort")return re="AbortError",oe=Z.file,Re=Z.inputElem,De=Te.reason,void(W(m.error)&&m.error({name:re},oe,Re,De));if(Te.action==="skip")return void j();typeof Te.config=="object"&&(Z.instanceConfig=h.extend(Z.instanceConfig,Te.config))}else if(Te==="skip")return void j()}var ae=Z.instanceConfig.complete;Z.instanceConfig.complete=function(at){W(ae)&&ae(at,Z.file,Z.inputElem),j()},f.parse(Z.file,Z.instanceConfig)}else W(m.complete)&&m.complete()}function j(){M.splice(0,1),B()}}}function p(m){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(v){var M=x(v);M.chunkSize=parseInt(M.chunkSize),v.step||v.chunk||(M.chunkSize=null),this._handle=new I(M),(this._handle.streamer=this)._config=M}.call(this,m),this.parseChunk=function(v,M){if(this.isFirstChunk&&W(this._config.beforeFirstChunk)){var B=this._config.beforeFirstChunk(v);B!==void 0&&(v=B)}this.isFirstChunk=!1,this._halted=!1;var j=this._partialLine+v;this._partialLine="";var re=this._handle.parse(j,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var oe=re.meta.cursor;this._finished||(this._partialLine=j.substring(oe-this._baseIndex),this._baseIndex=oe),re&&re.data&&(this._rowCount+=re.data.length);var Re=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)r.postMessage({results:re,workerId:f.WORKER_ID,finished:Re});else if(W(this._config.chunk)&&!M){if(this._config.chunk(re,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);re=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(re.data),this._completeResults.errors=this._completeResults.errors.concat(re.errors),this._completeResults.meta=re.meta),this._completed||!Re||!W(this._config.complete)||re&&re.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),Re||re&&re.meta.paused||this._nextChunk(),re}this._halted=!0},this._sendError=function(v){W(this._config.error)?this._config.error(v):s&&this._config.error&&r.postMessage({workerId:f.WORKER_ID,error:v,finished:!1})}}function w(m){var v;(m=m||{}).chunkSize||(m.chunkSize=f.RemoteChunkSize),p.call(this,m),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(M){this._input=M,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(v=new XMLHttpRequest,this._config.withCredentials&&(v.withCredentials=this._config.withCredentials),n||(v.onload=S(this._chunkLoaded,this),v.onerror=S(this._chunkError,this)),v.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var M=this._config.downloadRequestHeaders;for(var B in M)v.setRequestHeader(B,M[B])}if(this._config.chunkSize){var j=this._start+this._config.chunkSize-1;v.setRequestHeader("Range","bytes="+this._start+"-"+j)}try{v.send(this._config.downloadRequestBody)}catch(re){this._chunkError(re.message)}n&&v.status===0&&this._chunkError()}},this._chunkLoaded=function(){v.readyState===4&&(v.status<200||400<=v.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:v.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(M){var B=M.getResponseHeader("Content-Range");return B===null?-1:parseInt(B.substring(B.lastIndexOf("/")+1))}(v),this.parseChunk(v.responseText)))},this._chunkError=function(M){var B=v.statusText||M;this._sendError(new Error(B))}}function k(m){var v,M;(m=m||{}).chunkSize||(m.chunkSize=f.LocalChunkSize),p.call(this,m);var B=typeof FileReader<"u";this.stream=function(j){this._input=j,M=j.slice||j.webkitSlice||j.mozSlice,B?((v=new FileReader).onload=S(this._chunkLoaded,this),v.onerror=S(this._chunkError,this)):v=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var j=this._input;if(this._config.chunkSize){var re=Math.min(this._start+this._config.chunkSize,this._input.size);j=M.call(j,this._start,re)}var oe=v.readAsText(j,this._config.encoding);B||this._chunkLoaded({target:{result:oe}})},this._chunkLoaded=function(j){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(j.target.result)},this._chunkError=function(){this._sendError(v.error)}}function T(m){var v;p.call(this,m=m||{}),this.stream=function(M){return v=M,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var M,B=this._config.chunkSize;return B?(M=v.substring(0,B),v=v.substring(B)):(M=v,v=""),this._finished=!v,this.parseChunk(M)}}}function J(m){p.call(this,m=m||{});var v=[],M=!0,B=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(j){this._input=j,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){B&&v.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),v.length?this.parseChunk(v.shift()):M=!0},this._streamData=S(function(j){try{v.push(typeof j=="string"?j:j.toString(this._config.encoding)),M&&(M=!1,this._checkIsFinished(),this.parseChunk(v.shift()))}catch(re){this._streamError(re)}},this),this._streamError=S(function(j){this._streamCleanUp(),this._sendError(j)},this),this._streamEnd=S(function(){this._streamCleanUp(),B=!0,this._streamData("")},this),this._streamCleanUp=S(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function I(m){var v,M,B,j=Math.pow(2,53),re=-j,oe=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Re=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,De=this,Z=0,Te=0,ae=!1,at=!1,Ve=[],Y={data:[],errors:[],meta:{}};if(W(m.step)){var we=m.step;m.step=function(K){if(Y=K,fe())H();else{if(H(),Y.data.length===0)return;Z+=K.data.length,m.preview&&Z>m.preview?M.abort():(Y.data=Y.data[0],we(Y,De))}}}function U(K){return m.skipEmptyLines==="greedy"?K.join("").trim()==="":K.length===1&&K[0].length===0}function H(){return Y&&B&&(ke("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+f.DefaultDelimiter+"'"),B=!1),m.skipEmptyLines&&(Y.data=Y.data.filter(function(K){return!U(K)})),fe()&&function(){if(!Y)return;function K(Me,Ge){W(m.transformHeader)&&(Me=m.transformHeader(Me,Ge)),Ve.push(Me)}if(Array.isArray(Y.data[0])){for(var $e=0;fe()&&$e<Y.data.length;$e++)Y.data[$e].forEach(K);Y.data.splice(0,1)}else Y.data.forEach(K)}(),function(){if(!Y||!m.header&&!m.dynamicTyping&&!m.transform)return Y;function K(Me,Ge){var Be,Ye=m.header?{}:[];for(Be=0;Be<Me.length;Be++){var qe=Be,Oe=Me[Be];m.header&&(qe=Be>=Ve.length?"__parsed_extra":Ve[Be]),m.transform&&(Oe=m.transform(Oe,qe)),Oe=Se(qe,Oe),qe==="__parsed_extra"?(Ye[qe]=Ye[qe]||[],Ye[qe].push(Oe)):Ye[qe]=Oe}return m.header&&(Be>Ve.length?ke("FieldMismatch","TooManyFields","Too many fields: expected "+Ve.length+" fields but parsed "+Be,Te+Ge):Be<Ve.length&&ke("FieldMismatch","TooFewFields","Too few fields: expected "+Ve.length+" fields but parsed "+Be,Te+Ge)),Ye}var $e=1;return!Y.data.length||Array.isArray(Y.data[0])?(Y.data=Y.data.map(K),$e=Y.data.length):Y.data=K(Y.data,0),m.header&&Y.meta&&(Y.meta.fields=Ve),Te+=$e,Y}()}function fe(){return m.header&&Ve.length===0}function Se(K,$e){return Me=K,m.dynamicTypingFunction&&m.dynamicTyping[Me]===void 0&&(m.dynamicTyping[Me]=m.dynamicTypingFunction(Me)),(m.dynamicTyping[Me]||m.dynamicTyping)===!0?$e==="true"||$e==="TRUE"||$e!=="false"&&$e!=="FALSE"&&(function(Ge){if(oe.test(Ge)){var Be=parseFloat(Ge);if(re<Be&&Be<j)return!0}return!1}($e)?parseFloat($e):Re.test($e)?new Date($e):$e===""?null:$e):$e;var Me}function ke(K,$e,Me,Ge){var Be={type:K,code:$e,message:Me};Ge!==void 0&&(Be.row=Ge),Y.errors.push(Be)}this.parse=function(K,$e,Me){var Ge=m.quoteChar||'"';if(m.newline||(m.newline=function(qe,Oe){qe=qe.substring(0,1048576);var vt=new RegExp(ne(Oe)+"([^]*?)"+ne(Oe),"gm"),st=(qe=qe.replace(vt,"")).split("\r"),_t=qe.split(`
`),wt=1<_t.length&&_t[0].length<st[0].length;if(st.length===1||wt)return`
`;for(var ft=0,Ne=0;Ne<st.length;Ne++)st[Ne][0]===`
`&&ft++;return ft>=st.length/2?`\r
`:"\r"}(K,Ge)),B=!1,m.delimiter)W(m.delimiter)&&(m.delimiter=m.delimiter(K),Y.meta.delimiter=m.delimiter);else{var Be=function(qe,Oe,vt,st,_t){var wt,ft,Ne,We;_t=_t||[",","	","|",";",f.RECORD_SEP,f.UNIT_SEP];for(var At=0;At<_t.length;At++){var Ie=_t[At],Lt=0,kt=0,Pt=0;Ne=void 0;for(var Ct=new le({comments:st,delimiter:Ie,newline:Oe,preview:10}).parse(qe),Et=0;Et<Ct.data.length;Et++)if(vt&&U(Ct.data[Et]))Pt++;else{var St=Ct.data[Et].length;kt+=St,Ne!==void 0?0<St&&(Lt+=Math.abs(St-Ne),Ne=St):Ne=St}0<Ct.data.length&&(kt/=Ct.data.length-Pt),(ft===void 0||Lt<=ft)&&(We===void 0||We<kt)&&1.99<kt&&(ft=Lt,wt=Ie,We=kt)}return{successful:!!(m.delimiter=wt),bestDelimiter:wt}}(K,m.newline,m.skipEmptyLines,m.comments,m.delimitersToGuess);Be.successful?m.delimiter=Be.bestDelimiter:(B=!0,m.delimiter=f.DefaultDelimiter),Y.meta.delimiter=m.delimiter}var Ye=x(m);return m.preview&&m.header&&Ye.preview++,v=K,M=new le(Ye),Y=M.parse(v,$e,Me),H(),ae?{meta:{paused:!0}}:Y||{meta:{paused:!1}}},this.paused=function(){return ae},this.pause=function(){ae=!0,M.abort(),v=W(m.chunk)?"":v.substring(M.getCharIndex())},this.resume=function(){De.streamer._halted?(ae=!1,De.streamer.parseChunk(v,!0)):setTimeout(De.resume,3)},this.aborted=function(){return at},this.abort=function(){at=!0,M.abort(),Y.meta.aborted=!0,W(m.complete)&&m.complete(Y),v=""}}function ne(m){return m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function le(m){var v,M=(m=m||{}).delimiter,B=m.newline,j=m.comments,re=m.step,oe=m.preview,Re=m.fastMode,De=v=m.quoteChar===void 0||m.quoteChar===null?'"':m.quoteChar;if(m.escapeChar!==void 0&&(De=m.escapeChar),(typeof M!="string"||-1<f.BAD_DELIMITERS.indexOf(M))&&(M=","),j===M)throw new Error("Comment character same as delimiter");j===!0?j="#":(typeof j!="string"||-1<f.BAD_DELIMITERS.indexOf(j))&&(j=!1),B!==`
`&&B!=="\r"&&B!==`\r
`&&(B=`
`);var Z=0,Te=!1;this.parse=function(ae,at,Ve){if(typeof ae!="string")throw new Error("Input must be a string");var Y=ae.length,we=M.length,U=B.length,H=j.length,fe=W(re),Se=[],ke=[],K=[],$e=Z=0;if(!ae)return gt();if(m.header&&!at){var Me=ae.split(B)[0].split(M),Ge=[],Be={},Ye=!1;for(var qe in Me){var Oe=Me[qe];W(m.transformHeader)&&(Oe=m.transformHeader(Oe,qe));var vt=Oe,st=Be[Oe]||0;for(0<st&&(Ye=!0,vt=Oe+"_"+st),Be[Oe]=st+1;Ge.includes(vt);)vt=vt+"_"+st;Ge.push(vt)}if(Ye){var _t=ae.split(B);_t[0]=Ge.join(M),ae=_t.join(B)}}if(Re||Re!==!1&&ae.indexOf(v)===-1){for(var wt=ae.split(B),ft=0;ft<wt.length;ft++){if(K=wt[ft],Z+=K.length,ft!==wt.length-1)Z+=B.length;else if(Ve)return gt();if(!j||K.substring(0,H)!==j){if(fe){if(Se=[],Pt(K.split(M)),Ut(),Te)return gt()}else Pt(K.split(M));if(oe&&oe<=ft)return Se=Se.slice(0,oe),gt(!0)}}return gt()}for(var Ne=ae.indexOf(M,Z),We=ae.indexOf(B,Z),At=new RegExp(ne(De)+ne(v),"g"),Ie=ae.indexOf(v,Z);;)if(ae[Z]!==v)if(j&&K.length===0&&ae.substring(Z,Z+H)===j){if(We===-1)return gt();Z=We+U,We=ae.indexOf(B,Z),Ne=ae.indexOf(M,Z)}else if(Ne!==-1&&(Ne<We||We===-1))K.push(ae.substring(Z,Ne)),Z=Ne+we,Ne=ae.indexOf(M,Z);else{if(We===-1)break;if(K.push(ae.substring(Z,We)),St(We+U),fe&&(Ut(),Te))return gt();if(oe&&Se.length>=oe)return gt(!0)}else for(Ie=Z,Z++;;){if((Ie=ae.indexOf(v,Ie+1))===-1)return Ve||ke.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Se.length,index:Z}),Et();if(Ie===Y-1)return Et(ae.substring(Z,Ie).replace(At,v));if(v!==De||ae[Ie+1]!==De){if(v===De||Ie===0||ae[Ie-1]!==De){Ne!==-1&&Ne<Ie+1&&(Ne=ae.indexOf(M,Ie+1)),We!==-1&&We<Ie+1&&(We=ae.indexOf(B,Ie+1));var Lt=Ct(We===-1?Ne:Math.min(Ne,We));if(ae.substr(Ie+1+Lt,we)===M){K.push(ae.substring(Z,Ie).replace(At,v)),ae[Z=Ie+1+Lt+we]!==v&&(Ie=ae.indexOf(v,Z)),Ne=ae.indexOf(M,Z),We=ae.indexOf(B,Z);break}var kt=Ct(We);if(ae.substring(Ie+1+kt,Ie+1+kt+U)===B){if(K.push(ae.substring(Z,Ie).replace(At,v)),St(Ie+1+kt+U),Ne=ae.indexOf(M,Z),Ie=ae.indexOf(v,Z),fe&&(Ut(),Te))return gt();if(oe&&Se.length>=oe)return gt(!0);break}ke.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Se.length,index:Z}),Ie++}}else Ie++}return Et();function Pt(ut){Se.push(ut),$e=Z}function Ct(ut){var br=0;if(ut!==-1){var hr=ae.substring(Ie+1,ut);hr&&hr.trim()===""&&(br=hr.length)}return br}function Et(ut){return Ve||(ut===void 0&&(ut=ae.substring(Z)),K.push(ut),Z=Y,Pt(K),fe&&Ut()),gt()}function St(ut){Z=ut,Pt(K),K=[],We=ae.indexOf(B,Z)}function gt(ut){return{data:Se,errors:ke,meta:{delimiter:M,linebreak:B,aborted:Te,truncated:!!ut,cursor:$e+(at||0)}}}function Ut(){re(gt()),Se=[],ke=[]}},this.abort=function(){Te=!0},this.getCharIndex=function(){return Z}}function ie(m){var v=m.data,M=o[v.workerId],B=!1;if(v.error)M.userError(v.error,v.file);else if(v.results&&v.results.data){var j={abort:function(){B=!0,O(v.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:P,resume:P};if(W(M.userStep)){for(var re=0;re<v.results.data.length&&(M.userStep({data:v.results.data[re],errors:v.results.errors,meta:v.results.meta},j),!B);re++);delete v.results}else W(M.userChunk)&&(M.userChunk(v.results,j,v.file),delete v.results)}v.finished&&!B&&O(v.workerId,v.results)}function O(m,v){var M=o[m];W(M.userComplete)&&M.userComplete(v),M.terminate(),delete o[m]}function P(){throw new Error("Not implemented.")}function x(m){if(typeof m!="object"||m===null)return m;var v=Array.isArray(m)?[]:{};for(var M in m)v[M]=x(m[M]);return v}function S(m,v){return function(){m.apply(v,arguments)}}function W(m){return typeof m=="function"}return s&&(r.onmessage=function(m){var v=m.data;if(f.WORKER_ID===void 0&&v&&(f.WORKER_ID=v.workerId),typeof v.input=="string")r.postMessage({workerId:f.WORKER_ID,results:f.parse(v.input,v.config),finished:!0});else if(r.File&&v.input instanceof File||v.input instanceof Object){var M=f.parse(v.input,v.config);M&&r.postMessage({workerId:f.WORKER_ID,results:M,finished:!0})}}),(w.prototype=Object.create(p.prototype)).constructor=w,(k.prototype=Object.create(p.prototype)).constructor=k,(T.prototype=Object.create(T.prototype)).constructor=T,(J.prototype=Object.create(p.prototype)).constructor=J,f})})(vs);var Af=vs.exports;const Fa=ds(Af),Pf=""+new URL("../assets/female_front.cbbf7559.svg",import.meta.url).href,Sf=""+new URL("../assets/female_back.f4b0cc86.svg",import.meta.url).href,Lf=""+new URL("../assets/male_front.dc1ca7a4.svg",import.meta.url).href,Df=""+new URL("../assets/male_back.27c5d660.svg",import.meta.url).href,ms={FemaleFront:Pf,FemaleBack:Sf,MaleFront:Lf,MaleBack:Df},nr=class{constructor(){bt(this,"canvases",{});bt(this,"loadingPromises",{})}static getInstance(){return nr.instance||(nr.instance=new nr),nr.instance}async loadPersonaCanvas(e){return new Promise((t,r)=>{const n=new Image;n.onload=async()=>{try{const s=new OffscreenCanvas(n.naturalWidth,n.naturalHeight),o=s.getContext("2d");if(!o)throw new Error("Could not get canvas context");o.drawImage(n,0,0),this.canvases[e]=s,t(s)}catch(s){r(s)}},n.onerror=()=>{r(new Error(`Failed to load persona image: ${e}`))},n.src=ms[e]})}async getBitmap(e){const t=await this.getCanvas(e);return createImageBitmap(t)}async getCanvas(e){if(this.canvases[e])return this.canvases[e];if(this.loadingPromises[e])return this.loadingPromises[e];this.loadingPromises[e]=this.loadPersonaCanvas(e);try{const t=await this.loadingPromises[e];return delete this.loadingPromises[e],t}catch(t){throw delete this.loadingPromises[e],t}}async getPersonaBitmaps(e){const t=`${e}Front`,r=`${e}Back`,[n,s]=await Promise.all([this.getBitmap(t),this.getBitmap(r)]);return{frontBitmap:n,backBitmap:s}}async preloadAllCanvases(){const e=["FemaleFront","FemaleBack","MaleFront","MaleBack"];await Promise.all(e.map(t=>this.getCanvas(t)))}getLoadedCanvases(){return{...this.canvases}}clearCache(){this.canvases={},this.loadingPromises={}}};let Ir=nr;bt(Ir,"instance");const zt=Ir.getInstance();var Xe=(i=>(i.LookingGlass="Looking Glass",i.DensityMap="Density Map",i.ValenceMap="Valence Map",i))(Xe||{});function Bf(i){i.classList.remove("hidden");const{width:e,height:t}=i.getBoundingClientRect();return i.classList.add("hidden"),{newWidth:e,newHeight:t,imgWidth:i.naturalWidth,imgHeight:i.naturalHeight}}function Rf(i,e,t){const r=i.getContext("2d");if(r==null)throw"Could not get context while resizing the canvas.";const n=window.devicePixelRatio||1;i.width=e*n,i.height=t*n,r.scale(n,n)}function Ia(i,e,t,r){const n=e.getContext("2d");if(n==null)throw"Could not get context while drawing persona on the canvas.";i.classList.remove("hidden"),n.drawImage(i,0,0,t,r),n.globalCompositeOperation="source-atop",i.classList.add("hidden")}function bs(i,e,t,r){if(i.length<2)return;e.lineJoin="round",e.lineCap="round",t&&(e.strokeStyle=t),r&&(e.lineWidth=r);let n=i[0],s=i[1];e.beginPath(),e.moveTo(s.x,s.y);for(let o=1;o<i.length;o++){const c=Tf(n,s);e.quadraticCurveTo(n.x,n.y,c.x,c.y),n=i[o],s=i[o+1]}n.x+=.1,n.y+=.1,e.lineTo(n.x,n.y),e.stroke()}function Tf(i,e){return{x:i.x+(e.x-i.x)/2,y:i.y+(e.y-i.y)/2}}function Of(i,e,t){const r=e.getContext("2d",{alpha:!1});if(r==null)throw"Could not get context to draw strokes.";for(const n of i){let s=n.points,o=n.brushSize;t!==void 0&&(s=_s(n.points,t),o*=t),bs(s,r,n.brushColor,o)}}function _s(i,e){return i.map(t=>({x:t.x*e,y:t.y*e}))}function Nf(i){return i.FemaleFront?"Female":"Male"}const Aa=(i,e)=>{const t=new OffscreenCanvas(i,e),r=t.getContext("2d");if(!r)throw new Error("Could not get canvas context");return[t,r]},zf=(i,e,t,r)=>{const n=e.includes("Front")?t:r;i.drawImage(n,0,0)},ws=(i,e,t)=>{const r=i.getImageData(0,0,e,t);return new Uint32Array(r.data.buffer)},xf=(i,e)=>({x:Math.floor(i/4)%e,y:Math.floor(i/4/e)}),Uf=(i,e)=>{const t=i>>>24&255,r=e>>>24&255;return t>0&&r>0},jf=i=>({valence:i.valence,intensity:i.intensity}),Gf=(i,e,t,r,n,s)=>{Of([i],r);const o=ws(t,n,s),c=jf(i),f={};for(let h=0;h<o.length;h++)if(Uf(e[h],o[h])){const{x:p,y:w}=xf(h,n);f[p]??(f[p]={}),f[p][w]=c}return f},qf=i=>i.reduce((e,t)=>(Object.entries(t).forEach(([r,n])=>{var s;e[s=parseInt(r)]??(e[s]={}),Object.entries(n).forEach(([o,c])=>{e[parseInt(r)][parseInt(o)]=c})}),e),{}),Wf=i=>{const e={},t=[];let r=0;return Object.entries(i).forEach(([n,s])=>{const o=parseInt(n);Object.entries(s).forEach(([c,f])=>{const h=parseInt(c);t.push({x:o,y:h,...f});const p=`${f.valence}:${f.intensity}`;e[p]=(e[p]??0)+1,r++})}),{areas:e,totalDrawingArea:r,drawnPoints:t}},Hf=(i,e,t,r)=>{const{imgWidth:n,imgHeight:s}=i,[o,c]=Aa(n,s),[f,h]=Aa(n,s);zf(c,e,t,r);const p=ws(c,n,s),w=i.strokes.map(T=>Gf(T,p,h,f,n,s)),k=qf(w);return Wf(k)},Vf=(i,e,t)=>{let r={},n=0;const s={...i};return Object.entries(i).forEach(([o,c])=>{if(!c)return;const f=Hf(c,o,e,t);Object.entries(f.areas).forEach(([h,p])=>{r[h]=(r[h]??0)+p}),n+=f.totalDrawingArea,s[o]={...c,sensationPixelMap:Yf(f.drawnPoints,c.imgWidth),drawnPoints:f.drawnPoints}}),{areas:r,totalDrawingArea:n,updatedDrawing:s}},Yf=(i,e)=>{const t={};return i.forEach(r=>{var n;t[n=r.x]??(t[n]={}),t[r.x][r.y]={valence:r.valence,intensity:r.intensity}}),t};class vr{constructor({id:e,drawing:t,areas:r={},totalDrawingArea:n=0,computed:s=!1}){bt(this,"id");bt(this,"persona");bt(this,"drawing");bt(this,"areas");bt(this,"totalDrawingArea");bt(this,"computed");this.id=e,this.drawing=t,this.persona=Nf(t),this.areas=r,this.totalDrawingArea=n,this.computed=s}computeStrokeAreas(e,t){const r=Vf(this.drawing,e,t);return new vr({id:this.id,drawing:r.updatedDrawing,areas:r.areas,totalDrawingArea:r.totalDrawingArea,computed:!0})}}class Qf{constructor(){bt(this,"participants",{});bt(this,"personas",{Female:[],Male:[]});bt(this,"drawingsPerSide",{})}addParticipant(e){this.participants[e.id]=e,this.personas[e.persona].push(e),this.classifyDrawing(e.drawing)}updateParticipant(e){if(!this.participants[e.id])throw new Error(`Participant with id ${e.id} not found`);this.participants[e.id]=e;const r=this.personas[e.persona],n=r.findIndex(s=>s.id===e.id);n!==-1&&(r[n]=e)}getParticipant(e){return this.participants[e]}isParticipantComputed(e){const t=this.participants[e];return t?t.computed:!1}classifyDrawing(e){for(const t of Object.keys(e)){const r=t,n=this.drawingsPerSide[r]??[];n.push(e),this.drawingsPerSide[r]=n}}}function Xf(i,{delay:e=0,duration:t=400,easing:r=yf}={}){const n=+getComputedStyle(i).opacity;return{delay:e,duration:t,easing:r,css:s=>`opacity: ${s*n}`}}function Pa(i){let e,t,r;const n=i[8].default,s=lr(n,i,i[7],null);return{c(){e=ee("ul"),s&&s.c(),this.h()},l(o){e=te(o,"UL",{class:!0});var c=q(e);s&&s.l(c),c.forEach(C),this.h()},h(){E(e,"class","absolute top-full left-0 w-48 p-1 bg-neutral-700 shadow")},m(o,c){X(o,e,c),s&&s.m(e,null),r=!0},p(o,c){s&&s.p&&(!r||c&128)&&ir(s,n,o,o[7],r?fr(n,o[7],c,null):or(o[7]),null)},i(o){r||(R(s,o),t&&t.end(1),r=!0)},o(o){z(s,o),t=Ef(e,Xf,{duration:100}),r=!1},d(o){o&&C(e),s&&s.d(o),o&&t&&t.end()}}}function Jf(i){let e,t,r,n,s,o,c,f=i[0]&&Pa(i);return{c(){e=ee("div"),t=ee("button"),r=xe(i[1]),n=be(),f&&f.c(),this.h()},l(h){e=te(h,"DIV",{class:!0});var p=q(e);t=te(p,"BUTTON",{class:!0});var w=q(t);r=Ue(w,i[1]),w.forEach(C),n=_e(p),f&&f.l(p),p.forEach(C),this.h()},h(){E(t,"class","h-full px-3 text-neutral-100 text-xs"),dt(t,"bg-neutral-700",i[0]),E(e,"class","relative flex items-center h-full")},m(h,p){X(h,e,p),N(e,t),N(t,r),N(e,n),f&&f.m(e,null),i[9](e),s=!0,o||(c=[$t(window,"click",i[4]),$t(t,"click",i[3])],o=!0)},p(h,[p]){(!s||p&2)&&yt(r,h[1]),(!s||p&1)&&dt(t,"bg-neutral-700",h[0]),h[0]?f?(f.p(h,p),p&1&&R(f,1)):(f=Pa(h),f.c(),R(f,1),f.m(e,null)):f&&(it(),z(f,1,1,()=>{f=null}),ot())},i(h){s||(R(f),s=!0)},o(h){z(f),s=!1},d(h){h&&C(e),f&&f.d(),i[9](null),o=!1,on(c)}}}function Zf(i,e,t){let{$$slots:r={},$$scope:n}=e,{title:s}=e,{isOpen:o=!1}=e,{enableIcon:c=!1}=e;function f(){t(0,o=!1)}let h;Cf("menu",{enableIcon:c});function p(){t(0,o=!o)}function w(T){T.target instanceof Node&&h.contains(T.target)===!1&&t(0,o=!1)}function k(T){lt[T?"unshift":"push"](()=>{h=T,t(2,h)})}return i.$$set=T=>{"title"in T&&t(1,s=T.title),"isOpen"in T&&t(0,o=T.isOpen),"enableIcon"in T&&t(5,c=T.enableIcon),"$$scope"in T&&t(7,n=T.$$scope)},[o,s,h,p,w,c,f,n,r,k]}class ks extends rt{constructor(e){super(),nt(this,e,Zf,Jf,He,{title:1,isOpen:0,enableIcon:5,close:6})}get close(){return this.$$.ctx[6]}}const Kf=i=>({isActive:i&1}),Sa=i=>({isActive:i[0]});function eu(i){let e,t;const r=i[3].icon,n=lr(r,i,i[2],Sa);return{c(){e=ee("span"),n&&n.c(),this.h()},l(s){e=te(s,"SPAN",{class:!0});var o=q(e);n&&n.l(o),o.forEach(C),this.h()},h(){E(e,"class","w-[16px] mr-1")},m(s,o){X(s,e,o),n&&n.m(e,null),t=!0},p(s,o){n&&n.p&&(!t||o&5)&&ir(n,r,s,s[2],t?fr(r,s[2],o,Kf):or(s[2]),Sa)},i(s){t||(R(n,s),t=!0)},o(s){z(n,s),t=!1},d(s){s&&C(e),n&&n.d(s)}}}function tu(i){let e,t,r,n,s,o,c=i[1]&&eu(i);const f=i[3].default,h=lr(f,i,i[2],null);return{c(){e=ee("li"),t=ee("button"),c&&c.c(),r=be(),h&&h.c(),this.h()},l(p){e=te(p,"LI",{class:!0});var w=q(e);t=te(w,"BUTTON",{class:!0});var k=q(t);c&&c.l(k),r=_e(k),h&&h.l(k),k.forEach(C),w.forEach(C),this.h()},h(){E(t,"class","flex items-center w-full py-1 pr-2 "+(i[1]?"pl-1":"pl-2")+" text-xs text-neutral-100 text-left"),dt(t,"hover:bg-blue-500",!i[0]),E(e,"class","w-full")},m(p,w){X(p,e,w),N(e,t),c&&c.m(t,null),N(t,r),h&&h.m(t,null),n=!0,s||(o=$t(e,"click",i[4]),s=!0)},p(p,[w]){p[1]&&c.p(p,w),h&&h.p&&(!n||w&4)&&ir(h,f,p,p[2],n?fr(f,p[2],w,null):or(p[2]),null),(!n||w&1)&&dt(t,"hover:bg-blue-500",!p[0])},i(p){n||(R(c),R(h,p),n=!0)},o(p){z(c),z(h,p),n=!1},d(p){p&&C(e),c&&c.d(),h&&h.d(p),s=!1,o()}}}function ru(i,e,t){let{$$slots:r={},$$scope:n}=e,{isActive:s=!1}=e;const{enableIcon:o}=Mf("menu");function c(f){Ar.call(this,i,f)}return i.$$set=f=>{"isActive"in f&&t(0,s=f.isActive),"$$scope"in f&&t(2,n=f.$$scope)},[s,o,n,r,c]}class xt extends rt{constructor(e){super(),nt(this,e,ru,tu,He,{isActive:0})}}function nu(i){let e;return{c(){e=ee("hr"),this.h()},l(t){e=te(t,"HR",{class:!0}),this.h()},h(){E(e,"class","my-0.5 border-0 border-b border-neutral-600")},m(t,r){X(t,e,r)},p:je,i:je,o:je,d(t){t&&C(e)}}}class au extends rt{constructor(e){super(),nt(this,e,null,nu,He,{})}}const su=i=>({}),La=i=>({}),lu=i=>({}),Da=i=>({});function Ba(i){let e,t;const r=i[5].settings,n=lr(r,i,i[4],La);return{c(){e=ee("aside"),n&&n.c(),this.h()},l(s){e=te(s,"ASIDE",{class:!0,style:!0});var o=q(e);n&&n.l(o),o.forEach(C),this.h()},h(){E(e,"class","flex flex-col h-full bg-neutral-600 border-l border-neutral-900"),ln(e,"width",i[0])},m(s,o){X(s,e,o),n&&n.m(e,null),i[7](e),t=!0},p(s,o){n&&n.p&&(!t||o&16)&&ir(n,r,s,s[4],t?fr(r,s[4],o,su):or(s[4]),La),(!t||o&1)&&ln(e,"width",s[0])},i(s){t||(R(n,s),t=!0)},o(s){z(n,s),t=!1},d(s){s&&C(e),n&&n.d(s),i[7](null)}}}function iu(i){let e,t,r,n;const s=i[5].panels,o=lr(s,i,i[4],Da);let c=i[3].settings&&Ba(i);return{c(){e=ee("section"),t=ee("main"),o&&o.c(),r=be(),c&&c.c(),this.h()},l(f){e=te(f,"SECTION",{class:!0});var h=q(e);t=te(h,"MAIN",{class:!0});var p=q(t);o&&o.l(p),p.forEach(C),r=_e(h),c&&c.l(h),h.forEach(C),this.h()},h(){E(t,"class","flex-grow grid grid-cols-1 gap-[2px] bg-neutral-600"),E(e,"class","w-full h-full flex items-stretch")},m(f,h){X(f,e,h),N(e,t),o&&o.m(t,null),i[6](t),N(e,r),c&&c.m(e,null),n=!0},p(f,[h]){o&&o.p&&(!n||h&16)&&ir(o,s,f,f[4],n?fr(s,f[4],h,lu):or(f[4]),Da),f[3].settings?c?(c.p(f,h),h&8&&R(c,1)):(c=Ba(f),c.c(),R(c,1),c.m(e,null)):c&&(it(),z(c,1,1,()=>{c=null}),ot())},i(f){n||(R(o,f),R(c),n=!0)},o(f){z(o,f),z(c),n=!1},d(f){f&&C(e),o&&o.d(f),i[6](null),c&&c.d()}}}function ou(i,e,t){let{$$slots:r={},$$scope:n}=e;const s=Ff(r);let{sidebarWidth:o="18rem"}=e,c,f;function h(w){lt[w?"unshift":"push"](()=>{c=w,t(1,c)})}function p(w){lt[w?"unshift":"push"](()=>{f=w,t(2,f)})}return i.$$set=w=>{"sidebarWidth"in w&&t(0,o=w.sidebarWidth),"$$scope"in w&&t(4,n=w.$$scope)},[o,c,f,s,n,r,h,p]}class cn extends rt{constructor(e){super(),nt(this,e,ou,iu,He,{sidebarWidth:0})}}function Ra(i,e,t){const r=i.slice();return r[9]=e[t],r}function Ta(i){let e=i[1],t,r=Na(i);return{c(){r.c(),t=Ke()},l(n){r.l(n),t=Ke()},m(n,s){r.m(n,s),X(n,t,s)},p(n,s){s&2&&He(e,e=n[1])?(r.d(1),r=Na(n),r.c(),r.m(t.parentNode,t)):r.p(n,s)},d(n){n&&C(t),r.d(n)}}}function Oa(i){let e,t=i[9]+"",r,n,s,o;function c(){return i[7](i[9])}return{c(){e=ee("button"),r=xe(t),n=be(),this.h()},l(f){e=te(f,"BUTTON",{class:!0});var h=q(e);r=Ue(h,t),n=_e(h),h.forEach(C),this.h()},h(){E(e,"class","panel-tab svelte-143z4t9"),dt(e,"active",i[1]===i[9]),dt(e,"highlight",i[3])},m(f,h){X(f,e,h),N(e,r),N(e,n),s||(o=$t(e,"click",c),s=!0)},p(f,h){i=f,h&1&&t!==(t=i[9]+"")&&yt(r,t),h&3&&dt(e,"active",i[1]===i[9]),h&8&&dt(e,"highlight",i[3])},d(f){f&&C(e),s=!1,o()}}}function Na(i){let e,t=i[0],r=[];for(let n=0;n<t.length;n+=1)r[n]=Oa(Ra(i,t,n));return{c(){for(let n=0;n<r.length;n+=1)r[n].c();e=Ke()},l(n){for(let s=0;s<r.length;s+=1)r[s].l(n);e=Ke()},m(n,s){for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(n,s);X(n,e,s)},p(n,s){if(s&27){t=n[0];let o;for(o=0;o<t.length;o+=1){const c=Ra(n,t,o);r[o]?r[o].p(c,s):(r[o]=Oa(c),r[o].c(),r[o].m(e.parentNode,e))}for(;o<r.length;o+=1)r[o].d(1);r.length=t.length}},d(n){ur(r,n),n&&C(e)}}}function za(i){let e,t;return{c(){e=ee("span"),t=xe(i[2]),this.h()},l(r){e=te(r,"SPAN",{class:!0});var n=q(e);t=Ue(n,i[2]),n.forEach(C),this.h()},h(){E(e,"class","z-10 absolute top-4 right-4 py-1 px-2 bg-neutral-900 shadow bg-opacity-50 text-neutral-100 text-xs")},m(r,n){X(r,e,n),N(e,t)},p(r,n){n&4&&yt(t,r[2])},d(r){r&&C(e)}}}function fu(i){let e,t,r,n,s,o,c=i[0]!==void 0&&Ta(i),f=i[2]&&za(i);const h=i[6].default,p=lr(h,i,i[5],null);return{c(){e=ee("div"),t=ee("div"),c&&c.c(),r=be(),n=ee("div"),f&&f.c(),s=be(),p&&p.c(),this.h()},l(w){e=te(w,"DIV",{class:!0});var k=q(e);t=te(k,"DIV",{class:!0});var T=q(t);c&&c.l(T),T.forEach(C),r=_e(k),n=te(k,"DIV",{class:!0});var J=q(n);f&&f.l(J),s=_e(J),p&&p.l(J),J.forEach(C),k.forEach(C),this.h()},h(){E(t,"class","panel-tabs w-full h-5 svelte-143z4t9"),E(n,"class","panel relative flex-grow w-full h-full"),E(e,"class","panel-container svelte-143z4t9")},m(w,k){X(w,e,k),N(e,t),c&&c.m(t,null),N(e,r),N(e,n),f&&f.m(n,null),N(n,s),p&&p.m(n,null),o=!0},p(w,[k]){w[0]!==void 0?c?c.p(w,k):(c=Ta(w),c.c(),c.m(t,null)):c&&(c.d(1),c=null),w[2]?f?f.p(w,k):(f=za(w),f.c(),f.m(n,s)):f&&(f.d(1),f=null),p&&p.p&&(!o||k&32)&&ir(p,h,w,w[5],o?fr(h,w[5],k,null):or(w[5]),null)},i(w){o||(R(p,w),o=!0)},o(w){z(p,w),o=!1},d(w){w&&C(e),c&&c.d(),f&&f.d(),p&&p.d(w)}}}function uu(i,e,t){let{$$slots:r={},$$scope:n}=e,{tabs:s=void 0}=e,{activeTab:o=void 0}=e,{caption:c=void 0}=e,{highlightTab:f=!0}=e;const h=mr();function p(k){h("tabClick",k)}const w=k=>p(k);return i.$$set=k=>{"tabs"in k&&t(0,s=k.tabs),"activeTab"in k&&t(1,o=k.activeTab),"caption"in k&&t(2,c=k.caption),"highlightTab"in k&&t(3,f=k.highlightTab),"$$scope"in k&&t(5,n=k.$$scope)},[s,o,c,f,p,n,r,w]}class cr extends rt{constructor(e){super(),nt(this,e,uu,fu,He,{tabs:0,activeTab:1,caption:2,highlightTab:3})}}function xa(i,e,t){const r=i.slice();return r[5]=e[t],r}function Ua(i){let e,t=i[5]+"",r,n,s;return{c(){e=ee("option"),r=xe(t),this.h()},l(o){e=te(o,"OPTION",{});var c=q(e);r=Ue(c,t),c.forEach(C),this.h()},h(){e.__value=n=i[5],e.value=e.__value,e.selected=s=i[2]===i[5]},m(o,c){X(o,e,c),N(e,r)},p(o,c){c&2&&t!==(t=o[5]+"")&&yt(r,t),c&2&&n!==(n=o[5])&&(e.__value=n,e.value=e.__value),c&6&&s!==(s=o[2]===o[5])&&(e.selected=s)},d(o){o&&C(e)}}}function cu(i){let e,t,r,n,s,o,c,f=i[1],h=[];for(let p=0;p<f.length;p+=1)h[p]=Ua(xa(i,f,p));return{c(){e=ee("label"),t=xe(i[0]),r=xe(":"),n=be(),s=ee("select");for(let p=0;p<h.length;p+=1)h[p].c();this.h()},l(p){e=te(p,"LABEL",{class:!0});var w=q(e);t=Ue(w,i[0]),r=Ue(w,":"),w.forEach(C),n=_e(p),s=te(p,"SELECT",{name:!0,id:!0,class:!0});var k=q(s);for(let T=0;T<h.length;T+=1)h[T].l(k);k.forEach(C),this.h()},h(){E(e,"class","w-1/3 pr-2 text-xs text-neutral-400 text-right"),E(s,"name",i[0]),E(s,"id",i[0]),E(s,"class","emboss py-1 px-2 bg-neutral-700 border border-neutral-800 text-xs text-neutral-200")},m(p,w){X(p,e,w),N(e,t),N(e,r),X(p,n,w),X(p,s,w);for(let k=0;k<h.length;k+=1)h[k]&&h[k].m(s,null);o||(c=$t(s,"change",i[3]),o=!0)},p(p,[w]){if(w&1&&yt(t,p[0]),w&6){f=p[1];let k;for(k=0;k<f.length;k+=1){const T=xa(p,f,k);h[k]?h[k].p(T,w):(h[k]=Ua(T),h[k].c(),h[k].m(s,null))}for(;k<h.length;k+=1)h[k].d(1);h.length=f.length}w&1&&E(s,"name",p[0]),w&1&&E(s,"id",p[0])},i:je,o:je,d(p){p&&C(e),p&&C(n),p&&C(s),ur(h,p),o=!1,c()}}}function hu(i,e,t){let{name:r}=e,{options:n}=e,{selected:s=void 0}=e;const o=mr();function c(f){if(f.target){const h=f.target;o("change",h.value)}}return i.$$set=f=>{"name"in f&&t(0,r=f.name),"options"in f&&t(1,n=f.options),"selected"in f&&t(2,s=f.selected)},[r,n,s,c]}class gu extends rt{constructor(e){super(),nt(this,e,hu,cu,He,{name:0,options:1,selected:2})}}function pu(i){let e;return{c(){e=ee("td"),this.h()},l(t){e=te(t,"TD",{class:!0});var r=q(e);r.forEach(C),this.h()},h(){E(e,"class","py-1 px-2 border-l border-neutral-800 text-neutral-100 text-xs")},m(t,r){X(t,e,r),e.innerHTML=i[0]},p(t,[r]){r&1&&(e.innerHTML=t[0])},i:je,o:je,d(t){t&&C(e)}}}function du(i,e,t){let{value:r}=e,{formatter:n=void 0}=e,s;if(n)s=n(r);else if(typeof r=="string")s=r;else if(r.toString)s=r.toString();else throw"Error: Cannot format value.";return i.$$set=o=>{"value"in o&&t(1,r=o.value),"formatter"in o&&t(2,n=o.formatter)},[s,r,n]}class vu extends rt{constructor(e){super(),nt(this,e,du,pu,He,{value:1,formatter:2})}}function ja(i,e,t){const r=i.slice();return r[3]=e[t],r}function Ga(i){let e,t;const r=[i[3]];let n={};for(let s=0;s<r.length;s+=1)n=Ht(n,r[s]);return e=new vu({props:n}),{c(){he(e.$$.fragment)},l(s){ge(e.$$.fragment,s)},m(s,o){pe(e,s,o),t=!0},p(s,o){const c=o&1?fn(r,[un(s[3])]):{};e.$set(c)},i(s){t||(R(e.$$.fragment,s),t=!0)},o(s){z(e.$$.fragment,s),t=!1},d(s){de(e,s)}}}function mu(i){let e,t,r,n,s=i[0],o=[];for(let f=0;f<s.length;f+=1)o[f]=Ga(ja(i,s,f));const c=f=>z(o[f],1,1,()=>{o[f]=null});return{c(){e=ee("tr");for(let f=0;f<o.length;f+=1)o[f].c();this.h()},l(f){e=te(f,"TR",{class:!0});var h=q(e);for(let p=0;p<o.length;p+=1)o[p].l(h);h.forEach(C),this.h()},h(){E(e,"class","hover:bg-neutral-600 border-b last:border-b-0 border-neutral-800")},m(f,h){X(f,e,h);for(let p=0;p<o.length;p+=1)o[p]&&o[p].m(e,null);t=!0,r||(n=[$t(e,"mouseenter",i[1]),$t(e,"mouseleave",i[2])],r=!0)},p(f,[h]){if(h&1){s=f[0];let p;for(p=0;p<s.length;p+=1){const w=ja(f,s,p);o[p]?(o[p].p(w,h),R(o[p],1)):(o[p]=Ga(w),o[p].c(),R(o[p],1),o[p].m(e,null))}for(it(),p=s.length;p<o.length;p+=1)c(p);ot()}},i(f){if(!t){for(let h=0;h<s.length;h+=1)R(o[h]);t=!0}},o(f){o=o.filter(Boolean);for(let h=0;h<o.length;h+=1)z(o[h]);t=!1},d(f){f&&C(e),ur(o,f),r=!1,on(n)}}}function bu(i,e,t){let{cells:r}=e;function n(o){Ar.call(this,i,o)}function s(o){Ar.call(this,i,o)}return i.$$set=o=>{"cells"in o&&t(0,r=o.cells)},[r,n,s]}class _u extends rt{constructor(e){super(),nt(this,e,bu,mu,He,{cells:0})}}function qa(i,e,t){const r=i.slice();return r[10]=e[t],r[12]=t,r}function Wa(i,e,t){const r=i.slice();return r[13]=e[t],r}function Ha(i){let e,t,r=i[1],n=[];for(let s=0;s<r.length;s+=1)n[s]=Va(Wa(i,r,s));return{c(){e=ee("thead"),t=ee("tr");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){e=te(s,"THEAD",{});var o=q(e);t=te(o,"TR",{class:!0});var c=q(t);for(let f=0;f<n.length;f+=1)n[f].l(c);c.forEach(C),o.forEach(C),this.h()},h(){E(t,"class","sticky top-0 bg-gradient-to-t from-neutral-600 to-neutral-500 border-b border-neutral-800")},m(s,o){X(s,e,o),N(e,t);for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(t,null)},p(s,o){if(o&2){r=s[1];let c;for(c=0;c<r.length;c+=1){const f=Wa(s,r,c);n[c]?n[c].p(f,o):(n[c]=Va(f),n[c].c(),n[c].m(t,null))}for(;c<n.length;c+=1)n[c].d(1);n.length=r.length}},d(s){s&&C(e),ur(n,s)}}}function Va(i){let e,t=i[13]+"",r;return{c(){e=ee("th"),r=xe(t),this.h()},l(n){e=te(n,"TH",{class:!0});var s=q(e);r=Ue(s,t),s.forEach(C),this.h()},h(){E(e,"class","px-2 border-l border-neutral-800 text-neutral-300 text-[0.6875rem] font-medium lowercase small-caps svelte-2meyxc")},m(n,s){X(n,e,s),N(e,r)},p(n,s){s&2&&t!==(t=n[13]+"")&&yt(r,t)},d(n){n&&C(e)}}}function Ya(i){let e,t;const r=[i[10]];function n(){return i[7](i[12])}function s(){return i[8](i[12])}let o={};for(let c=0;c<r.length;c+=1)o=Ht(o,r[c]);return e=new _u({props:o}),e.$on("mouseenter",n),e.$on("mouseleave",s),{c(){he(e.$$.fragment)},l(c){ge(e.$$.fragment,c)},m(c,f){pe(e,c,f),t=!0},p(c,f){i=c;const h=f&4?fn(r,[un(i[10])]):{};e.$set(h)},i(c){t||(R(e.$$.fragment,c),t=!0)},o(c){z(e.$$.fragment,c),t=!1},d(c){de(e,c)}}}function Qa(i){let e,t,r=i[2],n=[];for(let o=0;o<r.length;o+=1)n[o]=Ya(qa(i,r,o));const s=o=>z(n[o],1,1,()=>{n[o]=null});return{c(){for(let o=0;o<n.length;o+=1)n[o].c();e=Ke()},l(o){for(let c=0;c<n.length;c+=1)n[c].l(o);e=Ke()},m(o,c){for(let f=0;f<n.length;f+=1)n[f]&&n[f].m(o,c);X(o,e,c),t=!0},p(o,c){if(c&52){r=o[2];let f;for(f=0;f<r.length;f+=1){const h=qa(o,r,f);n[f]?(n[f].p(h,c),R(n[f],1)):(n[f]=Ya(h),n[f].c(),R(n[f],1),n[f].m(e.parentNode,e))}for(it(),f=r.length;f<n.length;f+=1)s(f);ot()}},i(o){if(!t){for(let c=0;c<r.length;c+=1)R(n[c]);t=!0}},o(o){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)z(n[c]);t=!1},d(o){ur(n,o),o&&C(e)}}}function wu(i){let e,t,r,n,s,o,c=i[2],f,h,p=i[3]&&Ha(i),w=Qa(i);return{c(){e=ee("label"),t=xe(i[0]),r=be(),n=ee("table"),p&&p.c(),s=be(),o=ee("tbody"),w.c(),this.h()},l(k){e=te(k,"LABEL",{class:!0});var T=q(e);t=Ue(T,i[0]),T.forEach(C),r=_e(k),n=te(k,"TABLE",{class:!0});var J=q(n);p&&p.l(J),s=_e(J),o=te(J,"TBODY",{});var I=q(o);w.l(I),I.forEach(C),J.forEach(C),this.h()},h(){E(e,"class","w-1/3 pr-2 text-xs text-neutral-400 text-right"),E(n,"class",f=i[6].class+" table-shadow w-fit my-1 bg-neutral-700 border border-neutral-800 svelte-2meyxc")},m(k,T){X(k,e,T),N(e,t),X(k,r,T),X(k,n,T),p&&p.m(n,null),N(n,s),N(n,o),w.m(o,null),h=!0},p(k,[T]){(!h||T&1)&&yt(t,k[0]),k[3]?p?p.p(k,T):(p=Ha(k),p.c(),p.m(n,s)):p&&(p.d(1),p=null),T&4&&He(c,c=k[2])?(it(),z(w,1,1,je),ot(),w=Qa(k),w.c(),R(w,1),w.m(o,null)):w.p(k,T),(!h||T&64&&f!==(f=k[6].class+" table-shadow w-fit my-1 bg-neutral-700 border border-neutral-800 svelte-2meyxc"))&&E(n,"class",f)},i(k){h||(R(w),h=!0)},o(k){z(w),h=!1},d(k){k&&C(e),k&&C(r),k&&C(n),p&&p.d(),w.d(k)}}}function ku(i,e,t){let{name:r}=e,{columns:n}=e,{rows:s}=e,{showColumns:o=!0}=e;const c=mr();function f(k){c("rowHover",k)}function h(k){c("rowLeave",k)}const p=k=>f(k),w=k=>h(k);return i.$$set=k=>{t(6,e=Ht(Ht({},e),Pr(k))),"name"in k&&t(0,r=k.name),"columns"in k&&t(1,n=k.columns),"rows"in k&&t(2,s=k.rows),"showColumns"in k&&t(3,o=k.showColumns)},e=Pr(e),[r,n,s,o,f,h,e,p,w]}class $u extends rt{constructor(e){super(),nt(this,e,ku,wu,He,{name:0,columns:1,rows:2,showColumns:3})}}function yu(i){let e,t,r,n,s,o;return{c(){e=ee("label"),t=xe(i[0]),r=xe(":"),n=be(),s=ee("span"),o=xe(i[1]),this.h()},l(c){e=te(c,"LABEL",{class:!0});var f=q(e);t=Ue(f,i[0]),r=Ue(f,":"),f.forEach(C),n=_e(c),s=te(c,"SPAN",{class:!0});var h=q(s);o=Ue(h,i[1]),h.forEach(C),this.h()},h(){E(e,"class","text-xs text-neutral-400 text-right"),E(s,"class","text-xs text-neutral-200")},m(c,f){X(c,e,f),N(e,t),N(e,r),X(c,n,f),X(c,s,f),N(s,o)},p(c,[f]){f&1&&yt(t,c[0]),f&2&&yt(o,c[1])},i:je,o:je,d(c){c&&C(e),c&&C(n),c&&C(s)}}}function Cu(i,e,t){let{name:r}=e,{label:n}=e;return i.$$set=s=>{"name"in s&&t(0,r=s.name),"label"in s&&t(1,n=s.label)},[r,n]}class Wt extends rt{constructor(e){super(),nt(this,e,Cu,yu,He,{name:0,label:1})}}function Xa(i){let e,t,r,n,s,o;return{c(){e=ee("div"),t=ct("svg"),r=ct("circle"),n=ct("path"),s=be(),o=xe(i[0]),this.h()},l(c){e=te(c,"DIV",{class:!0});var f=q(e);t=ht(f,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var h=q(t);r=ht(h,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),q(r).forEach(C),n=ht(h,"path",{class:!0,fill:!0,d:!0}),q(n).forEach(C),h.forEach(C),s=_e(f),o=Ue(f,i[0]),f.forEach(C),this.h()},h(){E(r,"class","opacity-25"),E(r,"cx","12"),E(r,"cy","12"),E(r,"r","10"),E(r,"stroke","currentColor"),E(r,"stroke-width","4"),E(n,"class","opacity-75"),E(n,"fill","currentColor"),E(n,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),E(t,"class","animate-spin mr-1 h-4 w-4 text-white"),E(t,"xmlns","http://www.w3.org/2000/svg"),E(t,"fill","none"),E(t,"viewBox","0 0 24 24"),E(e,"class","z-20 absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 flex items-center py-1.5 px-2 bg-neutral-900 bg-opacity-75 text-white text-xs font-medium")},m(c,f){X(c,e,f),N(e,t),N(t,r),N(t,n),N(e,s),N(e,o)},p(c,f){f&1&&yt(o,c[0])},d(c){c&&C(e)}}}function Eu(i){let e,t,r,n,s,o,c,f,h,p=i[0]&&Xa(i);return{c(){e=ee("div"),t=ee("img"),n=be(),s=ee("canvas"),o=be(),p&&p.c(),this.h()},l(w){e=te(w,"DIV",{class:!0});var k=q(e);t=te(k,"IMG",{src:!0,class:!0}),n=_e(k),s=te(k,"CANVAS",{class:!0}),q(s).forEach(C),o=_e(k),p&&p.l(k),k.forEach(C),this.h()},h(){If(t.src,r=i[4])||E(t,"src",r),E(t,"class","absolute left-1/2 -translate-x-1/2 h-full object-contain"),E(s,"class","z-10 absolute left-1/2 -translate-x-1/2 h-full"),E(e,"class",c=(i[6].class??"")+" relative w-full h-full bg-white")},m(w,k){X(w,e,k),N(e,t),i[15](t),N(e,n),N(e,s),i[16](s),N(e,o),p&&p.m(e,null),i[17](e),f||(h=$t(t,"load",i[5]),f=!0)},p(w,[k]){w[0]?p?p.p(w,k):(p=Xa(w),p.c(),p.m(e,null)):p&&(p.d(1),p=null),k&64&&c!==(c=(w[6].class??"")+" relative w-full h-full bg-white")&&E(e,"class",c)},i:je,o:je,d(w){w&&C(e),i[15](null),i[16](null),p&&p.d(),i[17](null),f=!1,h()}}}function Mu(i,e,t){let{personaSide:r}=e;function n(){return J.toDataURL("image/png")}function s(){return J}function o(){return le}function c(m){t(0,k=m)}function f(){t(0,k=void 0)}function h(){Ia(ie,J,I,ne)}function p(m){const v=J.getContext("2d");if(v==null)throw"Could not get context to draw strokes.";for(let M of m){let B=M.points,j=M.brushSize;if(le!==void 0)B=_s(M.points,le),j*=le;else{const re="Could not draw strokes because the scale factor is unknown.";throw alert(re),re}bs(B,v,M.brushColor,j)}}const w=mr();let k="Loading persona...",T=ms[r],J,I=0,ne=0,le=1,ie,O;function P(){const{imgWidth:m,imgHeight:v}=Bf(ie);I=Math.ceil(m),ne=Math.ceil(v),le=I/ie.naturalWidth,Rf(J,I,ne),Ia(ie,J,I,ne),f(),w("ready",{personaSide:r,canvas:J,width:I,height:ne,imgWidth:m,imgHeight:v,scaleFactor:le})}function x(m){lt[m?"unshift":"push"](()=>{ie=m,t(2,ie)})}function S(m){lt[m?"unshift":"push"](()=>{J=m,t(1,J)})}function W(m){lt[m?"unshift":"push"](()=>{O=m,t(3,O)})}return i.$$set=m=>{t(6,e=Ht(Ht({},e),Pr(m))),"personaSide"in m&&t(7,r=m.personaSide)},e=Pr(e),[k,J,ie,O,T,P,e,r,n,s,o,c,f,h,p,x,S,W]}class sr extends rt{constructor(e){super(),nt(this,e,Mu,Eu,He,{personaSide:7,getImage:8,getCanvas:9,getScaleFactor:10,setMessage:11,clearMessage:12,clear:13,drawStrokes:14})}get getImage(){return this.$$.ctx[8]}get getCanvas(){return this.$$.ctx[9]}get getScaleFactor(){return this.$$.ctx[10]}get setMessage(){return this.$$.ctx[11]}get clearMessage(){return this.$$.ctx[12]}get clear(){return this.$$.ctx[13]}get drawStrokes(){return this.$$.ctx[14]}}function Ja(i,e,t){const r=i.slice();return r[17]=e[t],r}function Za(i){let e=i[1],t,r,n=es(i);return{c(){n.c(),t=Ke()},l(s){n.l(s),t=Ke()},m(s,o){n.m(s,o),X(s,t,o),r=!0},p(s,o){o&2&&He(e,e=s[1])?(it(),z(n,1,1,je),ot(),n=es(s),n.c(),R(n,1),n.m(t.parentNode,t)):n.p(s,o)},i(s){r||(R(n),r=!0)},o(s){z(n),r=!1},d(s){s&&C(t),n.d(s)}}}function Fu(i){let e,t,r={personaSide:i[17]};return e=new sr({props:r}),i[12](e),e.$on("ready",i[8]),{c(){he(e.$$.fragment)},l(n){ge(e.$$.fragment,n)},m(n,s){pe(e,n,s),t=!0},p(n,s){const o={};s&4&&(o.personaSide=n[17]),e.$set(o)},i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){i[12](null),de(e,n)}}}function Iu(i){let e,t,r={personaSide:i[17]};return e=new sr({props:r}),i[11](e),e.$on("ready",i[8]),{c(){he(e.$$.fragment)},l(n){ge(e.$$.fragment,n)},m(n,s){pe(e,n,s),t=!0},p(n,s){const o={};s&4&&(o.personaSide=n[17]),e.$set(o)},i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){i[11](null),de(e,n)}}}function Ka(i){let e,t,r,n,s;const o=[Iu,Fu],c=[];function f(h,p){return p&4&&(e=null),e==null&&(e=!!h[17].includes("Front")),e?0:1}return t=f(i,-1),r=c[t]=o[t](i),{c(){r.c(),n=Ke()},l(h){r.l(h),n=Ke()},m(h,p){c[t].m(h,p),X(h,n,p),s=!0},p(h,p){let w=t;t=f(h,p),t===w?c[t].p(h,p):(it(),z(c[w],1,1,()=>{c[w]=null}),ot(),r=c[t],r?r.p(h,p):(r=c[t]=o[t](h),r.c()),R(r,1),r.m(n.parentNode,n))},i(h){s||(R(r),s=!0)},o(h){z(r),s=!1},d(h){c[t].d(h),h&&C(n)}}}function Au(i){let e,t,r=i[2],n=[];for(let o=0;o<r.length;o+=1)n[o]=Ka(Ja(i,r,o));const s=o=>z(n[o],1,1,()=>{n[o]=null});return{c(){e=ee("div");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=te(o,"DIV",{class:!0});var c=q(e);for(let f=0;f<n.length;f+=1)n[f].l(c);c.forEach(C),this.h()},h(){E(e,"class","flex w-full h-full")},m(o,c){X(o,e,c);for(let f=0;f<n.length;f+=1)n[f]&&n[f].m(e,null);t=!0},p(o,c){if(c&452){r=o[2];let f;for(f=0;f<r.length;f+=1){const h=Ja(o,r,f);n[f]?(n[f].p(h,c),R(n[f],1)):(n[f]=Ka(h),n[f].c(),R(n[f],1),n[f].m(e,null))}for(it(),f=r.length;f<n.length;f+=1)s(f);ot()}},i(o){if(!t){for(let c=0;c<r.length;c+=1)R(n[c]);t=!0}},o(o){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)z(n[c]);t=!1},d(o){o&&C(e),ur(n,o)}}}function Pu(i){let e,t;return e=new cr({props:{caption:"Looking Glass",$$slots:{default:[Au]},$$scope:{ctx:i}}}),{c(){he(e.$$.fragment)},l(r){ge(e.$$.fragment,r)},m(r,n){pe(e,r,n),t=!0},p(r,n){const s={};n&1048772&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){de(e,r)}}}function Su(i){let e,t,r,n,s,o,c,f,h,p,w,k,T,J,I,ne;r=new gu({props:{name:"Participant",options:Object.keys(i[0].participants),selected:i[1].id}}),r.$on("change",i[9]),o=new Wt({props:{name:"Drawing area",label:`${i[1].totalDrawingArea} pixels`}}),h=new Wt({props:{name:"Avg valence",label:i[3].toString()}}),k=new Wt({props:{name:"Avg intensity",label:i[4].toString()}});const le=[{class:"block h-64 overflow-auto"},i[5]];let ie={};for(let O=0;O<le.length;O+=1)ie=Ht(ie,le[O]);return I=new $u({props:ie}),{c(){e=ee("ul"),t=ee("li"),he(r.$$.fragment),n=be(),s=ee("li"),he(o.$$.fragment),c=be(),f=ee("li"),he(h.$$.fragment),p=be(),w=ee("li"),he(k.$$.fragment),T=be(),J=ee("li"),he(I.$$.fragment),this.h()},l(O){e=te(O,"UL",{class:!0});var P=q(e);t=te(P,"LI",{});var x=q(t);ge(r.$$.fragment,x),x.forEach(C),n=_e(P),s=te(P,"LI",{});var S=q(s);ge(o.$$.fragment,S),S.forEach(C),c=_e(P),f=te(P,"LI",{});var W=q(f);ge(h.$$.fragment,W),W.forEach(C),p=_e(P),w=te(P,"LI",{});var m=q(w);ge(k.$$.fragment,m),m.forEach(C),T=_e(P),J=te(P,"LI",{});var v=q(J);ge(I.$$.fragment,v),v.forEach(C),P.forEach(C),this.h()},h(){E(e,"class","p-2")},m(O,P){X(O,e,P),N(e,t),pe(r,t,null),N(e,n),N(e,s),pe(o,s,null),N(e,c),N(e,f),pe(h,f,null),N(e,p),N(e,w),pe(k,w,null),N(e,T),N(e,J),pe(I,J,null),ne=!0},p(O,P){const x={};P&1&&(x.options=Object.keys(O[0].participants)),P&2&&(x.selected=O[1].id),r.$set(x);const S={};P&2&&(S.label=`${O[1].totalDrawingArea} pixels`),o.$set(S);const W={};P&8&&(W.label=O[3].toString()),h.$set(W);const m={};P&16&&(m.label=O[4].toString()),k.$set(m);const v=P&32?fn(le,[le[0],un(O[5])]):{};I.$set(v)},i(O){ne||(R(r.$$.fragment,O),R(o.$$.fragment,O),R(h.$$.fragment,O),R(k.$$.fragment,O),R(I.$$.fragment,O),ne=!0)},o(O){z(r.$$.fragment,O),z(o.$$.fragment,O),z(h.$$.fragment,O),z(k.$$.fragment,O),z(I.$$.fragment,O),ne=!1},d(O){O&&C(e),de(r),de(o),de(h),de(k),de(I)}}}function Lu(i){let e,t;return e=new cr({props:{tabs:["Details"],highlightTab:!1,$$slots:{default:[Su]},$$scope:{ctx:i}}}),{c(){he(e.$$.fragment)},l(r){ge(e.$$.fragment,r)},m(r,n){pe(e,r,n),t=!0},p(r,n){const s={};n&1048635&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){de(e,r)}}}function es(i){let e,t;return e=new cn({props:{$$slots:{settings:[Lu],panels:[Pu]},$$scope:{ctx:i}}}),{c(){he(e.$$.fragment)},l(r){ge(e.$$.fragment,r)},m(r,n){pe(e,r,n),t=!0},p(r,n){const s={};n&1048831&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){de(e,r)}}}function Du(i){let e,t,r=i[1]&&Za(i);return{c(){r&&r.c(),e=Ke()},l(n){r&&r.l(n),e=Ke()},m(n,s){r&&r.m(n,s),X(n,e,s),t=!0},p(n,[s]){n[1]?r?(r.p(n,s),s&2&&R(r,1)):(r=Za(n),r.c(),R(r,1),r.m(e.parentNode,e)):r&&(it(),z(r,1,1,()=>{r=null}),ot())},i(n){t||(R(r),t=!0)},o(n){z(r),t=!1},d(n){r&&r.d(n),n&&C(e)}}}function ts(i){const e={name:"Areas table",columns:["Valence","Intensity","Size"],rows:[]};for(const t in i.areas){const[r,n]=t.split(":");e.rows.push({cells:[{value:r},{value:n},{value:i.areas[t]}]})}return e}function rs(i,e){const t={};for(const o in i.areas){const[c,f]=o.split(":"),h=i.areas[o];e==="valence"?(t[c]??(t[c]=0),t[c]+=h):(t[f]??(t[f]=0),t[f]+=h)}let r=0;for(let o in t){const c=parseInt(o);r+=c*t[o]}const n=i.totalDrawingArea>0?r/i.totalDrawingArea:0;return Math.round(n*100)/100}function ns(i,e){const t=i.drawing[e];if(t===void 0)throw`Could not get ${e} drawing of participant ${i.id}.`;return t.strokes}function Bu(i,e,t){let{survey:r}=e,n,s,o,c,f={name:"Areas",columns:[],rows:[]},h,p,w;function k(){const O=`Participant${n.id+1}-${n.persona}`;return[{name:`LookingGlass-${O}Front.png`,dataUrl:h.getImage()},{name:`LookingGlass-${O}Back.png`,dataUrl:p.getImage()}]}function T(O){const{personaSide:P}=O.detail,x=ns(n,P);let S;P.includes("Front")?S=h:S=p,S.drawStrokes(x)}function J(O){const P=r.participants[O],x=Object.keys(P.drawing),S=[{id:P.id,drawing:P.drawing}];Promise.all([zt.getPersonaBitmaps("Female"),zt.getPersonaBitmaps("Male")]).then(([W,m])=>{w==null||w.postMessage({command:"get-areas",params:{data:S,femaleFrontBitmap:W.frontBitmap,femaleBackBitmap:W.backBitmap,maleFrontBitmap:m.frontBitmap,maleBackBitmap:m.backBitmap}},[W.frontBitmap,W.backBitmap,m.frontBitmap,m.backBitmap])}),t(1,n=P),t(2,s=x),t(3,o=0),t(4,c=0),t(5,f=ts(n))}function I({detail:O}){J(O)}async function ne(){const O=await hs(()=>import("../chunks/export.worker.28bba91a.js"),[],import.meta.url);w=new O.default,w.onmessage=P=>{if(P.data.event==="areas-done"){const x=P.data.params,S=new vr({id:n.id,drawing:n.drawing,areas:x[0].areas,totalDrawingArea:x[0].totalDrawingArea,computed:!0});r.updateParticipant(S),t(1,n=S);let W=[];s.forEach(M=>{W=W.concat(ns(n,M))});const m=rs(n,"valence"),v=rs(n,"intensity");t(3,o=m),t(4,c=v),t(5,f=ts(n))}}}Sr(async()=>{await ne(),await zt.preloadAllCanvases(),J(Object.keys(r.participants)[0])});function le(O){lt[O?"unshift":"push"](()=>{h=O,t(6,h)})}function ie(O){lt[O?"unshift":"push"](()=>{p=O,t(7,p)})}return i.$$set=O=>{"survey"in O&&t(0,r=O.survey)},[r,n,s,o,c,f,h,p,T,I,k,le,ie]}class Ru extends rt{constructor(e){super(),nt(this,e,Bu,Du,He,{survey:0,getImages:10})}get survey(){return this.$$.ctx[0]}set survey(e){this.$$set({survey:e}),gs()}get getImages(){return this.$$.ctx[10]}}var $s={exports:{}};/**
 * chroma.js - JavaScript library for color conversions
 *
 * Copyright (c) 2011-2019, Gregor Aisch
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 * derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * -------------------------------------------------------
 *
 * chroma.js includes colors from colorbrewer2.org, which are released under
 * the following license:
 *
 * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,
 * and The Pennsylvania State University.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific
 * language governing permissions and limitations under the License.
 *
 * ------------------------------------------------------
 *
 * Named colors are taken from X11 Color Names.
 * http://www.w3.org/TR/css3-color/#svg-color
 *
 * @preserve
 */(function(i,e){(function(t,r){i.exports=r()})(ps,function(){for(var t=function(a,l,u){return l===void 0&&(l=0),u===void 0&&(u=1),a<l?l:a>u?u:a},r=t,n=function(a){a._clipped=!1,a._unclipped=a.slice(0);for(var l=0;l<=3;l++)l<3?((a[l]<0||a[l]>255)&&(a._clipped=!0),a[l]=r(a[l],0,255)):l===3&&(a[l]=r(a[l],0,1));return a},s={},o=0,c=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];o<c.length;o+=1){var f=c[o];s["[object "+f+"]"]=f.toLowerCase()}var h=function(a){return s[Object.prototype.toString.call(a)]||"object"},p=h,w=function(a,l){return l===void 0&&(l=null),a.length>=3?Array.prototype.slice.call(a):p(a[0])=="object"&&l?l.split("").filter(function(u){return a[0][u]!==void 0}).map(function(u){return a[0][u]}):a[0]},k=h,T=function(a){if(a.length<2)return null;var l=a.length-1;return k(a[l])=="string"?a[l].toLowerCase():null},J=Math.PI,I={clip_rgb:n,limit:t,type:h,unpack:w,last:T,PI:J,TWOPI:J*2,PITHIRD:J/3,DEG2RAD:J/180,RAD2DEG:180/J},ne={format:{},autodetect:[]},le=I.last,ie=I.clip_rgb,O=I.type,P=ne,x=function(){for(var l=[],u=arguments.length;u--;)l[u]=arguments[u];var g=this;if(O(l[0])==="object"&&l[0].constructor&&l[0].constructor===this.constructor)return l[0];var b=le(l),_=!1;if(!b){_=!0,P.sorted||(P.autodetect=P.autodetect.sort(function(A,G){return G.p-A.p}),P.sorted=!0);for(var d=0,$=P.autodetect;d<$.length;d+=1){var y=$[d];if(b=y.test.apply(y,l),b)break}}if(P.format[b]){var F=P.format[b].apply(null,_?l:l.slice(0,-1));g._rgb=ie(F)}else throw new Error("unknown format: "+l);g._rgb.length===3&&g._rgb.push(1)};x.prototype.toString=function(){return O(this.hex)=="function"?this.hex():"["+this._rgb.join(",")+"]"};var S=x,W=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(W.Color,[null].concat(a)))};W.Color=S,W.version="2.4.2";var m=W,v=I.unpack,M=Math.max,B=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=v(a,"rgb"),g=u[0],b=u[1],_=u[2];g=g/255,b=b/255,_=_/255;var d=1-M(g,M(b,_)),$=d<1?1/(1-d):0,y=(1-g-d)*$,F=(1-b-d)*$,A=(1-_-d)*$;return[y,F,A,d]},j=B,re=I.unpack,oe=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=re(a,"cmyk");var u=a[0],g=a[1],b=a[2],_=a[3],d=a.length>4?a[4]:1;return _===1?[0,0,0,d]:[u>=1?0:255*(1-u)*(1-_),g>=1?0:255*(1-g)*(1-_),b>=1?0:255*(1-b)*(1-_),d]},Re=oe,De=m,Z=S,Te=ne,ae=I.unpack,at=I.type,Ve=j;Z.prototype.cmyk=function(){return Ve(this._rgb)},De.cmyk=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(Z,[null].concat(a,["cmyk"])))},Te.format.cmyk=Re,Te.autodetect.push({p:2,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=ae(a,"cmyk"),at(a)==="array"&&a.length===4)return"cmyk"}});var Y=I.unpack,we=I.last,U=function(a){return Math.round(a*100)/100},H=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Y(a,"hsla"),g=we(a)||"lsa";return u[0]=U(u[0]||0),u[1]=U(u[1]*100)+"%",u[2]=U(u[2]*100)+"%",g==="hsla"||u.length>3&&u[3]<1?(u[3]=u.length>3?u[3]:1,g="hsla"):u.length=3,g+"("+u.join(",")+")"},fe=H,Se=I.unpack,ke=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=Se(a,"rgba");var u=a[0],g=a[1],b=a[2];u/=255,g/=255,b/=255;var _=Math.min(u,g,b),d=Math.max(u,g,b),$=(d+_)/2,y,F;return d===_?(y=0,F=Number.NaN):y=$<.5?(d-_)/(d+_):(d-_)/(2-d-_),u==d?F=(g-b)/(d-_):g==d?F=2+(b-u)/(d-_):b==d&&(F=4+(u-g)/(d-_)),F*=60,F<0&&(F+=360),a.length>3&&a[3]!==void 0?[F,y,$,a[3]]:[F,y,$]},K=ke,$e=I.unpack,Me=I.last,Ge=fe,Be=K,Ye=Math.round,qe=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=$e(a,"rgba"),g=Me(a)||"rgb";return g.substr(0,3)=="hsl"?Ge(Be(u),g):(u[0]=Ye(u[0]),u[1]=Ye(u[1]),u[2]=Ye(u[2]),(g==="rgba"||u.length>3&&u[3]<1)&&(u[3]=u.length>3?u[3]:1,g="rgba"),g+"("+u.slice(0,g==="rgb"?3:4).join(",")+")")},Oe=qe,vt=I.unpack,st=Math.round,_t=function(){for(var a,l=[],u=arguments.length;u--;)l[u]=arguments[u];l=vt(l,"hsl");var g=l[0],b=l[1],_=l[2],d,$,y;if(b===0)d=$=y=_*255;else{var F=[0,0,0],A=[0,0,0],G=_<.5?_*(1+b):_+b-_*b,L=2*_-G,Q=g/360;F[0]=Q+1/3,F[1]=Q,F[2]=Q-1/3;for(var V=0;V<3;V++)F[V]<0&&(F[V]+=1),F[V]>1&&(F[V]-=1),6*F[V]<1?A[V]=L+(G-L)*6*F[V]:2*F[V]<1?A[V]=G:3*F[V]<2?A[V]=L+(G-L)*(2/3-F[V])*6:A[V]=L;a=[st(A[0]*255),st(A[1]*255),st(A[2]*255)],d=a[0],$=a[1],y=a[2]}return l.length>3?[d,$,y,l[3]]:[d,$,y,1]},wt=_t,ft=wt,Ne=ne,We=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,At=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,Ie=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,Lt=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,kt=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,Pt=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Ct=Math.round,Et=function(a){a=a.toLowerCase().trim();var l;if(Ne.format.named)try{return Ne.format.named(a)}catch{}if(l=a.match(We)){for(var u=l.slice(1,4),g=0;g<3;g++)u[g]=+u[g];return u[3]=1,u}if(l=a.match(At)){for(var b=l.slice(1,5),_=0;_<4;_++)b[_]=+b[_];return b}if(l=a.match(Ie)){for(var d=l.slice(1,4),$=0;$<3;$++)d[$]=Ct(d[$]*2.55);return d[3]=1,d}if(l=a.match(Lt)){for(var y=l.slice(1,5),F=0;F<3;F++)y[F]=Ct(y[F]*2.55);return y[3]=+y[3],y}if(l=a.match(kt)){var A=l.slice(1,4);A[1]*=.01,A[2]*=.01;var G=ft(A);return G[3]=1,G}if(l=a.match(Pt)){var L=l.slice(1,4);L[1]*=.01,L[2]*=.01;var Q=ft(L);return Q[3]=+l[4],Q}};Et.test=function(a){return We.test(a)||At.test(a)||Ie.test(a)||Lt.test(a)||kt.test(a)||Pt.test(a)};var St=Et,gt=m,Ut=S,ut=ne,br=I.type,hr=Oe,hn=St;Ut.prototype.css=function(a){return hr(this._rgb,a)},gt.css=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(Ut,[null].concat(a,["css"])))},ut.format.css=hn,ut.autodetect.push({p:5,test:function(a){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];if(!l.length&&br(a)==="string"&&hn.test(a))return"css"}});var gn=S,ys=m,Cs=ne,Es=I.unpack;Cs.format.gl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Es(a,"rgba");return u[0]*=255,u[1]*=255,u[2]*=255,u},ys.gl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(gn,[null].concat(a,["gl"])))},gn.prototype.gl=function(){var a=this._rgb;return[a[0]/255,a[1]/255,a[2]/255,a[3]]};var Ms=I.unpack,Fs=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Ms(a,"rgb"),g=u[0],b=u[1],_=u[2],d=Math.min(g,b,_),$=Math.max(g,b,_),y=$-d,F=y*100/255,A=d/(255-y)*100,G;return y===0?G=Number.NaN:(g===$&&(G=(b-_)/y),b===$&&(G=2+(_-g)/y),_===$&&(G=4+(g-b)/y),G*=60,G<0&&(G+=360)),[G,F,A]},Is=Fs,As=I.unpack,Ps=Math.floor,Ss=function(){for(var a,l,u,g,b,_,d=[],$=arguments.length;$--;)d[$]=arguments[$];d=As(d,"hcg");var y=d[0],F=d[1],A=d[2],G,L,Q;A=A*255;var V=F*255;if(F===0)G=L=Q=A;else{y===360&&(y=0),y>360&&(y-=360),y<0&&(y+=360),y/=60;var ue=Ps(y),me=y-ue,Ce=A*(1-F),Fe=Ce+V*(1-me),et=Ce+V*me,Ze=Ce+V;switch(ue){case 0:a=[Ze,et,Ce],G=a[0],L=a[1],Q=a[2];break;case 1:l=[Fe,Ze,Ce],G=l[0],L=l[1],Q=l[2];break;case 2:u=[Ce,Ze,et],G=u[0],L=u[1],Q=u[2];break;case 3:g=[Ce,Fe,Ze],G=g[0],L=g[1],Q=g[2];break;case 4:b=[et,Ce,Ze],G=b[0],L=b[1],Q=b[2];break;case 5:_=[Ze,Ce,Fe],G=_[0],L=_[1],Q=_[2];break}}return[G,L,Q,d.length>3?d[3]:1]},Ls=Ss,Ds=I.unpack,Bs=I.type,Rs=m,pn=S,dn=ne,Ts=Is;pn.prototype.hcg=function(){return Ts(this._rgb)},Rs.hcg=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(pn,[null].concat(a,["hcg"])))},dn.format.hcg=Ls,dn.autodetect.push({p:1,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=Ds(a,"hcg"),Bs(a)==="array"&&a.length===3)return"hcg"}});var Os=I.unpack,Ns=I.last,_r=Math.round,zs=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Os(a,"rgba"),g=u[0],b=u[1],_=u[2],d=u[3],$=Ns(a)||"auto";d===void 0&&(d=1),$==="auto"&&($=d<1?"rgba":"rgb"),g=_r(g),b=_r(b),_=_r(_);var y=g<<16|b<<8|_,F="000000"+y.toString(16);F=F.substr(F.length-6);var A="0"+_r(d*255).toString(16);switch(A=A.substr(A.length-2),$.toLowerCase()){case"rgba":return"#"+F+A;case"argb":return"#"+A+F;default:return"#"+F}},vn=zs,xs=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,Us=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,js=function(a){if(a.match(xs)){(a.length===4||a.length===7)&&(a=a.substr(1)),a.length===3&&(a=a.split(""),a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]);var l=parseInt(a,16),u=l>>16,g=l>>8&255,b=l&255;return[u,g,b,1]}if(a.match(Us)){(a.length===5||a.length===9)&&(a=a.substr(1)),a.length===4&&(a=a.split(""),a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]+a[3]+a[3]);var _=parseInt(a,16),d=_>>24&255,$=_>>16&255,y=_>>8&255,F=Math.round((_&255)/255*100)/100;return[d,$,y,F]}throw new Error("unknown hex color: "+a)},mn=js,Gs=m,bn=S,qs=I.type,_n=ne,Ws=vn;bn.prototype.hex=function(a){return Ws(this._rgb,a)},Gs.hex=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(bn,[null].concat(a,["hex"])))},_n.format.hex=mn,_n.autodetect.push({p:4,test:function(a){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];if(!l.length&&qs(a)==="string"&&[3,4,5,6,7,8,9].indexOf(a.length)>=0)return"hex"}});var Hs=I.unpack,wn=I.TWOPI,Vs=Math.min,Ys=Math.sqrt,Qs=Math.acos,Xs=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Hs(a,"rgb"),g=u[0],b=u[1],_=u[2];g/=255,b/=255,_/=255;var d,$=Vs(g,b,_),y=(g+b+_)/3,F=y>0?1-$/y:0;return F===0?d=NaN:(d=(g-b+(g-_))/2,d/=Ys((g-b)*(g-b)+(g-_)*(b-_)),d=Qs(d),_>b&&(d=wn-d),d/=wn),[d*360,F,y]},Js=Xs,Zs=I.unpack,Lr=I.limit,Vt=I.TWOPI,Dr=I.PITHIRD,Yt=Math.cos,Ks=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=Zs(a,"hsi");var u=a[0],g=a[1],b=a[2],_,d,$;return isNaN(u)&&(u=0),isNaN(g)&&(g=0),u>360&&(u-=360),u<0&&(u+=360),u/=360,u<1/3?($=(1-g)/3,_=(1+g*Yt(Vt*u)/Yt(Dr-Vt*u))/3,d=1-($+_)):u<2/3?(u-=1/3,_=(1-g)/3,d=(1+g*Yt(Vt*u)/Yt(Dr-Vt*u))/3,$=1-(_+d)):(u-=2/3,d=(1-g)/3,$=(1+g*Yt(Vt*u)/Yt(Dr-Vt*u))/3,_=1-(d+$)),_=Lr(b*_*3),d=Lr(b*d*3),$=Lr(b*$*3),[_*255,d*255,$*255,a.length>3?a[3]:1]},el=Ks,tl=I.unpack,rl=I.type,nl=m,kn=S,$n=ne,al=Js;kn.prototype.hsi=function(){return al(this._rgb)},nl.hsi=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(kn,[null].concat(a,["hsi"])))},$n.format.hsi=el,$n.autodetect.push({p:2,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=tl(a,"hsi"),rl(a)==="array"&&a.length===3)return"hsi"}});var sl=I.unpack,ll=I.type,il=m,yn=S,Cn=ne,ol=K;yn.prototype.hsl=function(){return ol(this._rgb)},il.hsl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(yn,[null].concat(a,["hsl"])))},Cn.format.hsl=wt,Cn.autodetect.push({p:2,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=sl(a,"hsl"),ll(a)==="array"&&a.length===3)return"hsl"}});var fl=I.unpack,ul=Math.min,cl=Math.max,hl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=fl(a,"rgb");var u=a[0],g=a[1],b=a[2],_=ul(u,g,b),d=cl(u,g,b),$=d-_,y,F,A;return A=d/255,d===0?(y=Number.NaN,F=0):(F=$/d,u===d&&(y=(g-b)/$),g===d&&(y=2+(b-u)/$),b===d&&(y=4+(u-g)/$),y*=60,y<0&&(y+=360)),[y,F,A]},gl=hl,pl=I.unpack,dl=Math.floor,vl=function(){for(var a,l,u,g,b,_,d=[],$=arguments.length;$--;)d[$]=arguments[$];d=pl(d,"hsv");var y=d[0],F=d[1],A=d[2],G,L,Q;if(A*=255,F===0)G=L=Q=A;else{y===360&&(y=0),y>360&&(y-=360),y<0&&(y+=360),y/=60;var V=dl(y),ue=y-V,me=A*(1-F),Ce=A*(1-F*ue),Fe=A*(1-F*(1-ue));switch(V){case 0:a=[A,Fe,me],G=a[0],L=a[1],Q=a[2];break;case 1:l=[Ce,A,me],G=l[0],L=l[1],Q=l[2];break;case 2:u=[me,A,Fe],G=u[0],L=u[1],Q=u[2];break;case 3:g=[me,Ce,A],G=g[0],L=g[1],Q=g[2];break;case 4:b=[Fe,me,A],G=b[0],L=b[1],Q=b[2];break;case 5:_=[A,me,Ce],G=_[0],L=_[1],Q=_[2];break}}return[G,L,Q,d.length>3?d[3]:1]},ml=vl,bl=I.unpack,_l=I.type,wl=m,En=S,Mn=ne,kl=gl;En.prototype.hsv=function(){return kl(this._rgb)},wl.hsv=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(En,[null].concat(a,["hsv"])))},Mn.format.hsv=ml,Mn.autodetect.push({p:2,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=bl(a,"hsv"),_l(a)==="array"&&a.length===3)return"hsv"}});var wr={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},Qt=wr,$l=I.unpack,Fn=Math.pow,yl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=$l(a,"rgb"),g=u[0],b=u[1],_=u[2],d=Cl(g,b,_),$=d[0],y=d[1],F=d[2],A=116*y-16;return[A<0?0:A,500*($-y),200*(y-F)]},Br=function(a){return(a/=255)<=.04045?a/12.92:Fn((a+.055)/1.055,2.4)},Rr=function(a){return a>Qt.t3?Fn(a,1/3):a/Qt.t2+Qt.t0},Cl=function(a,l,u){a=Br(a),l=Br(l),u=Br(u);var g=Rr((.4124564*a+.3575761*l+.1804375*u)/Qt.Xn),b=Rr((.2126729*a+.7151522*l+.072175*u)/Qt.Yn),_=Rr((.0193339*a+.119192*l+.9503041*u)/Qt.Zn);return[g,b,_]},In=yl,Xt=wr,El=I.unpack,Ml=Math.pow,Fl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=El(a,"lab");var u=a[0],g=a[1],b=a[2],_,d,$,y,F,A;return d=(u+16)/116,_=isNaN(g)?d:d+g/500,$=isNaN(b)?d:d-b/200,d=Xt.Yn*Or(d),_=Xt.Xn*Or(_),$=Xt.Zn*Or($),y=Tr(3.2404542*_-1.5371385*d-.4985314*$),F=Tr(-.969266*_+1.8760108*d+.041556*$),A=Tr(.0556434*_-.2040259*d+1.0572252*$),[y,F,A,a.length>3?a[3]:1]},Tr=function(a){return 255*(a<=.00304?12.92*a:1.055*Ml(a,1/2.4)-.055)},Or=function(a){return a>Xt.t1?a*a*a:Xt.t2*(a-Xt.t0)},An=Fl,Il=I.unpack,Al=I.type,Pl=m,Pn=S,Sn=ne,Sl=In;Pn.prototype.lab=function(){return Sl(this._rgb)},Pl.lab=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(Pn,[null].concat(a,["lab"])))},Sn.format.lab=An,Sn.autodetect.push({p:2,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=Il(a,"lab"),Al(a)==="array"&&a.length===3)return"lab"}});var Ll=I.unpack,Dl=I.RAD2DEG,Bl=Math.sqrt,Rl=Math.atan2,Tl=Math.round,Ol=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Ll(a,"lab"),g=u[0],b=u[1],_=u[2],d=Bl(b*b+_*_),$=(Rl(_,b)*Dl+360)%360;return Tl(d*1e4)===0&&($=Number.NaN),[g,d,$]},Ln=Ol,Nl=I.unpack,zl=In,xl=Ln,Ul=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Nl(a,"rgb"),g=u[0],b=u[1],_=u[2],d=zl(g,b,_),$=d[0],y=d[1],F=d[2];return xl($,y,F)},jl=Ul,Gl=I.unpack,ql=I.DEG2RAD,Wl=Math.sin,Hl=Math.cos,Vl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Gl(a,"lch"),g=u[0],b=u[1],_=u[2];return isNaN(_)&&(_=0),_=_*ql,[g,Hl(_)*b,Wl(_)*b]},Dn=Vl,Yl=I.unpack,Ql=Dn,Xl=An,Jl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=Yl(a,"lch");var u=a[0],g=a[1],b=a[2],_=Ql(u,g,b),d=_[0],$=_[1],y=_[2],F=Xl(d,$,y),A=F[0],G=F[1],L=F[2];return[A,G,L,a.length>3?a[3]:1]},Bn=Jl,Zl=I.unpack,Kl=Bn,ei=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Zl(a,"hcl").reverse();return Kl.apply(void 0,u)},ti=ei,ri=I.unpack,ni=I.type,Rn=m,kr=S,Nr=ne,Tn=jl;kr.prototype.lch=function(){return Tn(this._rgb)},kr.prototype.hcl=function(){return Tn(this._rgb).reverse()},Rn.lch=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(kr,[null].concat(a,["lch"])))},Rn.hcl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(kr,[null].concat(a,["hcl"])))},Nr.format.lch=Bn,Nr.format.hcl=ti,["lch","hcl"].forEach(function(a){return Nr.autodetect.push({p:2,test:function(){for(var l=[],u=arguments.length;u--;)l[u]=arguments[u];if(l=ri(l,a),ni(l)==="array"&&l.length===3)return a}})});var ai={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},On=ai,si=S,Nn=ne,li=I.type,gr=On,ii=mn,oi=vn;si.prototype.name=function(){for(var a=oi(this._rgb,"rgb"),l=0,u=Object.keys(gr);l<u.length;l+=1){var g=u[l];if(gr[g]===a)return g.toLowerCase()}return a},Nn.format.named=function(a){if(a=a.toLowerCase(),gr[a])return ii(gr[a]);throw new Error("unknown color name: "+a)},Nn.autodetect.push({p:5,test:function(a){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];if(!l.length&&li(a)==="string"&&gr[a.toLowerCase()])return"named"}});var fi=I.unpack,ui=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=fi(a,"rgb"),g=u[0],b=u[1],_=u[2];return(g<<16)+(b<<8)+_},ci=ui,hi=I.type,gi=function(a){if(hi(a)=="number"&&a>=0&&a<=16777215){var l=a>>16,u=a>>8&255,g=a&255;return[l,u,g,1]}throw new Error("unknown num color: "+a)},pi=gi,di=m,zn=S,xn=ne,vi=I.type,mi=ci;zn.prototype.num=function(){return mi(this._rgb)},di.num=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(zn,[null].concat(a,["num"])))},xn.format.num=pi,xn.autodetect.push({p:5,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a.length===1&&vi(a[0])==="number"&&a[0]>=0&&a[0]<=16777215)return"num"}});var bi=m,zr=S,Un=ne,jn=I.unpack,Gn=I.type,qn=Math.round;zr.prototype.rgb=function(a){return a===void 0&&(a=!0),a===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(qn)},zr.prototype.rgba=function(a){return a===void 0&&(a=!0),this._rgb.slice(0,4).map(function(l,u){return u<3?a===!1?l:qn(l):l})},bi.rgb=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(zr,[null].concat(a,["rgb"])))},Un.format.rgb=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=jn(a,"rgba");return u[3]===void 0&&(u[3]=1),u},Un.autodetect.push({p:3,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=jn(a,"rgba"),Gn(a)==="array"&&(a.length===3||a.length===4&&Gn(a[3])=="number"&&a[3]>=0&&a[3]<=1))return"rgb"}});var $r=Math.log,_i=function(a){var l=a/100,u,g,b;return l<66?(u=255,g=l<6?0:-155.25485562709179-.44596950469579133*(g=l-2)+104.49216199393888*$r(g),b=l<20?0:-254.76935184120902+.8274096064007395*(b=l-10)+115.67994401066147*$r(b)):(u=351.97690566805693+.114206453784165*(u=l-55)-40.25366309332127*$r(u),g=325.4494125711974+.07943456536662342*(g=l-50)-28.0852963507957*$r(g),b=255),[u,g,b,1]},Wn=_i,wi=Wn,ki=I.unpack,$i=Math.round,yi=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];for(var u=ki(a,"rgb"),g=u[0],b=u[2],_=1e3,d=4e4,$=.4,y;d-_>$;){y=(d+_)*.5;var F=wi(y);F[2]/F[0]>=b/g?d=y:_=y}return $i(y)},Ci=yi,xr=m,yr=S,Ur=ne,Ei=Ci;yr.prototype.temp=yr.prototype.kelvin=yr.prototype.temperature=function(){return Ei(this._rgb)},xr.temp=xr.kelvin=xr.temperature=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(yr,[null].concat(a,["temp"])))},Ur.format.temp=Ur.format.kelvin=Ur.format.temperature=Wn;var Mi=I.unpack,jr=Math.cbrt,Fi=Math.pow,Ii=Math.sign,Ai=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Mi(a,"rgb"),g=u[0],b=u[1],_=u[2],d=[Gr(g/255),Gr(b/255),Gr(_/255)],$=d[0],y=d[1],F=d[2],A=jr(.4122214708*$+.5363325363*y+.0514459929*F),G=jr(.2119034982*$+.6806995451*y+.1073969566*F),L=jr(.0883024619*$+.2817188376*y+.6299787005*F);return[.2104542553*A+.793617785*G-.0040720468*L,1.9779984951*A-2.428592205*G+.4505937099*L,.0259040371*A+.7827717662*G-.808675766*L]},Hn=Ai;function Gr(a){var l=Math.abs(a);return l<.04045?a/12.92:(Ii(a)||1)*Fi((l+.055)/1.055,2.4)}var Pi=I.unpack,Cr=Math.pow,Si=Math.sign,Li=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=Pi(a,"lab");var u=a[0],g=a[1],b=a[2],_=Cr(u+.3963377774*g+.2158037573*b,3),d=Cr(u-.1055613458*g-.0638541728*b,3),$=Cr(u-.0894841775*g-1.291485548*b,3);return[255*qr(4.0767416621*_-3.3077115913*d+.2309699292*$),255*qr(-1.2684380046*_+2.6097574011*d-.3413193965*$),255*qr(-.0041960863*_-.7034186147*d+1.707614701*$),a.length>3?a[3]:1]},Vn=Li;function qr(a){var l=Math.abs(a);return l>.0031308?(Si(a)||1)*(1.055*Cr(l,1/2.4)-.055):a*12.92}var Di=I.unpack,Bi=I.type,Ri=m,Yn=S,Qn=ne,Ti=Hn;Yn.prototype.oklab=function(){return Ti(this._rgb)},Ri.oklab=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(Yn,[null].concat(a,["oklab"])))},Qn.format.oklab=Vn,Qn.autodetect.push({p:3,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=Di(a,"oklab"),Bi(a)==="array"&&a.length===3)return"oklab"}});var Oi=I.unpack,Ni=Hn,zi=Ln,xi=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Oi(a,"rgb"),g=u[0],b=u[1],_=u[2],d=Ni(g,b,_),$=d[0],y=d[1],F=d[2];return zi($,y,F)},Ui=xi,ji=I.unpack,Gi=Dn,qi=Vn,Wi=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=ji(a,"lch");var u=a[0],g=a[1],b=a[2],_=Gi(u,g,b),d=_[0],$=_[1],y=_[2],F=qi(d,$,y),A=F[0],G=F[1],L=F[2];return[A,G,L,a.length>3?a[3]:1]},Hi=Wi,Vi=I.unpack,Yi=I.type,Qi=m,Xn=S,Jn=ne,Xi=Ui;Xn.prototype.oklch=function(){return Xi(this._rgb)},Qi.oklch=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(Xn,[null].concat(a,["oklch"])))},Jn.format.oklch=Hi,Jn.autodetect.push({p:3,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=Vi(a,"oklch"),Yi(a)==="array"&&a.length===3)return"oklch"}});var Zn=S,Ji=I.type;Zn.prototype.alpha=function(a,l){return l===void 0&&(l=!1),a!==void 0&&Ji(a)==="number"?l?(this._rgb[3]=a,this):new Zn([this._rgb[0],this._rgb[1],this._rgb[2],a],"rgb"):this._rgb[3]};var Zi=S;Zi.prototype.clipped=function(){return this._rgb._clipped||!1};var jt=S,Ki=wr;jt.prototype.darken=function(a){a===void 0&&(a=1);var l=this,u=l.lab();return u[0]-=Ki.Kn*a,new jt(u,"lab").alpha(l.alpha(),!0)},jt.prototype.brighten=function(a){return a===void 0&&(a=1),this.darken(-a)},jt.prototype.darker=jt.prototype.darken,jt.prototype.brighter=jt.prototype.brighten;var eo=S;eo.prototype.get=function(a){var l=a.split("."),u=l[0],g=l[1],b=this[u]();if(g){var _=u.indexOf(g)-(u.substr(0,2)==="ok"?2:0);if(_>-1)return b[_];throw new Error("unknown channel "+g+" in mode "+u)}else return b};var Jt=S,to=I.type,ro=Math.pow,no=1e-7,ao=20;Jt.prototype.luminance=function(a){if(a!==void 0&&to(a)==="number"){if(a===0)return new Jt([0,0,0,this._rgb[3]],"rgb");if(a===1)return new Jt([255,255,255,this._rgb[3]],"rgb");var l=this.luminance(),u="rgb",g=ao,b=function(d,$){var y=d.interpolate($,.5,u),F=y.luminance();return Math.abs(a-F)<no||!g--?y:F>a?b(d,y):b(y,$)},_=(l>a?b(new Jt([0,0,0]),this):b(this,new Jt([255,255,255]))).rgb();return new Jt(_.concat([this._rgb[3]]))}return so.apply(void 0,this._rgb.slice(0,3))};var so=function(a,l,u){return a=Wr(a),l=Wr(l),u=Wr(u),.2126*a+.7152*l+.0722*u},Wr=function(a){return a/=255,a<=.03928?a/12.92:ro((a+.055)/1.055,2.4)},mt={},Kn=S,ea=I.type,Er=mt,ta=function(a,l,u){u===void 0&&(u=.5);for(var g=[],b=arguments.length-3;b-- >0;)g[b]=arguments[b+3];var _=g[0]||"lrgb";if(!Er[_]&&!g.length&&(_=Object.keys(Er)[0]),!Er[_])throw new Error("interpolation mode "+_+" is not defined");return ea(a)!=="object"&&(a=new Kn(a)),ea(l)!=="object"&&(l=new Kn(l)),Er[_](a,l,u).alpha(a.alpha()+u*(l.alpha()-a.alpha()))},ra=S,lo=ta;ra.prototype.mix=ra.prototype.interpolate=function(a,l){l===void 0&&(l=.5);for(var u=[],g=arguments.length-2;g-- >0;)u[g]=arguments[g+2];return lo.apply(void 0,[this,a,l].concat(u))};var na=S;na.prototype.premultiply=function(a){a===void 0&&(a=!1);var l=this._rgb,u=l[3];return a?(this._rgb=[l[0]*u,l[1]*u,l[2]*u,u],this):new na([l[0]*u,l[1]*u,l[2]*u,u],"rgb")};var Hr=S,io=wr;Hr.prototype.saturate=function(a){a===void 0&&(a=1);var l=this,u=l.lch();return u[1]+=io.Kn*a,u[1]<0&&(u[1]=0),new Hr(u,"lch").alpha(l.alpha(),!0)},Hr.prototype.desaturate=function(a){return a===void 0&&(a=1),this.saturate(-a)};var aa=S,sa=I.type;aa.prototype.set=function(a,l,u){u===void 0&&(u=!1);var g=a.split("."),b=g[0],_=g[1],d=this[b]();if(_){var $=b.indexOf(_)-(b.substr(0,2)==="ok"?2:0);if($>-1){if(sa(l)=="string")switch(l.charAt(0)){case"+":d[$]+=+l;break;case"-":d[$]+=+l;break;case"*":d[$]*=+l.substr(1);break;case"/":d[$]/=+l.substr(1);break;default:d[$]=+l}else if(sa(l)==="number")d[$]=l;else throw new Error("unsupported value for Color.set");var y=new aa(d,b);return u?(this._rgb=y._rgb,this):y}throw new Error("unknown channel "+_+" in mode "+b)}else return d};var oo=S,fo=function(a,l,u){var g=a._rgb,b=l._rgb;return new oo(g[0]+u*(b[0]-g[0]),g[1]+u*(b[1]-g[1]),g[2]+u*(b[2]-g[2]),"rgb")};mt.rgb=fo;var uo=S,Vr=Math.sqrt,Zt=Math.pow,co=function(a,l,u){var g=a._rgb,b=g[0],_=g[1],d=g[2],$=l._rgb,y=$[0],F=$[1],A=$[2];return new uo(Vr(Zt(b,2)*(1-u)+Zt(y,2)*u),Vr(Zt(_,2)*(1-u)+Zt(F,2)*u),Vr(Zt(d,2)*(1-u)+Zt(A,2)*u),"rgb")};mt.lrgb=co;var ho=S,go=function(a,l,u){var g=a.lab(),b=l.lab();return new ho(g[0]+u*(b[0]-g[0]),g[1]+u*(b[1]-g[1]),g[2]+u*(b[2]-g[2]),"lab")};mt.lab=go;var la=S,Kt=function(a,l,u,g){var b,_,d,$;g==="hsl"?(d=a.hsl(),$=l.hsl()):g==="hsv"?(d=a.hsv(),$=l.hsv()):g==="hcg"?(d=a.hcg(),$=l.hcg()):g==="hsi"?(d=a.hsi(),$=l.hsi()):g==="lch"||g==="hcl"?(g="hcl",d=a.hcl(),$=l.hcl()):g==="oklch"&&(d=a.oklch().reverse(),$=l.oklch().reverse());var y,F,A,G,L,Q;(g.substr(0,1)==="h"||g==="oklch")&&(b=d,y=b[0],A=b[1],L=b[2],_=$,F=_[0],G=_[1],Q=_[2]);var V,ue,me,Ce;return!isNaN(y)&&!isNaN(F)?(F>y&&F-y>180?Ce=F-(y+360):F<y&&y-F>180?Ce=F+360-y:Ce=F-y,ue=y+u*Ce):isNaN(y)?isNaN(F)?ue=Number.NaN:(ue=F,(L==1||L==0)&&g!="hsv"&&(V=G)):(ue=y,(Q==1||Q==0)&&g!="hsv"&&(V=A)),V===void 0&&(V=A+u*(G-A)),me=L+u*(Q-L),g==="oklch"?new la([me,V,ue],g):new la([ue,V,me],g)},po=Kt,ia=function(a,l,u){return po(a,l,u,"lch")};mt.lch=ia,mt.hcl=ia;var vo=S,mo=function(a,l,u){var g=a.num(),b=l.num();return new vo(g+u*(b-g),"num")};mt.num=mo;var bo=Kt,_o=function(a,l,u){return bo(a,l,u,"hcg")};mt.hcg=_o;var wo=Kt,ko=function(a,l,u){return wo(a,l,u,"hsi")};mt.hsi=ko;var $o=Kt,yo=function(a,l,u){return $o(a,l,u,"hsl")};mt.hsl=yo;var Co=Kt,Eo=function(a,l,u){return Co(a,l,u,"hsv")};mt.hsv=Eo;var Mo=S,Fo=function(a,l,u){var g=a.oklab(),b=l.oklab();return new Mo(g[0]+u*(b[0]-g[0]),g[1]+u*(b[1]-g[1]),g[2]+u*(b[2]-g[2]),"oklab")};mt.oklab=Fo;var Io=Kt,Ao=function(a,l,u){return Io(a,l,u,"oklch")};mt.oklch=Ao;var Yr=S,Po=I.clip_rgb,Qr=Math.pow,Xr=Math.sqrt,Jr=Math.PI,oa=Math.cos,fa=Math.sin,So=Math.atan2,Lo=function(a,l,u){l===void 0&&(l="lrgb"),u===void 0&&(u=null);var g=a.length;u||(u=Array.from(new Array(g)).map(function(){return 1}));var b=g/u.reduce(function(ue,me){return ue+me});if(u.forEach(function(ue,me){u[me]*=b}),a=a.map(function(ue){return new Yr(ue)}),l==="lrgb")return Do(a,u);for(var _=a.shift(),d=_.get(l),$=[],y=0,F=0,A=0;A<d.length;A++)if(d[A]=(d[A]||0)*u[0],$.push(isNaN(d[A])?0:u[0]),l.charAt(A)==="h"&&!isNaN(d[A])){var G=d[A]/180*Jr;y+=oa(G)*u[0],F+=fa(G)*u[0]}var L=_.alpha()*u[0];a.forEach(function(ue,me){var Ce=ue.get(l);L+=ue.alpha()*u[me+1];for(var Fe=0;Fe<d.length;Fe++)if(!isNaN(Ce[Fe]))if($[Fe]+=u[me+1],l.charAt(Fe)==="h"){var et=Ce[Fe]/180*Jr;y+=oa(et)*u[me+1],F+=fa(et)*u[me+1]}else d[Fe]+=Ce[Fe]*u[me+1]});for(var Q=0;Q<d.length;Q++)if(l.charAt(Q)==="h"){for(var V=So(F/$[Q],y/$[Q])/Jr*180;V<0;)V+=360;for(;V>=360;)V-=360;d[Q]=V}else d[Q]=d[Q]/$[Q];return L/=g,new Yr(d,l).alpha(L>.99999?1:L,!0)},Do=function(a,l){for(var u=a.length,g=[0,0,0,0],b=0;b<a.length;b++){var _=a[b],d=l[b]/u,$=_._rgb;g[0]+=Qr($[0],2)*d,g[1]+=Qr($[1],2)*d,g[2]+=Qr($[2],2)*d,g[3]+=$[3]*d}return g[0]=Xr(g[0]),g[1]=Xr(g[1]),g[2]=Xr(g[2]),g[3]>.9999999&&(g[3]=1),new Yr(Po(g))},Mt=m,er=I.type,Bo=Math.pow,Zr=function(a){var l="rgb",u=Mt("#ccc"),g=0,b=[0,1],_=[],d=[0,0],$=!1,y=[],F=!1,A=0,G=1,L=!1,Q={},V=!0,ue=1,me=function(D){if(D=D||["#fff","#000"],D&&er(D)==="string"&&Mt.brewer&&Mt.brewer[D.toLowerCase()]&&(D=Mt.brewer[D.toLowerCase()]),er(D)==="array"){D.length===1&&(D=[D[0],D[0]]),D=D.slice(0);for(var se=0;se<D.length;se++)D[se]=Mt(D[se]);_.length=0;for(var ve=0;ve<D.length;ve++)_.push(ve/(D.length-1))}return pt(),y=D},Ce=function(D){if($!=null){for(var se=$.length-1,ve=0;ve<se&&D>=$[ve];)ve++;return ve-1}return 0},Fe=function(D){return D},et=function(D){return D},Ze=function(D,se){var ve,ce;if(se==null&&(se=!1),isNaN(D)||D===null)return u;if(se)ce=D;else if($&&$.length>2){var tt=Ce(D);ce=tt/($.length-2)}else G!==A?ce=(D-A)/(G-A):ce=1;ce=et(ce),se||(ce=Fe(ce)),ue!==1&&(ce=Bo(ce,ue)),ce=d[0]+ce*(1-d[0]-d[1]),ce=Math.min(1,Math.max(0,ce));var ze=Math.floor(ce*1e4);if(V&&Q[ze])ve=Q[ze];else{if(er(y)==="array")for(var Ee=0;Ee<_.length;Ee++){var Ae=_[Ee];if(ce<=Ae){ve=y[Ee];break}if(ce>=Ae&&Ee===_.length-1){ve=y[Ee];break}if(ce>Ae&&ce<_[Ee+1]){ce=(ce-Ae)/(_[Ee+1]-Ae),ve=Mt.interpolate(y[Ee],y[Ee+1],ce,l);break}}else er(y)==="function"&&(ve=y(ce));V&&(Q[ze]=ve)}return ve},pt=function(){return Q={}};me(a);var ye=function(D){var se=Mt(Ze(D));return F&&se[F]?se[F]():se};return ye.classes=function(D){if(D!=null){if(er(D)==="array")$=D,b=[D[0],D[D.length-1]];else{var se=Mt.analyze(b);D===0?$=[se.min,se.max]:$=Mt.limits(se,"e",D)}return ye}return $},ye.domain=function(D){if(!arguments.length)return b;A=D[0],G=D[D.length-1],_=[];var se=y.length;if(D.length===se&&A!==G)for(var ve=0,ce=Array.from(D);ve<ce.length;ve+=1){var tt=ce[ve];_.push((tt-A)/(G-A))}else{for(var ze=0;ze<se;ze++)_.push(ze/(se-1));if(D.length>2){var Ee=D.map(function(Pe,Le){return Le/(D.length-1)}),Ae=D.map(function(Pe){return(Pe-A)/(G-A)});Ae.every(function(Pe,Le){return Ee[Le]===Pe})||(et=function(Pe){if(Pe<=0||Pe>=1)return Pe;for(var Le=0;Pe>=Ae[Le+1];)Le++;var It=(Pe-Ae[Le])/(Ae[Le+1]-Ae[Le]),Ot=Ee[Le]+It*(Ee[Le+1]-Ee[Le]);return Ot})}}return b=[A,G],ye},ye.mode=function(D){return arguments.length?(l=D,pt(),ye):l},ye.range=function(D,se){return me(D),ye},ye.out=function(D){return F=D,ye},ye.spread=function(D){return arguments.length?(g=D,ye):g},ye.correctLightness=function(D){return D==null&&(D=!0),L=D,pt(),L?Fe=function(se){for(var ve=Ze(0,!0).lab()[0],ce=Ze(1,!0).lab()[0],tt=ve>ce,ze=Ze(se,!0).lab()[0],Ee=ve+(ce-ve)*se,Ae=ze-Ee,Pe=0,Le=1,It=20;Math.abs(Ae)>.01&&It-- >0;)(function(){return tt&&(Ae*=-1),Ae<0?(Pe=se,se+=(Le-se)*.5):(Le=se,se+=(Pe-se)*.5),ze=Ze(se,!0).lab()[0],Ae=ze-Ee})();return se}:Fe=function(se){return se},ye},ye.padding=function(D){return D!=null?(er(D)==="number"&&(D=[D,D]),d=D,ye):d},ye.colors=function(D,se){arguments.length<2&&(se="hex");var ve=[];if(arguments.length===0)ve=y.slice(0);else if(D===1)ve=[ye(.5)];else if(D>1){var ce=b[0],tt=b[1]-ce;ve=Ro(0,D,!1).map(function(Le){return ye(ce+Le/(D-1)*tt)})}else{a=[];var ze=[];if($&&$.length>2)for(var Ee=1,Ae=$.length,Pe=1<=Ae;Pe?Ee<Ae:Ee>Ae;Pe?Ee++:Ee--)ze.push(($[Ee-1]+$[Ee])*.5);else ze=b;ve=ze.map(function(Le){return ye(Le)})}return Mt[se]&&(ve=ve.map(function(Le){return Le[se]()})),ve},ye.cache=function(D){return D!=null?(V=D,ye):V},ye.gamma=function(D){return D!=null?(ue=D,ye):ue},ye.nodata=function(D){return D!=null?(u=Mt(D),ye):u},ye};function Ro(a,l,u){for(var g=[],b=a<l,_=u?b?l+1:l-1:l,d=a;b?d<_:d>_;b?d++:d--)g.push(d);return g}var pr=S,To=Zr,Oo=function(a){for(var l=[1,1],u=1;u<a;u++){for(var g=[1],b=1;b<=l.length;b++)g[b]=(l[b]||0)+l[b-1];l=g}return l},No=function(a){var l,u,g,b,_,d,$;if(a=a.map(function(L){return new pr(L)}),a.length===2)l=a.map(function(L){return L.lab()}),_=l[0],d=l[1],b=function(L){var Q=[0,1,2].map(function(V){return _[V]+L*(d[V]-_[V])});return new pr(Q,"lab")};else if(a.length===3)u=a.map(function(L){return L.lab()}),_=u[0],d=u[1],$=u[2],b=function(L){var Q=[0,1,2].map(function(V){return(1-L)*(1-L)*_[V]+2*(1-L)*L*d[V]+L*L*$[V]});return new pr(Q,"lab")};else if(a.length===4){var y;g=a.map(function(L){return L.lab()}),_=g[0],d=g[1],$=g[2],y=g[3],b=function(L){var Q=[0,1,2].map(function(V){return(1-L)*(1-L)*(1-L)*_[V]+3*(1-L)*(1-L)*L*d[V]+3*(1-L)*L*L*$[V]+L*L*L*y[V]});return new pr(Q,"lab")}}else if(a.length>=5){var F,A,G;F=a.map(function(L){return L.lab()}),G=a.length-1,A=Oo(G),b=function(L){var Q=1-L,V=[0,1,2].map(function(ue){return F.reduce(function(me,Ce,Fe){return me+A[Fe]*Math.pow(Q,G-Fe)*Math.pow(L,Fe)*Ce[ue]},0)});return new pr(V,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return b},zo=function(a){var l=No(a);return l.scale=function(){return To(l)},l},Kr=m,Ft=function(a,l,u){if(!Ft[u])throw new Error("unknown blend mode "+u);return Ft[u](a,l)},Rt=function(a){return function(l,u){var g=Kr(u).rgb(),b=Kr(l).rgb();return Kr.rgb(a(g,b))}},Tt=function(a){return function(l,u){var g=[];return g[0]=a(l[0],u[0]),g[1]=a(l[1],u[1]),g[2]=a(l[2],u[2]),g}},xo=function(a){return a},Uo=function(a,l){return a*l/255},jo=function(a,l){return a>l?l:a},Go=function(a,l){return a>l?a:l},qo=function(a,l){return 255*(1-(1-a/255)*(1-l/255))},Wo=function(a,l){return l<128?2*a*l/255:255*(1-2*(1-a/255)*(1-l/255))},Ho=function(a,l){return 255*(1-(1-l/255)/(a/255))},Vo=function(a,l){return a===255?255:(a=255*(l/255)/(1-a/255),a>255?255:a)};Ft.normal=Rt(Tt(xo)),Ft.multiply=Rt(Tt(Uo)),Ft.screen=Rt(Tt(qo)),Ft.overlay=Rt(Tt(Wo)),Ft.darken=Rt(Tt(jo)),Ft.lighten=Rt(Tt(Go)),Ft.dodge=Rt(Tt(Vo)),Ft.burn=Rt(Tt(Ho));for(var Yo=Ft,en=I.type,Qo=I.clip_rgb,Xo=I.TWOPI,Jo=Math.pow,Zo=Math.sin,Ko=Math.cos,ua=m,ef=function(a,l,u,g,b){a===void 0&&(a=300),l===void 0&&(l=-1.5),u===void 0&&(u=1),g===void 0&&(g=1),b===void 0&&(b=[0,1]);var _=0,d;en(b)==="array"?d=b[1]-b[0]:(d=0,b=[b,b]);var $=function(y){var F=Xo*((a+120)/360+l*y),A=Jo(b[0]+d*y,g),G=_!==0?u[0]+y*_:u,L=G*A*(1-A)/2,Q=Ko(F),V=Zo(F),ue=A+L*(-.14861*Q+1.78277*V),me=A+L*(-.29227*Q-.90649*V),Ce=A+L*(1.97294*Q);return ua(Qo([ue*255,me*255,Ce*255,1]))};return $.start=function(y){return y==null?a:(a=y,$)},$.rotations=function(y){return y==null?l:(l=y,$)},$.gamma=function(y){return y==null?g:(g=y,$)},$.hue=function(y){return y==null?u:(u=y,en(u)==="array"?(_=u[1]-u[0],_===0&&(u=u[1])):_=0,$)},$.lightness=function(y){return y==null?b:(en(y)==="array"?(b=y,d=y[1]-y[0]):(b=[y,y],d=0),$)},$.scale=function(){return ua.scale($)},$.hue(u),$},tf=S,rf="0123456789abcdef",nf=Math.floor,af=Math.random,sf=function(){for(var a="#",l=0;l<6;l++)a+=rf.charAt(nf(af()*16));return new tf(a,"hex")},tn=h,ca=Math.log,lf=Math.pow,of=Math.floor,ff=Math.abs,ha=function(a,l){l===void 0&&(l=null);var u={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return tn(a)==="object"&&(a=Object.values(a)),a.forEach(function(g){l&&tn(g)==="object"&&(g=g[l]),g!=null&&!isNaN(g)&&(u.values.push(g),u.sum+=g,g<u.min&&(u.min=g),g>u.max&&(u.max=g),u.count+=1)}),u.domain=[u.min,u.max],u.limits=function(g,b){return ga(u,g,b)},u},ga=function(a,l,u){l===void 0&&(l="equal"),u===void 0&&(u=7),tn(a)=="array"&&(a=ha(a));var g=a.min,b=a.max,_=a.values.sort(function(nn,an){return nn-an});if(u===1)return[g,b];var d=[];if(l.substr(0,1)==="c"&&(d.push(g),d.push(b)),l.substr(0,1)==="e"){d.push(g);for(var $=1;$<u;$++)d.push(g+$/u*(b-g));d.push(b)}else if(l.substr(0,1)==="l"){if(g<=0)throw new Error("Logarithmic scales are only possible for values > 0");var y=Math.LOG10E*ca(g),F=Math.LOG10E*ca(b);d.push(g);for(var A=1;A<u;A++)d.push(lf(10,y+A/u*(F-y)));d.push(b)}else if(l.substr(0,1)==="q"){d.push(g);for(var G=1;G<u;G++){var L=(_.length-1)*G/u,Q=of(L);if(Q===L)d.push(_[Q]);else{var V=L-Q;d.push(_[Q]*(1-V)+_[Q+1]*V)}}d.push(b)}else if(l.substr(0,1)==="k"){var ue,me=_.length,Ce=new Array(me),Fe=new Array(u),et=!0,Ze=0,pt=null;pt=[],pt.push(g);for(var ye=1;ye<u;ye++)pt.push(g+ye/u*(b-g));for(pt.push(b);et;){for(var D=0;D<u;D++)Fe[D]=0;for(var se=0;se<me;se++)for(var ve=_[se],ce=Number.MAX_VALUE,tt=void 0,ze=0;ze<u;ze++){var Ee=ff(pt[ze]-ve);Ee<ce&&(ce=Ee,tt=ze),Fe[tt]++,Ce[se]=tt}for(var Ae=new Array(u),Pe=0;Pe<u;Pe++)Ae[Pe]=null;for(var Le=0;Le<me;Le++)ue=Ce[Le],Ae[ue]===null?Ae[ue]=_[Le]:Ae[ue]+=_[Le];for(var It=0;It<u;It++)Ae[It]*=1/Fe[It];et=!1;for(var Ot=0;Ot<u;Ot++)if(Ae[Ot]!==pt[Ot]){et=!0;break}pt=Ae,Ze++,Ze>200&&(et=!1)}for(var Nt={},tr=0;tr<u;tr++)Nt[tr]=[];for(var rr=0;rr<me;rr++)ue=Ce[rr],Nt[ue].push(_[rr]);for(var Bt=[],Gt=0;Gt<u;Gt++)Bt.push(Nt[Gt][0]),Bt.push(Nt[Gt][Nt[Gt].length-1]);Bt=Bt.sort(function(nn,an){return nn-an}),d.push(Bt[0]);for(var dr=1;dr<Bt.length;dr+=2){var qt=Bt[dr];!isNaN(qt)&&d.indexOf(qt)===-1&&d.push(qt)}}return d},pa={analyze:ha,limits:ga},da=S,uf=function(a,l){a=new da(a),l=new da(l);var u=a.luminance(),g=l.luminance();return u>g?(u+.05)/(g+.05):(g+.05)/(u+.05)},va=S,Dt=Math.sqrt,Qe=Math.pow,cf=Math.min,hf=Math.max,ma=Math.atan2,ba=Math.abs,Mr=Math.cos,_a=Math.sin,gf=Math.exp,wa=Math.PI,pf=function(a,l,u,g,b){u===void 0&&(u=1),g===void 0&&(g=1),b===void 0&&(b=1);var _=function(qt){return 360*qt/(2*wa)},d=function(qt){return 2*wa*qt/360};a=new va(a),l=new va(l);var $=Array.from(a.lab()),y=$[0],F=$[1],A=$[2],G=Array.from(l.lab()),L=G[0],Q=G[1],V=G[2],ue=(y+L)/2,me=Dt(Qe(F,2)+Qe(A,2)),Ce=Dt(Qe(Q,2)+Qe(V,2)),Fe=(me+Ce)/2,et=.5*(1-Dt(Qe(Fe,7)/(Qe(Fe,7)+Qe(25,7)))),Ze=F*(1+et),pt=Q*(1+et),ye=Dt(Qe(Ze,2)+Qe(A,2)),D=Dt(Qe(pt,2)+Qe(V,2)),se=(ye+D)/2,ve=_(ma(A,Ze)),ce=_(ma(V,pt)),tt=ve>=0?ve:ve+360,ze=ce>=0?ce:ce+360,Ee=ba(tt-ze)>180?(tt+ze+360)/2:(tt+ze)/2,Ae=1-.17*Mr(d(Ee-30))+.24*Mr(d(2*Ee))+.32*Mr(d(3*Ee+6))-.2*Mr(d(4*Ee-63)),Pe=ze-tt;Pe=ba(Pe)<=180?Pe:ze<=tt?Pe+360:Pe-360,Pe=2*Dt(ye*D)*_a(d(Pe)/2);var Le=L-y,It=D-ye,Ot=1+.015*Qe(ue-50,2)/Dt(20+Qe(ue-50,2)),Nt=1+.045*se,tr=1+.015*se*Ae,rr=30*gf(-Qe((Ee-275)/25,2)),Bt=2*Dt(Qe(se,7)/(Qe(se,7)+Qe(25,7))),Gt=-Bt*_a(2*d(rr)),dr=Dt(Qe(Le/(u*Ot),2)+Qe(It/(g*Nt),2)+Qe(Pe/(b*tr),2)+Gt*(It/(g*Nt))*(Pe/(b*tr)));return hf(0,cf(100,dr))},ka=S,df=function(a,l,u){u===void 0&&(u="lab"),a=new ka(a),l=new ka(l);var g=a.get(u),b=l.get(u),_=0;for(var d in g){var $=(g[d]||0)-(b[d]||0);_+=$*$}return Math.sqrt(_)},vf=S,mf=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];try{return new(Function.prototype.bind.apply(vf,[null].concat(a))),!0}catch{return!1}},$a=m,ya=Zr,bf={cool:function(){return ya([$a.hsl(180,1,.9),$a.hsl(250,.7,.4)])},hot:function(){return ya(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Fr={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},rn=0,Ca=Object.keys(Fr);rn<Ca.length;rn+=1){var Ea=Ca[rn];Fr[Ea.toLowerCase()]=Fr[Ea]}var _f=Fr,Je=m;Je.average=Lo,Je.bezier=zo,Je.blend=Yo,Je.cubehelix=ef,Je.mix=Je.interpolate=ta,Je.random=sf,Je.scale=Zr,Je.analyze=pa.analyze,Je.contrast=uf,Je.deltaE=pf,Je.distance=df,Je.limits=pa.limits,Je.valid=mf,Je.scales=bf,Je.colors=On,Je.brewer=_f;var wf=Je;return wf})})($s);var Tu=$s.exports;const ar=ds(Tu);function Ou(i){let e,t,r,n,s,o,c,f;return{c(){e=ee("div"),t=ee("label"),r=xe(i[1]),n=xe(":"),s=be(),o=ee("input"),this.h()},l(h){e=te(h,"DIV",{class:!0});var p=q(e);t=te(p,"LABEL",{class:!0});var w=q(t);r=Ue(w,i[1]),n=Ue(w,":"),w.forEach(C),s=_e(p),o=te(p,"INPUT",{type:!0,name:!0,id:!0,class:!0}),p.forEach(C),this.h()},h(){E(t,"class","pr-2 text-xs text-neutral-400 text-right"),E(o,"type","color"),E(o,"name",i[1]),E(o,"id",i[1]),E(o,"class","emboss py-1 px-2 bg-neutral-700 border border-neutral-800 text-xs text-neutral-200"),E(e,"class","flex items-center")},m(h,p){X(h,e,p),N(e,t),N(t,r),N(t,n),N(e,s),N(e,o),Ma(o,i[0]),c||(f=[$t(o,"input",i[2]),$t(o,"input",i[3])],c=!0)},p(h,[p]){p&2&&yt(r,h[1]),p&2&&E(o,"name",h[1]),p&2&&E(o,"id",h[1]),p&1&&Ma(o,h[0])},i:je,o:je,d(h){h&&C(e),c=!1,on(f)}}}function Nu(i,e,t){let{name:r}=e,{value:n="#0000FF"}=e;const s=mr();function o(f){if(f.target){const h=f.target;s("change",h.value)}}function c(){n=this.value,t(0,n)}return i.$$set=f=>{"name"in f&&t(1,r=f.name),"value"in f&&t(0,n=f.value)},[n,r,o,c]}class zu extends rt{constructor(e){super(),nt(this,e,Nu,Ou,He,{name:1,value:0})}}function xu(i){let e,t,r,n,s,o={personaSide:`${i[4]}Front`};t=new sr({props:o}),i[10](t),t.$on("ready",i[8]);let c={personaSide:`${i[4]}Back`};return n=new sr({props:c}),i[11](n),n.$on("ready",i[8]),{c(){e=ee("div"),he(t.$$.fragment),r=be(),he(n.$$.fragment),this.h()},l(f){e=te(f,"DIV",{class:!0});var h=q(e);ge(t.$$.fragment,h),r=_e(h),ge(n.$$.fragment,h),h.forEach(C),this.h()},h(){E(e,"class","flex w-full h-full")},m(f,h){X(f,e,h),pe(t,e,null),N(e,r),pe(n,e,null),s=!0},p(f,h){const p={};h&16&&(p.personaSide=`${f[4]}Front`),t.$set(p);const w={};h&16&&(w.personaSide=`${f[4]}Back`),n.$set(w)},i(f){s||(R(t.$$.fragment,f),R(n.$$.fragment,f),s=!0)},o(f){z(t.$$.fragment,f),z(n.$$.fragment,f),s=!1},d(f){f&&C(e),i[10](null),de(t),i[11](null),de(n)}}}function Uu(i){let e,t;return e=new cr({props:{tabs:["Female","Male"],activeTab:i[4],caption:"Density Map",$$slots:{default:[xu]},$$scope:{ctx:i}}}),e.$on("tabClick",i[7]),{c(){he(e.$$.fragment)},l(r){ge(e.$$.fragment,r)},m(r,n){pe(e,r,n),t=!0},p(r,n){const s={};n&16&&(s.activeTab=r[4]),n&4194332&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){de(e,r)}}}function ju(i){let e,t,r,n,s,o,c,f,h,p;return r=new zu({props:{value:i[1],name:"Color"}}),r.$on("change",i[6]),o=new Wt({props:{name:"Participants count",label:Object.keys(i[0].participants).length.toString()}}),h=new Wt({props:{name:`${i[4]} participants count`,label:i[5].toString()}}),{c(){e=ee("ul"),t=ee("li"),he(r.$$.fragment),n=be(),s=ee("li"),he(o.$$.fragment),c=be(),f=ee("li"),he(h.$$.fragment),this.h()},l(w){e=te(w,"UL",{class:!0});var k=q(e);t=te(k,"LI",{});var T=q(t);ge(r.$$.fragment,T),T.forEach(C),n=_e(k),s=te(k,"LI",{});var J=q(s);ge(o.$$.fragment,J),J.forEach(C),c=_e(k),f=te(k,"LI",{});var I=q(f);ge(h.$$.fragment,I),I.forEach(C),k.forEach(C),this.h()},h(){E(e,"class","p-2")},m(w,k){X(w,e,k),N(e,t),pe(r,t,null),N(e,n),N(e,s),pe(o,s,null),N(e,c),N(e,f),pe(h,f,null),p=!0},p(w,k){const T={};k&2&&(T.value=w[1]),r.$set(T);const J={};k&1&&(J.label=Object.keys(w[0].participants).length.toString()),o.$set(J);const I={};k&16&&(I.name=`${w[4]} participants count`),k&32&&(I.label=w[5].toString()),h.$set(I)},i(w){p||(R(r.$$.fragment,w),R(o.$$.fragment,w),R(h.$$.fragment,w),p=!0)},o(w){z(r.$$.fragment,w),z(o.$$.fragment,w),z(h.$$.fragment,w),p=!1},d(w){w&&C(e),de(r),de(o),de(h)}}}function Gu(i){let e,t;return e=new cr({props:{tabs:["Details"],highlightTab:!1,$$slots:{default:[ju]},$$scope:{ctx:i}}}),{c(){he(e.$$.fragment)},l(r){ge(e.$$.fragment,r)},m(r,n){pe(e,r,n),t=!0},p(r,n){const s={};n&4194355&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){de(e,r)}}}function as(i){let e,t;return e=new cn({props:{$$slots:{settings:[Gu],panels:[Uu]},$$scope:{ctx:i}}}),{c(){he(e.$$.fragment)},l(r){ge(e.$$.fragment,r)},m(r,n){pe(e,r,n),t=!0},p(r,n){const s={};n&4194367&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){de(e,r)}}}function qu(i){let e=i[4],t,r,n=as(i);return{c(){n.c(),t=Ke()},l(s){n.l(s),t=Ke()},m(s,o){n.m(s,o),X(s,t,o),r=!0},p(s,[o]){o&16&&He(e,e=s[4])?(it(),z(n,1,1,je),ot(),n=as(s),n.c(),R(n,1),n.m(t.parentNode,t)):n.p(s,o)},i(s){r||(R(n),r=!0)},o(s){z(n),r=!1},d(s){s&&C(t),n.d(s)}}}function Wu(i,e,t){let r,{survey:n}=e,s,o,c="Female",f="#0000ff",h,p,w=0,k=0;const T=new Worker(new URL(""+new URL("../workers/binning.worker-0c4c5efe.js",import.meta.url).href,self.location),{type:"module"});function J(){return[{name:`DensityMap-${c}Front.png`,dataUrl:s.getImage()},{name:`DensityMap-${c}Back.png`,dataUrl:o.getImage()}]}function I(v){const M=[];for(const B of Object.values(n.participants)){const j=B.drawing[v];j&&M.push(j)}x(v,"Grouping drawings"),v.includes("Female"),t(5,w=M.length),w>0?(x(v,"Waiting"),T.postMessage({command:"getBins",params:{drawings:M,side:v.includes("Front")?"Front":"Back"}})):(k--,S(v))}function ne(v,M){let B,j;const re=r.domain([0,w]);x(v,"Drawing density map"),v==="Front"?(B=s.getCanvas(),j=s.getScaleFactor(),s.clear()):(B=o.getCanvas(),j=o.getScaleFactor(),o.clear());const oe=B.getContext("2d");if(oe==null)throw"Could not get context to draw density map.";for(let Re of M)oe.fillStyle=re(Re.length).hex(),oe.fillRect(Re.x*j,Re.y*j,j,j);S(v)}function le({detail:v}){t(1,f=v),ne("Front",h),ne("Back",p)}function ie({detail:v}){if(k>0){alert("Please wait until computations have completed.");return}t(4,c=v)}function O(v){const{personaSide:M}=v.detail;x(M,"Starting density computation"),k++,I(M)}function P(){T.onmessage=v=>{if(v.data.event==="bins"){const{side:M,bins:B}=v.data.params;M==="Front"?h=B:p=B,k--,ne(M,B)}else if(v.data.event==="progress"){const{side:M,msg:B}=v.data.params;x(M,B)}}}function x(v,M){v.includes("Front")?s.setMessage(M):o.setMessage(M)}function S(v){v.includes("Front")?s.clearMessage():o.clearMessage()}Sr(()=>{P()});function W(v){lt[v?"unshift":"push"](()=>{s=v,t(2,s)})}function m(v){lt[v?"unshift":"push"](()=>{o=v,t(3,o)})}return i.$$set=v=>{"survey"in v&&t(0,n=v.survey)},i.$$.update=()=>{i.$$.dirty&2&&(r=ar.scale([ar(f).alpha(0),ar(f)]))},[n,f,s,o,c,w,le,ie,O,J,W,m]}class Hu extends rt{constructor(e){super(),nt(this,e,Wu,qu,He,{survey:0,getImages:9})}get survey(){return this.$$.ctx[0]}set survey(e){this.$$set({survey:e}),gs()}get getImages(){return this.$$.ctx[9]}}function Vu(i){let e,t,r,n,s,o={personaSide:`${i[3]}Front`};t=new sr({props:o}),i[8](t),t.$on("ready",i[6]);let c={personaSide:`${i[3]}Back`};return n=new sr({props:c}),i[9](n),n.$on("ready",i[6]),{c(){e=ee("div"),he(t.$$.fragment),r=be(),he(n.$$.fragment),this.h()},l(f){e=te(f,"DIV",{class:!0});var h=q(e);ge(t.$$.fragment,h),r=_e(h),ge(n.$$.fragment,h),h.forEach(C),this.h()},h(){E(e,"class","flex w-full h-full")},m(f,h){X(f,e,h),pe(t,e,null),N(e,r),pe(n,e,null),s=!0},p(f,h){const p={};h&8&&(p.personaSide=`${f[3]}Front`),t.$set(p);const w={};h&8&&(w.personaSide=`${f[3]}Back`),n.$set(w)},i(f){s||(R(t.$$.fragment,f),R(n.$$.fragment,f),s=!0)},o(f){z(t.$$.fragment,f),z(n.$$.fragment,f),s=!1},d(f){f&&C(e),i[8](null),de(t),i[9](null),de(n)}}}function Yu(i){let e,t;return e=new cr({props:{tabs:["Female","Male"],activeTab:i[3],caption:"Valence Map",$$slots:{default:[Vu]},$$scope:{ctx:i}}}),e.$on("tabClick",i[5]),{c(){he(e.$$.fragment)},l(r){ge(e.$$.fragment,r)},m(r,n){pe(e,r,n),t=!0},p(r,n){const s={};n&8&&(s.activeTab=r[3]),n&524302&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){de(e,r)}}}function Qu(i){let e,t,r,n,s,o,c;return r=new Wt({props:{name:"Participants count",label:Object.keys(i[0].participants).length.toString()}}),o=new Wt({props:{name:`${i[3]} participants count`,label:i[4].toString()}}),{c(){e=ee("ul"),t=ee("li"),he(r.$$.fragment),n=be(),s=ee("li"),he(o.$$.fragment),this.h()},l(f){e=te(f,"UL",{class:!0});var h=q(e);t=te(h,"LI",{});var p=q(t);ge(r.$$.fragment,p),p.forEach(C),n=_e(h),s=te(h,"LI",{});var w=q(s);ge(o.$$.fragment,w),w.forEach(C),h.forEach(C),this.h()},h(){E(e,"class","p-2")},m(f,h){X(f,e,h),N(e,t),pe(r,t,null),N(e,n),N(e,s),pe(o,s,null),c=!0},p(f,h){const p={};h&1&&(p.label=Object.keys(f[0].participants).length.toString()),r.$set(p);const w={};h&8&&(w.name=`${f[3]} participants count`),h&16&&(w.label=f[4].toString()),o.$set(w)},i(f){c||(R(r.$$.fragment,f),R(o.$$.fragment,f),c=!0)},o(f){z(r.$$.fragment,f),z(o.$$.fragment,f),c=!1},d(f){f&&C(e),de(r),de(o)}}}function Xu(i){let e,t;return e=new cr({props:{tabs:["Details"],highlightTab:!1,$$slots:{default:[Qu]},$$scope:{ctx:i}}}),{c(){he(e.$$.fragment)},l(r){ge(e.$$.fragment,r)},m(r,n){pe(e,r,n),t=!0},p(r,n){const s={};n&524313&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){de(e,r)}}}function ss(i){let e,t;return e=new cn({props:{$$slots:{settings:[Xu],panels:[Yu]},$$scope:{ctx:i}}}),{c(){he(e.$$.fragment)},l(r){ge(e.$$.fragment,r)},m(r,n){pe(e,r,n),t=!0},p(r,n){const s={};n&524319&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){de(e,r)}}}function Ju(i){let e=i[3],t,r,n=ss(i);return{c(){n.c(),t=Ke()},l(s){n.l(s),t=Ke()},m(s,o){n.m(s,o),X(s,t,o),r=!0},p(s,[o]){o&8&&He(e,e=s[3])?(it(),z(n,1,1,je),ot(),n=ss(s),n.c(),R(n,1),n.m(t.parentNode,t)):n.p(s,o)},i(s){r||(R(n),r=!0)},o(s){z(n),r=!1},d(s){s&&C(t),n.d(s)}}}let Zu=1,Ku=1;function ec(i,e,t){let{survey:r}=e,n,s,o="Female",c=0,f=0;const h=new Worker(new URL(""+new URL("../workers/binning.worker-0c4c5efe.js",import.meta.url).href,self.location),{type:"module"});function p(){return[{name:`ValenceMap-${o}Front.png`,dataUrl:n.getImage()},{name:`ValenceMap-${o}Back.png`,dataUrl:s.getImage()}]}function w(P){const x=[];for(const S of Object.values(r.participants)){const W=S.drawing[P];W&&x.push(W)}t(4,c=x.length),c>0?(ne(P,"Waiting"),h.postMessage({command:"getBins",params:{drawings:x,side:P.includes("Front")?"Front":"Back"}})):(f--,P.includes("Front")?n.clearMessage():s.clearMessage())}function k(P,x){const W=ar.scale(["red","green"]).domain([1,11]);let m,v;ne(P,"Drawing valence map"),P==="Front"?(m=n.getCanvas(),v=n.getScaleFactor()):(m=s.getCanvas(),v=s.getScaleFactor());const M=m.getContext("2d");if(M==null)throw"Could not get context to draw density map.";for(let B of x){const j=B.map(we=>we.valence),re=B.map(we=>we.intensity),oe=j.reduce((we,U)=>we+U,0)/B.length,Re=re.reduce((we,U)=>we+U,0)/B.length,De=W(oe),ae=ar.scale(["white",De]).domain([1,11])(Re),Y=ar.scale([ae.alpha(0),ae]).domain([0,c])(B.length);M.fillStyle=Y.hex(),M.fillRect(B.x*v,B.y*v,Zu,Ku)}le(P)}function T({detail:P}){if(f>0){alert("Please wait until computations have completed.");return}t(3,o=P)}function J(P){const{personaSide:x,width:S,height:W}=P.detail;ne(x,"Starting valence map computation"),f++,w(x)}function I(){h.onmessage=P=>{if(P.data.event==="bins"){const{side:x,bins:S}=P.data.params;x==="Front"?n.clearMessage():s.clearMessage(),f--,k(x,S)}else if(P.data.event==="progress"){const{side:x,msg:S}=P.data.params;ne(x,S)}}}function ne(P,x){P.includes("Front")?n.setMessage(x):s.setMessage(x)}function le(P){P.includes("Front")?n.clearMessage():s.clearMessage()}Sr(()=>{I()});function ie(P){lt[P?"unshift":"push"](()=>{n=P,t(1,n)})}function O(P){lt[P?"unshift":"push"](()=>{s=P,t(2,s)})}return i.$$set=P=>{"survey"in P&&t(0,r=P.survey)},[r,n,s,o,c,T,J,p,ie,O]}class tc extends rt{constructor(e){super(),nt(this,e,ec,Ju,He,{survey:0,getImages:7})}get getImages(){return this.$$.ctx[7]}}function rc(i){let e,t,r,n,s;return{c(){e=ee("div"),t=ee("button"),r=xe("Load Survey Data"),this.h()},l(o){e=te(o,"DIV",{class:!0});var c=q(e);t=te(c,"BUTTON",{class:!0});var f=q(t);r=Ue(f,"Load Survey Data"),f.forEach(C),c.forEach(C),this.h()},h(){E(t,"class","py-1 px-2 bg-neutral-600 hover:bg-neutral-700 border border-neutral-900 shadow text-neutral-100 text-xs"),E(e,"class","flex items-center justify-center w-full h-full bg-neutral-800")},m(o,c){X(o,e,c),N(e,t),N(t,r),n||(s=$t(t,"click",i[0]),n=!0)},p:je,i:je,o:je,d(o){o&&C(e),n=!1,s()}}}function nc(i){function e(t){Ar.call(this,i,t)}return[e]}class ac extends rt{constructor(e){super(),nt(this,e,nc,rc,He,{})}}function ls(i){let e,t,r={title:"Project",$$slots:{default:[uc]},$$scope:{ctx:i}};return e=new ks({props:r}),i[16](e),{c(){he(e.$$.fragment)},l(n){ge(e.$$.fragment,n)},m(n,s){pe(e,n,s),t=!0},p(n,s){const o={};s[0]&68|s[1]&128&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){i[16](null),de(e,n)}}}function sc(i){let e;return{c(){e=xe("Load Survey Data")},l(t){e=Ue(t,"Load Survey Data")},m(t,r){X(t,e,r)},d(t){t&&C(e)}}}function is(i){let e,t,r,n,s,o,c;e=new xt({props:{$$slots:{default:[lc]},$$scope:{ctx:i}}}),e.$on("click",i[13]);let f=i[6]===Xe.LookingGlass&&os(i);return n=new au({}),o=new xt({props:{$$slots:{default:[fc]},$$scope:{ctx:i}}}),o.$on("click",i[10]),{c(){he(e.$$.fragment),t=be(),f&&f.c(),r=be(),he(n.$$.fragment),s=be(),he(o.$$.fragment)},l(h){ge(e.$$.fragment,h),t=_e(h),f&&f.l(h),r=_e(h),ge(n.$$.fragment,h),s=_e(h),ge(o.$$.fragment,h)},m(h,p){pe(e,h,p),X(h,t,p),f&&f.m(h,p),X(h,r,p),pe(n,h,p),X(h,s,p),pe(o,h,p),c=!0},p(h,p){const w={};p[1]&128&&(w.$$scope={dirty:p,ctx:h}),e.$set(w),h[6]===Xe.LookingGlass?f?(f.p(h,p),p[0]&64&&R(f,1)):(f=os(h),f.c(),R(f,1),f.m(r.parentNode,r)):f&&(it(),z(f,1,1,()=>{f=null}),ot());const k={};p[1]&128&&(k.$$scope={dirty:p,ctx:h}),o.$set(k)},i(h){c||(R(e.$$.fragment,h),R(f),R(n.$$.fragment,h),R(o.$$.fragment,h),c=!0)},o(h){z(e.$$.fragment,h),z(f),z(n.$$.fragment,h),z(o.$$.fragment,h),c=!1},d(h){de(e,h),h&&C(t),f&&f.d(h),h&&C(r),de(n,h),h&&C(s),de(o,h)}}}function lc(i){let e;return{c(){e=xe("Export images")},l(t){e=Ue(t,"Export images")},m(t,r){X(t,e,r)},d(t){t&&C(e)}}}function os(i){let e,t,r,n;return e=new xt({props:{$$slots:{default:[ic]},$$scope:{ctx:i}}}),e.$on("click",i[14]),r=new xt({props:{$$slots:{default:[oc]},$$scope:{ctx:i}}}),r.$on("click",i[15]),{c(){he(e.$$.fragment),t=be(),he(r.$$.fragment)},l(s){ge(e.$$.fragment,s),t=_e(s),ge(r.$$.fragment,s)},m(s,o){pe(e,s,o),X(s,t,o),pe(r,s,o),n=!0},p(s,o){const c={};o[1]&128&&(c.$$scope={dirty:o,ctx:s}),e.$set(c);const f={};o[1]&128&&(f.$$scope={dirty:o,ctx:s}),r.$set(f)},i(s){n||(R(e.$$.fragment,s),R(r.$$.fragment,s),n=!0)},o(s){z(e.$$.fragment,s),z(r.$$.fragment,s),n=!1},d(s){de(e,s),s&&C(t),de(r,s)}}}function ic(i){let e;return{c(){e=xe("Export strokes")},l(t){e=Ue(t,"Export strokes")},m(t,r){X(t,e,r)},d(t){t&&C(e)}}}function oc(i){let e;return{c(){e=xe("Export pixel maps")},l(t){e=Ue(t,"Export pixel maps")},m(t,r){X(t,e,r)},d(t){t&&C(e)}}}function fc(i){let e;return{c(){e=xe("Close project")},l(t){e=Ue(t,"Close project")},m(t,r){X(t,e,r)},d(t){t&&C(e)}}}function uc(i){let e,t,r,n;e=new xt({props:{$$slots:{default:[sc]},$$scope:{ctx:i}}}),e.$on("click",i[9]);let s=i[2]&&is(i);return{c(){he(e.$$.fragment),t=be(),s&&s.c(),r=Ke()},l(o){ge(e.$$.fragment,o),t=_e(o),s&&s.l(o),r=Ke()},m(o,c){pe(e,o,c),X(o,t,c),s&&s.m(o,c),X(o,r,c),n=!0},p(o,c){const f={};c[1]&128&&(f.$$scope={dirty:c,ctx:o}),e.$set(f),o[2]?s?(s.p(o,c),c[0]&4&&R(s,1)):(s=is(o),s.c(),R(s,1),s.m(r.parentNode,r)):s&&(it(),z(s,1,1,()=>{s=null}),ot())},i(o){n||(R(e.$$.fragment,o),R(s),n=!0)},o(o){z(e.$$.fragment,o),z(s),n=!1},d(o){de(e,o),o&&C(t),s&&s.d(o),o&&C(r)}}}function fs(i){let e,t,r={title:"Tools",enableIcon:!0,$$slots:{default:[mc]},$$scope:{ctx:i}};return e=new ks({props:r}),i[20](e),{c(){he(e.$$.fragment)},l(n){ge(e.$$.fragment,n)},m(n,s){pe(e,n,s),t=!0},p(n,s){const o={};s[0]&64|s[1]&128&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){i[20](null),de(e,n)}}}function cc(i){let e=Xe.LookingGlass+"",t;return{c(){t=xe(e)},l(r){t=Ue(r,e)},m(r,n){X(r,t,n)},p:je,d(r){r&&C(t)}}}function hc(i){let e,t,r;return{c(){e=ct("svg"),t=ct("path"),r=ct("path"),this.h()},l(n){e=ht(n,"svg",{slot:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0});var s=q(e);t=ht(s,"path",{stroke:!0,d:!0,fill:!0}),q(t).forEach(C),r=ht(s,"path",{d:!0}),q(r).forEach(C),s.forEach(C),this.h()},h(){E(t,"stroke","none"),E(t,"d","M0 0h24v24H0z"),E(t,"fill","none"),E(r,"d","M5 12l5 5l10 -10"),E(e,"slot","icon"),E(e,"xmlns","http://www.w3.org/2000/svg"),E(e,"width","14"),E(e,"height","14"),E(e,"viewBox","0 0 24 24"),E(e,"stroke-width","2"),E(e,"stroke","currentColor"),E(e,"fill","none"),E(e,"stroke-linecap","round"),E(e,"stroke-linejoin","round"),dt(e,"hidden",!i[37])},m(n,s){X(n,e,s),N(e,t),N(e,r)},p(n,s){s[1]&64&&dt(e,"hidden",!n[37])},d(n){n&&C(e)}}}function gc(i){let e=Xe.DensityMap+"",t;return{c(){t=xe(e)},l(r){t=Ue(r,e)},m(r,n){X(r,t,n)},p:je,d(r){r&&C(t)}}}function pc(i){let e,t,r;return{c(){e=ct("svg"),t=ct("path"),r=ct("path"),this.h()},l(n){e=ht(n,"svg",{slot:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0});var s=q(e);t=ht(s,"path",{stroke:!0,d:!0,fill:!0}),q(t).forEach(C),r=ht(s,"path",{d:!0}),q(r).forEach(C),s.forEach(C),this.h()},h(){E(t,"stroke","none"),E(t,"d","M0 0h24v24H0z"),E(t,"fill","none"),E(r,"d","M5 12l5 5l10 -10"),E(e,"slot","icon"),E(e,"xmlns","http://www.w3.org/2000/svg"),E(e,"width","16"),E(e,"height","16"),E(e,"viewBox","0 0 24 24"),E(e,"stroke-width","2"),E(e,"stroke","currentColor"),E(e,"fill","none"),E(e,"stroke-linecap","round"),E(e,"stroke-linejoin","round"),dt(e,"hidden",!i[37])},m(n,s){X(n,e,s),N(e,t),N(e,r)},p(n,s){s[1]&64&&dt(e,"hidden",!n[37])},d(n){n&&C(e)}}}function dc(i){let e=Xe.ValenceMap+"",t;return{c(){t=xe(e)},l(r){t=Ue(r,e)},m(r,n){X(r,t,n)},p:je,d(r){r&&C(t)}}}function vc(i){let e,t,r;return{c(){e=ct("svg"),t=ct("path"),r=ct("path"),this.h()},l(n){e=ht(n,"svg",{slot:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0});var s=q(e);t=ht(s,"path",{stroke:!0,d:!0,fill:!0}),q(t).forEach(C),r=ht(s,"path",{d:!0}),q(r).forEach(C),s.forEach(C),this.h()},h(){E(t,"stroke","none"),E(t,"d","M0 0h24v24H0z"),E(t,"fill","none"),E(r,"d","M5 12l5 5l10 -10"),E(e,"slot","icon"),E(e,"xmlns","http://www.w3.org/2000/svg"),E(e,"width","16"),E(e,"height","16"),E(e,"viewBox","0 0 24 24"),E(e,"stroke-width","2"),E(e,"stroke","currentColor"),E(e,"fill","none"),E(e,"stroke-linecap","round"),E(e,"stroke-linejoin","round"),dt(e,"hidden",!i[37])},m(n,s){X(n,e,s),N(e,t),N(e,r)},p(n,s){s[1]&64&&dt(e,"hidden",!n[37])},d(n){n&&C(e)}}}function mc(i){let e,t,r,n,s,o;return e=new xt({props:{isActive:i[6]===Xe.LookingGlass,$$slots:{icon:[hc,({isActive:c})=>({37:c}),({isActive:c})=>[0,c?64:0]],default:[cc]},$$scope:{ctx:i}}}),e.$on("click",i[17]),r=new xt({props:{isActive:i[6]===Xe.DensityMap,$$slots:{icon:[pc,({isActive:c})=>({37:c}),({isActive:c})=>[0,c?64:0]],default:[gc]},$$scope:{ctx:i}}}),r.$on("click",i[18]),s=new xt({props:{isActive:i[6]===Xe.ValenceMap,$$slots:{icon:[vc,({isActive:c})=>({37:c}),({isActive:c})=>[0,c?64:0]],default:[dc]},$$scope:{ctx:i}}}),s.$on("click",i[19]),{c(){he(e.$$.fragment),t=be(),he(r.$$.fragment),n=be(),he(s.$$.fragment)},l(c){ge(e.$$.fragment,c),t=_e(c),ge(r.$$.fragment,c),n=_e(c),ge(s.$$.fragment,c)},m(c,f){pe(e,c,f),X(c,t,f),pe(r,c,f),X(c,n,f),pe(s,c,f),o=!0},p(c,f){const h={};f[0]&64&&(h.isActive=c[6]===Xe.LookingGlass),f[1]&192&&(h.$$scope={dirty:f,ctx:c}),e.$set(h);const p={};f[0]&64&&(p.isActive=c[6]===Xe.DensityMap),f[1]&192&&(p.$$scope={dirty:f,ctx:c}),r.$set(p);const w={};f[0]&64&&(w.isActive=c[6]===Xe.ValenceMap),f[1]&192&&(w.$$scope={dirty:f,ctx:c}),s.$set(w)},i(c){o||(R(e.$$.fragment,c),R(r.$$.fragment,c),R(s.$$.fragment,c),o=!0)},o(c){z(e.$$.fragment,c),z(r.$$.fragment,c),z(s.$$.fragment,c),o=!1},d(c){de(e,c),c&&C(t),de(r,c),c&&C(n),de(s,c)}}}function us(i){let e,t,r,n,s,o;return{c(){e=ee("div"),t=ct("svg"),r=ct("circle"),n=ct("path"),s=be(),o=xe(i[8]),this.h()},l(c){e=te(c,"DIV",{class:!0});var f=q(e);t=ht(f,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var h=q(t);r=ht(h,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),q(r).forEach(C),n=ht(h,"path",{class:!0,fill:!0,d:!0}),q(n).forEach(C),h.forEach(C),s=_e(f),o=Ue(f,i[8]),f.forEach(C),this.h()},h(){E(r,"class","opacity-25"),E(r,"cx","12"),E(r,"cy","12"),E(r,"r","10"),E(r,"stroke","currentColor"),E(r,"stroke-width","4"),E(n,"class","opacity-75"),E(n,"fill","currentColor"),E(n,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),E(t,"class","animate-spin -ml-1 mr-3 h-5 w-5 text-white"),E(t,"xmlns","http://www.w3.org/2000/svg"),E(t,"fill","none"),E(t,"viewBox","0 0 24 24"),E(e,"class","z-20 absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 flex items-center justify-center py-2 px-4 bg-neutral-800 text-neutral-400")},m(c,f){X(c,e,f),N(e,t),N(t,r),N(t,n),N(e,s),N(e,o)},p(c,f){f[0]&256&&yt(o,c[8])},d(c){c&&C(e)}}}function cs(i){let e,t;return e=new ac({}),e.$on("click",i[9]),{c(){he(e.$$.fragment)},l(r){ge(e.$$.fragment,r)},m(r,n){pe(e,r,n),t=!0},p:je,i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){de(e,r)}}}function bc(i){let e,t,r,n,s,o,c,f,h,p,w,k,T,J,I,ne,le=i[3]===!1&&ls(i),ie=i[2]&&fs(i),O=i[3]&&us(i),P=i[7]===void 0&&cs(i);return{c(){e=ee("section"),t=ee("header"),le&&le.c(),r=be(),ie&&ie.c(),n=be(),s=ee("span"),o=be(),c=ee("h1"),f=xe("InteroMap"),h=be(),p=ee("main"),O&&O.c(),w=be(),P&&P.c(),k=be(),T=ee("input"),this.h()},l(x){e=te(x,"SECTION",{class:!0});var S=q(e);t=te(S,"HEADER",{class:!0});var W=q(t);le&&le.l(W),r=_e(W),ie&&ie.l(W),n=_e(W),s=te(W,"SPAN",{class:!0}),q(s).forEach(C),o=_e(W),c=te(W,"H1",{class:!0,style:!0});var m=q(c);f=Ue(m,"InteroMap"),m.forEach(C),W.forEach(C),h=_e(S),p=te(S,"MAIN",{class:!0});var v=q(p);O&&O.l(v),w=_e(v),P&&P.l(v),v.forEach(C),S.forEach(C),k=_e(x),T=te(x,"INPUT",{type:!0,class:!0,accept:!0}),this.h()},h(){E(s,"class","flex-grow"),E(c,"class","flex items-center h-full px-2 bg-gradient-to-t from-orange-600 to-orange-500 text-neutral-100 font-bold text-xs lowercase tracking-wider"),ln(c,"font-variant","small-caps"),E(t,"class","emboss z-20 flex items-center bg-neutral-600 border-b border-neutral-800"),E(p,"class","relative row-start-2 row-end-4"),E(e,"class","app-layout w-screen h-screen svelte-14urve1"),E(T,"type","file"),E(T,"class","hidden"),E(T,"accept",".csv")},m(x,S){X(x,e,S),N(e,t),le&&le.m(t,null),N(t,r),ie&&ie.m(t,null),N(t,n),N(t,s),N(t,o),N(t,c),N(c,f),N(e,h),N(e,p),O&&O.m(p,null),N(p,w),P&&P.m(p,null),i[21](p),X(x,k,S),X(x,T,S),i[22](T),J=!0,I||(ne=$t(T,"change",i[11]),I=!0)},p(x,S){x[3]===!1?le?(le.p(x,S),S[0]&8&&R(le,1)):(le=ls(x),le.c(),R(le,1),le.m(t,r)):le&&(it(),z(le,1,1,()=>{le=null}),ot()),x[2]?ie?(ie.p(x,S),S[0]&4&&R(ie,1)):(ie=fs(x),ie.c(),R(ie,1),ie.m(t,n)):ie&&(it(),z(ie,1,1,()=>{ie=null}),ot()),x[3]?O?O.p(x,S):(O=us(x),O.c(),O.m(p,w)):O&&(O.d(1),O=null),x[7]===void 0?P?(P.p(x,S),S[0]&128&&R(P,1)):(P=cs(x),P.c(),R(P,1),P.m(p,null)):P&&(it(),z(P,1,1,()=>{P=null}),ot())},i(x){J||(R(le),R(ie),R(P),J=!0)},o(x){z(le),z(ie),z(P),J=!1},d(x){x&&C(e),le&&le.d(),ie&&ie.d(),O&&O.d(),P&&P.d(),i[21](null),x&&C(k),x&&C(T),i[22](null),I=!1,ne()}}}function _c(i){return JSON.parse(i)}function sn(i,e){const t=document.createElement("a");t.href=e,t.target="_blank",t.download=i,t.click()}function wc(i,e,t){let r,n,s=!1,o=!1,c,f,h=Xe.LookingGlass,p=new Qf,w,k="Loading",T,J;function I(){n.click()}function ne(){w&&(w.$destroy(),t(7,w=void 0)),t(2,s=!1),t(3,o=!1),J=null}function le(){if(n.files&&n.files.length>0){if(ne(),J=prompt("Specify the Qualtrics variable you wish to load:"),J==null||J==="")throw alert("Error: You did not specify the Qualtrics variable."),ne(),"No Qualtrics variable specified. Aborting.";t(3,o=!0),ie(n.files[0])}}function ie(U){t(8,k="Reading file..."),Fa.parse(U,{worker:!0,header:!0,step:O,complete:P})}function O(U){const H=U.data;if(J&&J in H&&"ResponseId"in H)try{const fe=_c(H[J]);if(Object.keys(fe).every(ke=>["FemaleFront","FemaleBack","MaleFront","MaleBack"].includes(ke))){const ke=H.ResponseId,K=new vr({id:ke,drawing:fe});p.addParticipant(K)}}catch{return}}function P(){if(Object.keys(p.participants).length===0){const U=`Sorry, we could not parse any InteroMap data from your file.
      Maybe the Qualtrics variable is incorrect?`;throw alert(U),ne(),U}t(7,w=v(Xe.LookingGlass))}function x(U){U!==h&&t(7,w=v(U)),c.close()}function S(U){return new Ru({target:r,props:{survey:U}})}function W(U){return new Hu({target:r,props:{survey:U}})}function m(U){return new tc({target:r,props:{survey:U}})}function v(U){let H;switch(w&&w.$destroy(),U){case Xe.LookingGlass:H=S(p);break;case Xe.DensityMap:H=W(p);break;case Xe.ValenceMap:H=m(p);break;default:throw`Unknown tool: ${U}.`}return t(6,h=U),t(3,o=!1),t(2,s=!0),H}function M(){const U=w==null?void 0:w.getImages();U==null||U.forEach(H=>{sn(H.name,H.dataUrl)}),f.close()}function B(U){const fe=[["Participant ID","Stroke Valence","Stroke Intensity","Area (pixels)"]];for(const ke of U)for(const K in ke.areas){const[$e,Me]=K.split(":");fe.push([ke.id,$e,Me,ke.areas[K].toString()])}const Se=Fa.unparse(fe);return"data:text/csv;base64,"+btoa(Se)}function j(){const U=Object.values(p.participants).filter(H=>!H.computed);U.length>0?re(U):oe(),f.close()}async function re(U){t(3,o=!0),t(8,k="Loading persona bitmaps...");try{const[H,fe]=await Promise.all([zt.getPersonaBitmaps("Female"),zt.getPersonaBitmaps("Male")]);t(8,k="Computing stroke areas...");const Se=U.map(ke=>({id:ke.id,drawing:ke.drawing}));T==null||T.postMessage({command:"get-areas",params:{data:Se,femaleFrontBitmap:H.frontBitmap,femaleBackBitmap:H.backBitmap,maleFrontBitmap:fe.frontBitmap,maleBackBitmap:fe.backBitmap}},[H.frontBitmap,H.backBitmap,fe.frontBitmap,fe.backBitmap])}catch(H){console.error("Failed to load persona bitmaps:",H),alert("Failed to load persona images. Please try again."),t(3,o=!1)}}function oe(){const U=Object.values(p.participants).map(fe=>({id:fe.id,areas:fe.areas})),H=B(U);sn("InteroMap-Strokes.csv",H)}async function Re(){const U=await window.showSaveFilePicker({suggestedName:`pixel-maps-${J}.zip`});t(3,o=!0),t(8,k="Loading persona bitmaps...");try{const[H,fe]=await Promise.all([zt.getPersonaBitmaps("Female"),zt.getPersonaBitmaps("Male")]);t(8,k="Exporting pixel maps..."),T==null||T.postMessage({command:"get-pixelmaps-zip",params:{survey:p,fileHandle:U,femaleFrontBitmap:H.frontBitmap,femaleBackBitmap:H.backBitmap,maleFrontBitmap:fe.frontBitmap,maleBackBitmap:fe.backBitmap}},[H.frontBitmap,H.backBitmap,fe.frontBitmap,fe.backBitmap])}catch(H){console.error("Failed to load persona bitmaps:",H),alert("Failed to load persona images. Please try again."),t(3,o=!1)}f.close()}async function De(){const U=await hs(()=>import("../chunks/export.worker.28bba91a.js"),[],import.meta.url);T=new U.default,T.onmessage=H=>{if(H.data.event==="pixelmaps-zip-progress"||H.data.event==="areas-progress"){const{current:fe,total:Se,msg:ke}=H.data.params;t(8,k=`(${Math.round(100*fe/Se)}%) ${ke}`)}else if(H.data.event==="pixelmaps-done")t(3,o=!1);else if(H.data.event==="areas-done"){const fe=H.data.params;fe.forEach(({id:ke,areas:K,totalDrawingArea:$e})=>{const Me=p.getParticipant(ke);if(Me){const Ge=new vr({id:Me.id,drawing:Me.drawing,areas:K,totalDrawingArea:$e,computed:!0});p.updateParticipant(Ge)}});const Se=B(fe);sn("InteroMap-Strokes.csv",Se),t(3,o=!1)}}}Sr(async()=>{De();try{await zt.preloadAllCanvases()}catch(U){console.warn("Failed to preload some persona bitmaps:",U)}});function Z(U){lt[U?"unshift":"push"](()=>{f=U,t(5,f)})}const Te=()=>x(Xe.LookingGlass),ae=()=>x(Xe.DensityMap),at=()=>x(Xe.ValenceMap);function Ve(U){lt[U?"unshift":"push"](()=>{c=U,t(4,c)})}function Y(U){lt[U?"unshift":"push"](()=>{r=U,t(0,r)})}function we(U){lt[U?"unshift":"push"](()=>{n=U,t(1,n)})}return[r,n,s,o,c,f,h,w,k,I,ne,le,x,M,j,Re,Z,Te,ae,at,Ve,Y,we]}class Cc extends rt{constructor(e){super(),nt(this,e,wc,bc,He,{},null,[-1,-1])}}export{Cc as default};
