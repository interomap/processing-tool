var kf=Object.defineProperty;var $f=(i,e,t)=>e in i?kf(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var bt=(i,e,t)=>($f(i,typeof e!="symbol"?e+"":e,t),t);import{_ as hs}from"../chunks/preload-helper.41c905a7.js";import{J as yf,S as rt,i as nt,s as He,k as ee,q as xe,a as _e,l as te,m as G,r as Ue,h as C,c as we,n as E,K as dt,b as J,G as N,L as $t,u as yt,g as B,v as it,d as z,f as ot,M as on,N as Cf,C as lr,D as ir,E as or,F as fr,O as Ef,w as lt,P as Mf,Q as Ar,H as je,R as Ff,p as ln,T as mr,e as Ke,U as ur,V as Ht,y as ge,z as pe,A as de,W as fn,X as un,B as ve,Y as Sr,Z as If,_ as ct,$ as ht,a0 as gs,o as Lr,a1 as Ma}from"../chunks/index.61358ee6.js";var ps=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ds(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var vs={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(i,e){(function(t,n){i.exports=n()})(ps,function t(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},r=!n.document&&!!n.postMessage,s=n.IS_PAPA_WORKER||!1,o={},c=0,f={parse:function(m,v){var M=(v=v||{}).dynamicTyping||!1;if(H(M)&&(v.dynamicTypingFunction=M,M={}),v.dynamicTyping=M,v.transform=!!H(v.transform)&&v.transform,v.worker&&f.WORKERS_SUPPORTED){var R=function(){if(!f.WORKERS_SUPPORTED)return!1;var re=(Be=n.URL||n.webkitURL||null,De=t.toString(),f.BLOB_URL||(f.BLOB_URL=Be.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",De,")();"],{type:"text/javascript"})))),fe=new n.Worker(re),Be,De;return fe.onmessage=oe,fe.id=c++,o[fe.id]=fe}();return R.userStep=v.step,R.userChunk=v.chunk,R.userComplete=v.complete,R.userError=v.error,v.step=H(v.step),v.chunk=H(v.chunk),v.complete=H(v.complete),v.error=H(v.error),delete v.worker,void R.postMessage({input:m,config:v,workerId:R.id})}var j=null;return f.NODE_STREAM_INPUT,typeof m=="string"?(m=function(re){return re.charCodeAt(0)===65279?re.slice(1):re}(m),j=v.download?new w(v):new O(v)):m.readable===!0&&H(m.read)&&H(m.on)?j=new W(v):(n.File&&m instanceof File||m instanceof Object)&&(j=new k(v)),j.stream(m)},unparse:function(m,v){var M=!1,R=!0,j=",",re=`\r
`,fe='"',Be=fe+fe,De=!1,Z=null,Oe=!1;(function(){if(typeof v=="object"){if(typeof v.delimiter!="string"||f.BAD_DELIMITERS.filter(function(Q){return v.delimiter.indexOf(Q)!==-1}).length||(j=v.delimiter),(typeof v.quotes=="boolean"||typeof v.quotes=="function"||Array.isArray(v.quotes))&&(M=v.quotes),typeof v.skipEmptyLines!="boolean"&&typeof v.skipEmptyLines!="string"||(De=v.skipEmptyLines),typeof v.newline=="string"&&(re=v.newline),typeof v.quoteChar=="string"&&(fe=v.quoteChar),typeof v.header=="boolean"&&(R=v.header),Array.isArray(v.columns)){if(v.columns.length===0)throw new Error("Option columns is empty");Z=v.columns}v.escapeChar!==void 0&&(Be=v.escapeChar+fe),(typeof v.escapeFormulae=="boolean"||v.escapeFormulae instanceof RegExp)&&(Oe=v.escapeFormulae instanceof RegExp?v.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var ae=new RegExp(ne(fe),"g");if(typeof m=="string"&&(m=JSON.parse(m)),Array.isArray(m)){if(!m.length||Array.isArray(m[0]))return at(null,m,De);if(typeof m[0]=="object")return at(Z||Object.keys(m[0]),m,De)}else if(typeof m=="object")return typeof m.data=="string"&&(m.data=JSON.parse(m.data)),Array.isArray(m.data)&&(m.fields||(m.fields=m.meta&&m.meta.fields||Z),m.fields||(m.fields=Array.isArray(m.data[0])?m.fields:typeof m.data[0]=="object"?Object.keys(m.data[0]):[]),Array.isArray(m.data[0])||typeof m.data[0]=="object"||(m.data=[m.data])),at(m.fields||[],m.data||[],De);throw new Error("Unable to serialize unrecognized input");function at(Q,ke,U){var V="";typeof Q=="string"&&(Q=JSON.parse(Q)),typeof ke=="string"&&(ke=JSON.parse(ke));var ie=Array.isArray(Q)&&0<Q.length,Le=!Array.isArray(ke[0]);if(ie&&R){for(var ue=0;ue<Q.length;ue++)0<ue&&(V+=j),V+=Ve(Q[ue],ue);0<ke.length&&(V+=re)}for(var K=0;K<ke.length;K++){var $e=ie?Q.length:ke[K].length,Me=!1,qe=ie?Object.keys(ke[K]).length===0:ke[K].length===0;if(U&&!ie&&(Me=U==="greedy"?ke[K].join("").trim()==="":ke[K].length===1&&ke[K][0].length===0),U==="greedy"&&ie){for(var Re=[],Ye=0;Ye<$e;Ye++){var Ge=Le?Q[Ye]:Ye;Re.push(ke[K][Ge])}Me=Re.join("").trim()===""}if(!Me){for(var Te=0;Te<$e;Te++){0<Te&&!qe&&(V+=j);var vt=ie&&Le?Q[Te]:Te;V+=Ve(ke[K][vt],Te)}K<ke.length-1&&(!U||0<$e&&!qe)&&(V+=re)}}return V}function Ve(Q,ke){if(Q==null)return"";if(Q.constructor===Date)return JSON.stringify(Q).slice(1,25);var U=!1;Oe&&typeof Q=="string"&&Oe.test(Q)&&(Q="'"+Q,U=!0);var V=Q.toString().replace(ae,Be);return(U=U||M===!0||typeof M=="function"&&M(Q,ke)||Array.isArray(M)&&M[ke]||function(ie,Le){for(var ue=0;ue<Le.length;ue++)if(-1<ie.indexOf(Le[ue]))return!0;return!1}(V,f.BAD_DELIMITERS)||-1<V.indexOf(j)||V.charAt(0)===" "||V.charAt(V.length-1)===" ")?fe+V+fe:V}}};if(f.RECORD_SEP=String.fromCharCode(30),f.UNIT_SEP=String.fromCharCode(31),f.BYTE_ORDER_MARK="\uFEFF",f.BAD_DELIMITERS=["\r",`
`,'"',f.BYTE_ORDER_MARK],f.WORKERS_SUPPORTED=!r&&!!n.Worker,f.NODE_STREAM_INPUT=1,f.LocalChunkSize=10485760,f.RemoteChunkSize=5242880,f.DefaultDelimiter=",",f.Parser=le,f.ParserHandle=I,f.NetworkStreamer=w,f.FileStreamer=k,f.StringStreamer=O,f.ReadableStreamStreamer=W,n.jQuery){var h=n.jQuery;h.fn.parse=function(m){var v=m.config||{},M=[];return this.each(function(re){if(!(h(this).prop("tagName").toUpperCase()==="INPUT"&&h(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var fe=0;fe<this.files.length;fe++)M.push({file:this.files[fe],inputElem:this,instanceConfig:h.extend({},v)})}),R(),this;function R(){if(M.length!==0){var re,fe,Be,De,Z=M[0];if(H(m.before)){var Oe=m.before(Z.file,Z.inputElem);if(typeof Oe=="object"){if(Oe.action==="abort")return re="AbortError",fe=Z.file,Be=Z.inputElem,De=Oe.reason,void(H(m.error)&&m.error({name:re},fe,Be,De));if(Oe.action==="skip")return void j();typeof Oe.config=="object"&&(Z.instanceConfig=h.extend(Z.instanceConfig,Oe.config))}else if(Oe==="skip")return void j()}var ae=Z.instanceConfig.complete;Z.instanceConfig.complete=function(at){H(ae)&&ae(at,Z.file,Z.inputElem),j()},f.parse(Z.file,Z.instanceConfig)}else H(m.complete)&&m.complete()}function j(){M.splice(0,1),R()}}}function p(m){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(v){var M=x(v);M.chunkSize=parseInt(M.chunkSize),v.step||v.chunk||(M.chunkSize=null),this._handle=new I(M),(this._handle.streamer=this)._config=M}.call(this,m),this.parseChunk=function(v,M){if(this.isFirstChunk&&H(this._config.beforeFirstChunk)){var R=this._config.beforeFirstChunk(v);R!==void 0&&(v=R)}this.isFirstChunk=!1,this._halted=!1;var j=this._partialLine+v;this._partialLine="";var re=this._handle.parse(j,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var fe=re.meta.cursor;this._finished||(this._partialLine=j.substring(fe-this._baseIndex),this._baseIndex=fe),re&&re.data&&(this._rowCount+=re.data.length);var Be=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)n.postMessage({results:re,workerId:f.WORKER_ID,finished:Be});else if(H(this._config.chunk)&&!M){if(this._config.chunk(re,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);re=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(re.data),this._completeResults.errors=this._completeResults.errors.concat(re.errors),this._completeResults.meta=re.meta),this._completed||!Be||!H(this._config.complete)||re&&re.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),Be||re&&re.meta.paused||this._nextChunk(),re}this._halted=!0},this._sendError=function(v){H(this._config.error)?this._config.error(v):s&&this._config.error&&n.postMessage({workerId:f.WORKER_ID,error:v,finished:!1})}}function w(m){var v;(m=m||{}).chunkSize||(m.chunkSize=f.RemoteChunkSize),p.call(this,m),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(M){this._input=M,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(v=new XMLHttpRequest,this._config.withCredentials&&(v.withCredentials=this._config.withCredentials),r||(v.onload=L(this._chunkLoaded,this),v.onerror=L(this._chunkError,this)),v.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var M=this._config.downloadRequestHeaders;for(var R in M)v.setRequestHeader(R,M[R])}if(this._config.chunkSize){var j=this._start+this._config.chunkSize-1;v.setRequestHeader("Range","bytes="+this._start+"-"+j)}try{v.send(this._config.downloadRequestBody)}catch(re){this._chunkError(re.message)}r&&v.status===0&&this._chunkError()}},this._chunkLoaded=function(){v.readyState===4&&(v.status<200||400<=v.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:v.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(M){var R=M.getResponseHeader("Content-Range");return R===null?-1:parseInt(R.substring(R.lastIndexOf("/")+1))}(v),this.parseChunk(v.responseText)))},this._chunkError=function(M){var R=v.statusText||M;this._sendError(new Error(R))}}function k(m){var v,M;(m=m||{}).chunkSize||(m.chunkSize=f.LocalChunkSize),p.call(this,m);var R=typeof FileReader<"u";this.stream=function(j){this._input=j,M=j.slice||j.webkitSlice||j.mozSlice,R?((v=new FileReader).onload=L(this._chunkLoaded,this),v.onerror=L(this._chunkError,this)):v=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var j=this._input;if(this._config.chunkSize){var re=Math.min(this._start+this._config.chunkSize,this._input.size);j=M.call(j,this._start,re)}var fe=v.readAsText(j,this._config.encoding);R||this._chunkLoaded({target:{result:fe}})},this._chunkLoaded=function(j){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(j.target.result)},this._chunkError=function(){this._sendError(v.error)}}function O(m){var v;p.call(this,m=m||{}),this.stream=function(M){return v=M,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var M,R=this._config.chunkSize;return R?(M=v.substring(0,R),v=v.substring(R)):(M=v,v=""),this._finished=!v,this.parseChunk(M)}}}function W(m){p.call(this,m=m||{});var v=[],M=!0,R=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(j){this._input=j,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){R&&v.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),v.length?this.parseChunk(v.shift()):M=!0},this._streamData=L(function(j){try{v.push(typeof j=="string"?j:j.toString(this._config.encoding)),M&&(M=!1,this._checkIsFinished(),this.parseChunk(v.shift()))}catch(re){this._streamError(re)}},this),this._streamError=L(function(j){this._streamCleanUp(),this._sendError(j)},this),this._streamEnd=L(function(){this._streamCleanUp(),R=!0,this._streamData("")},this),this._streamCleanUp=L(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function I(m){var v,M,R,j=Math.pow(2,53),re=-j,fe=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Be=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,De=this,Z=0,Oe=0,ae=!1,at=!1,Ve=[],Q={data:[],errors:[],meta:{}};if(H(m.step)){var ke=m.step;m.step=function(K){if(Q=K,ie())V();else{if(V(),Q.data.length===0)return;Z+=K.data.length,m.preview&&Z>m.preview?M.abort():(Q.data=Q.data[0],ke(Q,De))}}}function U(K){return m.skipEmptyLines==="greedy"?K.join("").trim()==="":K.length===1&&K[0].length===0}function V(){return Q&&R&&(ue("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+f.DefaultDelimiter+"'"),R=!1),m.skipEmptyLines&&(Q.data=Q.data.filter(function(K){return!U(K)})),ie()&&function(){if(!Q)return;function K(Me,qe){H(m.transformHeader)&&(Me=m.transformHeader(Me,qe)),Ve.push(Me)}if(Array.isArray(Q.data[0])){for(var $e=0;ie()&&$e<Q.data.length;$e++)Q.data[$e].forEach(K);Q.data.splice(0,1)}else Q.data.forEach(K)}(),function(){if(!Q||!m.header&&!m.dynamicTyping&&!m.transform)return Q;function K(Me,qe){var Re,Ye=m.header?{}:[];for(Re=0;Re<Me.length;Re++){var Ge=Re,Te=Me[Re];m.header&&(Ge=Re>=Ve.length?"__parsed_extra":Ve[Re]),m.transform&&(Te=m.transform(Te,Ge)),Te=Le(Ge,Te),Ge==="__parsed_extra"?(Ye[Ge]=Ye[Ge]||[],Ye[Ge].push(Te)):Ye[Ge]=Te}return m.header&&(Re>Ve.length?ue("FieldMismatch","TooManyFields","Too many fields: expected "+Ve.length+" fields but parsed "+Re,Oe+qe):Re<Ve.length&&ue("FieldMismatch","TooFewFields","Too few fields: expected "+Ve.length+" fields but parsed "+Re,Oe+qe)),Ye}var $e=1;return!Q.data.length||Array.isArray(Q.data[0])?(Q.data=Q.data.map(K),$e=Q.data.length):Q.data=K(Q.data,0),m.header&&Q.meta&&(Q.meta.fields=Ve),Oe+=$e,Q}()}function ie(){return m.header&&Ve.length===0}function Le(K,$e){return Me=K,m.dynamicTypingFunction&&m.dynamicTyping[Me]===void 0&&(m.dynamicTyping[Me]=m.dynamicTypingFunction(Me)),(m.dynamicTyping[Me]||m.dynamicTyping)===!0?$e==="true"||$e==="TRUE"||$e!=="false"&&$e!=="FALSE"&&(function(qe){if(fe.test(qe)){var Re=parseFloat(qe);if(re<Re&&Re<j)return!0}return!1}($e)?parseFloat($e):Be.test($e)?new Date($e):$e===""?null:$e):$e;var Me}function ue(K,$e,Me,qe){var Re={type:K,code:$e,message:Me};qe!==void 0&&(Re.row=qe),Q.errors.push(Re)}this.parse=function(K,$e,Me){var qe=m.quoteChar||'"';if(m.newline||(m.newline=function(Ge,Te){Ge=Ge.substring(0,1048576);var vt=new RegExp(ne(Te)+"([^]*?)"+ne(Te),"gm"),st=(Ge=Ge.replace(vt,"")).split("\r"),_t=Ge.split(`
`),wt=1<_t.length&&_t[0].length<st[0].length;if(st.length===1||wt)return`
`;for(var ft=0,Ne=0;Ne<st.length;Ne++)st[Ne][0]===`
`&&ft++;return ft>=st.length/2?`\r
`:"\r"}(K,qe)),R=!1,m.delimiter)H(m.delimiter)&&(m.delimiter=m.delimiter(K),Q.meta.delimiter=m.delimiter);else{var Re=function(Ge,Te,vt,st,_t){var wt,ft,Ne,We;_t=_t||[",","	","|",";",f.RECORD_SEP,f.UNIT_SEP];for(var At=0;At<_t.length;At++){var Ie=_t[At],Pt=0,kt=0,St=0;Ne=void 0;for(var Ct=new le({comments:st,delimiter:Ie,newline:Te,preview:10}).parse(Ge),Et=0;Et<Ct.data.length;Et++)if(vt&&U(Ct.data[Et]))St++;else{var Lt=Ct.data[Et].length;kt+=Lt,Ne!==void 0?0<Lt&&(Pt+=Math.abs(Lt-Ne),Ne=Lt):Ne=Lt}0<Ct.data.length&&(kt/=Ct.data.length-St),(ft===void 0||Pt<=ft)&&(We===void 0||We<kt)&&1.99<kt&&(ft=Pt,wt=Ie,We=kt)}return{successful:!!(m.delimiter=wt),bestDelimiter:wt}}(K,m.newline,m.skipEmptyLines,m.comments,m.delimitersToGuess);Re.successful?m.delimiter=Re.bestDelimiter:(R=!0,m.delimiter=f.DefaultDelimiter),Q.meta.delimiter=m.delimiter}var Ye=x(m);return m.preview&&m.header&&Ye.preview++,v=K,M=new le(Ye),Q=M.parse(v,$e,Me),V(),ae?{meta:{paused:!0}}:Q||{meta:{paused:!1}}},this.paused=function(){return ae},this.pause=function(){ae=!0,M.abort(),v=H(m.chunk)?"":v.substring(M.getCharIndex())},this.resume=function(){De.streamer._halted?(ae=!1,De.streamer.parseChunk(v,!0)):setTimeout(De.resume,3)},this.aborted=function(){return at},this.abort=function(){at=!0,M.abort(),Q.meta.aborted=!0,H(m.complete)&&m.complete(Q),v=""}}function ne(m){return m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function le(m){var v,M=(m=m||{}).delimiter,R=m.newline,j=m.comments,re=m.step,fe=m.preview,Be=m.fastMode,De=v=m.quoteChar===void 0||m.quoteChar===null?'"':m.quoteChar;if(m.escapeChar!==void 0&&(De=m.escapeChar),(typeof M!="string"||-1<f.BAD_DELIMITERS.indexOf(M))&&(M=","),j===M)throw new Error("Comment character same as delimiter");j===!0?j="#":(typeof j!="string"||-1<f.BAD_DELIMITERS.indexOf(j))&&(j=!1),R!==`
`&&R!=="\r"&&R!==`\r
`&&(R=`
`);var Z=0,Oe=!1;this.parse=function(ae,at,Ve){if(typeof ae!="string")throw new Error("Input must be a string");var Q=ae.length,ke=M.length,U=R.length,V=j.length,ie=H(re),Le=[],ue=[],K=[],$e=Z=0;if(!ae)return gt();if(m.header&&!at){var Me=ae.split(R)[0].split(M),qe=[],Re={},Ye=!1;for(var Ge in Me){var Te=Me[Ge];H(m.transformHeader)&&(Te=m.transformHeader(Te,Ge));var vt=Te,st=Re[Te]||0;for(0<st&&(Ye=!0,vt=Te+"_"+st),Re[Te]=st+1;qe.includes(vt);)vt=vt+"_"+st;qe.push(vt)}if(Ye){var _t=ae.split(R);_t[0]=qe.join(M),ae=_t.join(R)}}if(Be||Be!==!1&&ae.indexOf(v)===-1){for(var wt=ae.split(R),ft=0;ft<wt.length;ft++){if(K=wt[ft],Z+=K.length,ft!==wt.length-1)Z+=R.length;else if(Ve)return gt();if(!j||K.substring(0,V)!==j){if(ie){if(Le=[],St(K.split(M)),Ut(),Oe)return gt()}else St(K.split(M));if(fe&&fe<=ft)return Le=Le.slice(0,fe),gt(!0)}}return gt()}for(var Ne=ae.indexOf(M,Z),We=ae.indexOf(R,Z),At=new RegExp(ne(De)+ne(v),"g"),Ie=ae.indexOf(v,Z);;)if(ae[Z]!==v)if(j&&K.length===0&&ae.substring(Z,Z+V)===j){if(We===-1)return gt();Z=We+U,We=ae.indexOf(R,Z),Ne=ae.indexOf(M,Z)}else if(Ne!==-1&&(Ne<We||We===-1))K.push(ae.substring(Z,Ne)),Z=Ne+ke,Ne=ae.indexOf(M,Z);else{if(We===-1)break;if(K.push(ae.substring(Z,We)),Lt(We+U),ie&&(Ut(),Oe))return gt();if(fe&&Le.length>=fe)return gt(!0)}else for(Ie=Z,Z++;;){if((Ie=ae.indexOf(v,Ie+1))===-1)return Ve||ue.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Le.length,index:Z}),Et();if(Ie===Q-1)return Et(ae.substring(Z,Ie).replace(At,v));if(v!==De||ae[Ie+1]!==De){if(v===De||Ie===0||ae[Ie-1]!==De){Ne!==-1&&Ne<Ie+1&&(Ne=ae.indexOf(M,Ie+1)),We!==-1&&We<Ie+1&&(We=ae.indexOf(R,Ie+1));var Pt=Ct(We===-1?Ne:Math.min(Ne,We));if(ae.substr(Ie+1+Pt,ke)===M){K.push(ae.substring(Z,Ie).replace(At,v)),ae[Z=Ie+1+Pt+ke]!==v&&(Ie=ae.indexOf(v,Z)),Ne=ae.indexOf(M,Z),We=ae.indexOf(R,Z);break}var kt=Ct(We);if(ae.substring(Ie+1+kt,Ie+1+kt+U)===R){if(K.push(ae.substring(Z,Ie).replace(At,v)),Lt(Ie+1+kt+U),Ne=ae.indexOf(M,Z),Ie=ae.indexOf(v,Z),ie&&(Ut(),Oe))return gt();if(fe&&Le.length>=fe)return gt(!0);break}ue.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Le.length,index:Z}),Ie++}}else Ie++}return Et();function St(ut){Le.push(ut),$e=Z}function Ct(ut){var br=0;if(ut!==-1){var hr=ae.substring(Ie+1,ut);hr&&hr.trim()===""&&(br=hr.length)}return br}function Et(ut){return Ve||(ut===void 0&&(ut=ae.substring(Z)),K.push(ut),Z=Q,St(K),ie&&Ut()),gt()}function Lt(ut){Z=ut,St(K),K=[],We=ae.indexOf(R,Z)}function gt(ut){return{data:Le,errors:ue,meta:{delimiter:M,linebreak:R,aborted:Oe,truncated:!!ut,cursor:$e+(at||0)}}}function Ut(){re(gt()),Le=[],ue=[]}},this.abort=function(){Oe=!0},this.getCharIndex=function(){return Z}}function oe(m){var v=m.data,M=o[v.workerId],R=!1;if(v.error)M.userError(v.error,v.file);else if(v.results&&v.results.data){var j={abort:function(){R=!0,T(v.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:S,resume:S};if(H(M.userStep)){for(var re=0;re<v.results.data.length&&(M.userStep({data:v.results.data[re],errors:v.results.errors,meta:v.results.meta},j),!R);re++);delete v.results}else H(M.userChunk)&&(M.userChunk(v.results,j,v.file),delete v.results)}v.finished&&!R&&T(v.workerId,v.results)}function T(m,v){var M=o[m];H(M.userComplete)&&M.userComplete(v),M.terminate(),delete o[m]}function S(){throw new Error("Not implemented.")}function x(m){if(typeof m!="object"||m===null)return m;var v=Array.isArray(m)?[]:{};for(var M in m)v[M]=x(m[M]);return v}function L(m,v){return function(){m.apply(v,arguments)}}function H(m){return typeof m=="function"}return s&&(n.onmessage=function(m){var v=m.data;if(f.WORKER_ID===void 0&&v&&(f.WORKER_ID=v.workerId),typeof v.input=="string")n.postMessage({workerId:f.WORKER_ID,results:f.parse(v.input,v.config),finished:!0});else if(n.File&&v.input instanceof File||v.input instanceof Object){var M=f.parse(v.input,v.config);M&&n.postMessage({workerId:f.WORKER_ID,results:M,finished:!0})}}),(w.prototype=Object.create(p.prototype)).constructor=w,(k.prototype=Object.create(p.prototype)).constructor=k,(O.prototype=Object.create(O.prototype)).constructor=O,(W.prototype=Object.create(p.prototype)).constructor=W,f})})(vs);var Af=vs.exports;const Fa=ds(Af),Sf=""+new URL("../assets/female_front.cbbf7559.svg",import.meta.url).href,Lf=""+new URL("../assets/female_back.f4b0cc86.svg",import.meta.url).href,Pf=""+new URL("../assets/male_front.dc1ca7a4.svg",import.meta.url).href,Df=""+new URL("../assets/male_back.27c5d660.svg",import.meta.url).href,ms={FemaleFront:Sf,FemaleBack:Lf,MaleFront:Pf,MaleBack:Df},nr=class{constructor(){bt(this,"canvases",{});bt(this,"loadingPromises",{})}static getInstance(){return nr.instance||(nr.instance=new nr),nr.instance}async loadPersonaCanvas(e){return new Promise((t,n)=>{const r=new Image;r.onload=async()=>{try{const s=new OffscreenCanvas(r.naturalWidth,r.naturalHeight),o=s.getContext("2d");if(!o)throw new Error("Could not get canvas context");o.drawImage(r,0,0),this.canvases[e]=s,t(s)}catch(s){n(s)}},r.onerror=()=>{n(new Error(`Failed to load persona image: ${e}`))},r.src=ms[e]})}async getBitmap(e){const t=await this.getCanvas(e);return createImageBitmap(t)}async getCanvas(e){if(this.canvases[e])return this.canvases[e];if(this.loadingPromises[e])return this.loadingPromises[e];this.loadingPromises[e]=this.loadPersonaCanvas(e);try{const t=await this.loadingPromises[e];return delete this.loadingPromises[e],t}catch(t){throw delete this.loadingPromises[e],t}}async getPersonaBitmaps(e){const t=`${e}Front`,n=`${e}Back`,[r,s]=await Promise.all([this.getBitmap(t),this.getBitmap(n)]);return{frontBitmap:r,backBitmap:s}}async preloadAllCanvases(){const e=["FemaleFront","FemaleBack","MaleFront","MaleBack"];await Promise.all(e.map(t=>this.getCanvas(t)))}getLoadedCanvases(){return{...this.canvases}}clearCache(){this.canvases={},this.loadingPromises={}}};let Ir=nr;bt(Ir,"instance");const zt=Ir.getInstance();var Xe=(i=>(i.LookingGlass="Looking Glass",i.DensityMap="Density Map",i.ValenceMap="Valence Map",i))(Xe||{});function Rf(i){i.classList.remove("hidden");const{width:e,height:t}=i.getBoundingClientRect();return i.classList.add("hidden"),{newWidth:e,newHeight:t,imgWidth:i.naturalWidth,imgHeight:i.naturalHeight}}function Bf(i,e,t){const n=i.getContext("2d");if(n==null)throw"Could not get context while resizing the canvas.";const r=window.devicePixelRatio||1;i.width=e*r,i.height=t*r,n.scale(r,r)}function Ia(i,e,t,n){const r=e.getContext("2d");if(r==null)throw"Could not get context while drawing persona on the canvas.";i.classList.remove("hidden"),r.drawImage(i,0,0,t,n),r.globalCompositeOperation="source-atop",i.classList.add("hidden")}function bs(i,e,t,n){if(i.length<2)return;e.lineJoin="round",e.lineCap="round",t&&(e.strokeStyle=t),n&&(e.lineWidth=n);let r=i[0],s=i[1];e.beginPath(),e.moveTo(s.x,s.y);for(let o=1;o<i.length;o++){const c=Of(r,s);e.quadraticCurveTo(r.x,r.y,c.x,c.y),r=i[o],s=i[o+1]}r.x+=.1,r.y+=.1,e.lineTo(r.x,r.y),e.stroke()}function Of(i,e){return{x:i.x+(e.x-i.x)/2,y:i.y+(e.y-i.y)/2}}function Tf(i,e,t){const n=e.getContext("2d",{alpha:!1});if(n==null)throw"Could not get context to draw strokes.";for(const r of i){let s=r.points,o=r.brushSize;t!==void 0&&(s=_s(r.points,t),o*=t),bs(s,n,r.brushColor,o)}}function _s(i,e){return i.map(t=>({x:t.x*e,y:t.y*e}))}function Nf(i){return i.FemaleFront?"Female":"Male"}const Aa=(i,e)=>{const t=new OffscreenCanvas(i,e),n=t.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("Could not get canvas context");return[t,n]},zf=(i,e,t,n)=>{const r=e.includes("Front")?t:n;i.drawImage(r,0,0)},ws=(i,e,t)=>{const n=i.getImageData(0,0,e,t);return new Uint32Array(n.data)},xf=(i,e)=>({x:Math.floor(i/4)%e,y:Math.floor(i/4/e)}),Uf=i=>({valence:i.valence,intensity:i.intensity}),jf=(i,e,t,n,r,s)=>{Tf([i],n);const o=ws(t,r,s),c=Uf(i),f={};for(let h=0;h<o.length;h++)if(h%4===0&&e[h]>0&&o[h]>0){const{x:p,y:w}=xf(h,r);f[p]??(f[p]={}),f[p][w]=c}return f},qf=i=>i.reduce((e,t)=>(Object.entries(t).forEach(([n,r])=>{var s;e[s=parseInt(n)]??(e[s]={}),Object.entries(r).forEach(([o,c])=>{e[parseInt(n)][parseInt(o)]=c})}),e),{}),Gf=i=>{const e={},t=[];let n=0;return Object.entries(i).forEach(([r,s])=>{const o=parseInt(r);Object.entries(s).forEach(([c,f])=>{const h=parseInt(c);t.push({x:o,y:h,...f});const p=`${f.valence}:${f.intensity}`;e[p]=(e[p]??0)+1,n++})}),{areas:e,totalDrawingArea:n,drawnPoints:t}},Wf=(i,e,t,n)=>{const r=Object.keys(i);let s={};if(r.includes("imgWidth")&&r.includes("imgWidth")){const{imgWidth:c,imgHeight:f}=i,[h,p]=Aa(c,f),[w,k]=Aa(c,f);zf(p,e,t,n);const O=ws(p,c,f),W=i.strokes.map(I=>jf(I,O,k,w,c,f));s=qf(W)}return[Gf(s),s]},Hf=(i,e,t)=>{let n={},r=0;const s={...i};return Object.entries(i).forEach(([o,c])=>{if(!c)return;const[f,h]=Wf(c,o,e,t);Object.entries(f.areas).forEach(([p,w])=>{n[p]=(n[p]??0)+w}),r+=f.totalDrawingArea,s[o]={...c,sensationPixelMap:h,drawnPoints:f.drawnPoints}}),{areas:n,totalDrawingArea:r,updatedDrawing:s}};class vr{constructor({id:e,drawing:t,areas:n={},totalDrawingArea:r=0,computed:s=!1}){bt(this,"id");bt(this,"persona");bt(this,"drawing");bt(this,"areas");bt(this,"totalDrawingArea");bt(this,"computed");this.id=e,this.drawing=t,this.persona=Nf(t),this.areas=n,this.totalDrawingArea=r,this.computed=s}computeStrokeAreas(e,t){const n=Hf(this.drawing,e,t);return new vr({id:this.id,drawing:n.updatedDrawing,areas:n.areas,totalDrawingArea:n.totalDrawingArea,computed:!0})}}class Vf{constructor(){bt(this,"participants",{});bt(this,"personas",{Female:[],Male:[]});bt(this,"drawingsPerSide",{})}addParticipant(e){this.participants[e.id]=e,this.personas[e.persona].push(e),this.classifyDrawing(e.drawing)}updateParticipant(e){if(!this.participants[e.id])throw new Error(`Participant with id ${e.id} not found`);this.participants[e.id]=e;const n=this.personas[e.persona],r=n.findIndex(s=>s.id===e.id);r!==-1&&(n[r]=e)}getParticipant(e){return this.participants[e]}isParticipantComputed(e){const t=this.participants[e];return t?t.computed:!1}classifyDrawing(e){for(const t of Object.keys(e)){const n=t,r=this.drawingsPerSide[n]??[];r.push(e),this.drawingsPerSide[n]=r}}}function Yf(i,{delay:e=0,duration:t=400,easing:n=yf}={}){const r=+getComputedStyle(i).opacity;return{delay:e,duration:t,easing:n,css:s=>`opacity: ${s*r}`}}function Sa(i){let e,t,n;const r=i[8].default,s=lr(r,i,i[7],null);return{c(){e=ee("ul"),s&&s.c(),this.h()},l(o){e=te(o,"UL",{class:!0});var c=G(e);s&&s.l(c),c.forEach(C),this.h()},h(){E(e,"class","absolute top-full left-0 w-48 p-1 bg-neutral-700 shadow")},m(o,c){J(o,e,c),s&&s.m(e,null),n=!0},p(o,c){s&&s.p&&(!n||c&128)&&ir(s,r,o,o[7],n?fr(r,o[7],c,null):or(o[7]),null)},i(o){n||(B(s,o),t&&t.end(1),n=!0)},o(o){z(s,o),t=Ef(e,Yf,{duration:100}),n=!1},d(o){o&&C(e),s&&s.d(o),o&&t&&t.end()}}}function Qf(i){let e,t,n,r,s,o,c,f=i[0]&&Sa(i);return{c(){e=ee("div"),t=ee("button"),n=xe(i[1]),r=_e(),f&&f.c(),this.h()},l(h){e=te(h,"DIV",{class:!0});var p=G(e);t=te(p,"BUTTON",{class:!0});var w=G(t);n=Ue(w,i[1]),w.forEach(C),r=we(p),f&&f.l(p),p.forEach(C),this.h()},h(){E(t,"class","h-full px-3 text-neutral-100 text-xs"),dt(t,"bg-neutral-700",i[0]),E(e,"class","relative flex items-center h-full")},m(h,p){J(h,e,p),N(e,t),N(t,n),N(e,r),f&&f.m(e,null),i[9](e),s=!0,o||(c=[$t(window,"click",i[4]),$t(t,"click",i[3])],o=!0)},p(h,[p]){(!s||p&2)&&yt(n,h[1]),(!s||p&1)&&dt(t,"bg-neutral-700",h[0]),h[0]?f?(f.p(h,p),p&1&&B(f,1)):(f=Sa(h),f.c(),B(f,1),f.m(e,null)):f&&(it(),z(f,1,1,()=>{f=null}),ot())},i(h){s||(B(f),s=!0)},o(h){z(f),s=!1},d(h){h&&C(e),f&&f.d(),i[9](null),o=!1,on(c)}}}function Xf(i,e,t){let{$$slots:n={},$$scope:r}=e,{title:s}=e,{isOpen:o=!1}=e,{enableIcon:c=!1}=e;function f(){t(0,o=!1)}let h;Cf("menu",{enableIcon:c});function p(){t(0,o=!o)}function w(O){O.target instanceof Node&&h.contains(O.target)===!1&&t(0,o=!1)}function k(O){lt[O?"unshift":"push"](()=>{h=O,t(2,h)})}return i.$$set=O=>{"title"in O&&t(1,s=O.title),"isOpen"in O&&t(0,o=O.isOpen),"enableIcon"in O&&t(5,c=O.enableIcon),"$$scope"in O&&t(7,r=O.$$scope)},[o,s,h,p,w,c,f,r,n,k]}class ks extends rt{constructor(e){super(),nt(this,e,Xf,Qf,He,{title:1,isOpen:0,enableIcon:5,close:6})}get close(){return this.$$.ctx[6]}}const Jf=i=>({isActive:i&1}),La=i=>({isActive:i[0]});function Zf(i){let e,t;const n=i[3].icon,r=lr(n,i,i[2],La);return{c(){e=ee("span"),r&&r.c(),this.h()},l(s){e=te(s,"SPAN",{class:!0});var o=G(e);r&&r.l(o),o.forEach(C),this.h()},h(){E(e,"class","w-[16px] mr-1")},m(s,o){J(s,e,o),r&&r.m(e,null),t=!0},p(s,o){r&&r.p&&(!t||o&5)&&ir(r,n,s,s[2],t?fr(n,s[2],o,Jf):or(s[2]),La)},i(s){t||(B(r,s),t=!0)},o(s){z(r,s),t=!1},d(s){s&&C(e),r&&r.d(s)}}}function Kf(i){let e,t,n,r,s,o,c=i[1]&&Zf(i);const f=i[3].default,h=lr(f,i,i[2],null);return{c(){e=ee("li"),t=ee("button"),c&&c.c(),n=_e(),h&&h.c(),this.h()},l(p){e=te(p,"LI",{class:!0});var w=G(e);t=te(w,"BUTTON",{class:!0});var k=G(t);c&&c.l(k),n=we(k),h&&h.l(k),k.forEach(C),w.forEach(C),this.h()},h(){E(t,"class","flex items-center w-full py-1 pr-2 "+(i[1]?"pl-1":"pl-2")+" text-xs text-neutral-100 text-left"),dt(t,"hover:bg-blue-500",!i[0]),E(e,"class","w-full")},m(p,w){J(p,e,w),N(e,t),c&&c.m(t,null),N(t,n),h&&h.m(t,null),r=!0,s||(o=$t(e,"click",i[4]),s=!0)},p(p,[w]){p[1]&&c.p(p,w),h&&h.p&&(!r||w&4)&&ir(h,f,p,p[2],r?fr(f,p[2],w,null):or(p[2]),null),(!r||w&1)&&dt(t,"hover:bg-blue-500",!p[0])},i(p){r||(B(c),B(h,p),r=!0)},o(p){z(c),z(h,p),r=!1},d(p){p&&C(e),c&&c.d(),h&&h.d(p),s=!1,o()}}}function eu(i,e,t){let{$$slots:n={},$$scope:r}=e,{isActive:s=!1}=e;const{enableIcon:o}=Mf("menu");function c(f){Ar.call(this,i,f)}return i.$$set=f=>{"isActive"in f&&t(0,s=f.isActive),"$$scope"in f&&t(2,r=f.$$scope)},[s,o,r,n,c]}class xt extends rt{constructor(e){super(),nt(this,e,eu,Kf,He,{isActive:0})}}function tu(i){let e;return{c(){e=ee("hr"),this.h()},l(t){e=te(t,"HR",{class:!0}),this.h()},h(){E(e,"class","my-0.5 border-0 border-b border-neutral-600")},m(t,n){J(t,e,n)},p:je,i:je,o:je,d(t){t&&C(e)}}}class ru extends rt{constructor(e){super(),nt(this,e,null,tu,He,{})}}const nu=i=>({}),Pa=i=>({}),au=i=>({}),Da=i=>({});function Ra(i){let e,t;const n=i[5].settings,r=lr(n,i,i[4],Pa);return{c(){e=ee("aside"),r&&r.c(),this.h()},l(s){e=te(s,"ASIDE",{class:!0,style:!0});var o=G(e);r&&r.l(o),o.forEach(C),this.h()},h(){E(e,"class","flex flex-col h-full bg-neutral-600 border-l border-neutral-900"),ln(e,"width",i[0])},m(s,o){J(s,e,o),r&&r.m(e,null),i[7](e),t=!0},p(s,o){r&&r.p&&(!t||o&16)&&ir(r,n,s,s[4],t?fr(n,s[4],o,nu):or(s[4]),Pa),(!t||o&1)&&ln(e,"width",s[0])},i(s){t||(B(r,s),t=!0)},o(s){z(r,s),t=!1},d(s){s&&C(e),r&&r.d(s),i[7](null)}}}function su(i){let e,t,n,r;const s=i[5].panels,o=lr(s,i,i[4],Da);let c=i[3].settings&&Ra(i);return{c(){e=ee("section"),t=ee("main"),o&&o.c(),n=_e(),c&&c.c(),this.h()},l(f){e=te(f,"SECTION",{class:!0});var h=G(e);t=te(h,"MAIN",{class:!0});var p=G(t);o&&o.l(p),p.forEach(C),n=we(h),c&&c.l(h),h.forEach(C),this.h()},h(){E(t,"class","flex-grow grid grid-cols-1 gap-[2px] bg-neutral-600"),E(e,"class","w-full h-full flex items-stretch")},m(f,h){J(f,e,h),N(e,t),o&&o.m(t,null),i[6](t),N(e,n),c&&c.m(e,null),r=!0},p(f,[h]){o&&o.p&&(!r||h&16)&&ir(o,s,f,f[4],r?fr(s,f[4],h,au):or(f[4]),Da),f[3].settings?c?(c.p(f,h),h&8&&B(c,1)):(c=Ra(f),c.c(),B(c,1),c.m(e,null)):c&&(it(),z(c,1,1,()=>{c=null}),ot())},i(f){r||(B(o,f),B(c),r=!0)},o(f){z(o,f),z(c),r=!1},d(f){f&&C(e),o&&o.d(f),i[6](null),c&&c.d()}}}function lu(i,e,t){let{$$slots:n={},$$scope:r}=e;const s=Ff(n);let{sidebarWidth:o="18rem"}=e,c,f;function h(w){lt[w?"unshift":"push"](()=>{c=w,t(1,c)})}function p(w){lt[w?"unshift":"push"](()=>{f=w,t(2,f)})}return i.$$set=w=>{"sidebarWidth"in w&&t(0,o=w.sidebarWidth),"$$scope"in w&&t(4,r=w.$$scope)},[o,c,f,s,r,n,h,p]}class cn extends rt{constructor(e){super(),nt(this,e,lu,su,He,{sidebarWidth:0})}}function Ba(i,e,t){const n=i.slice();return n[9]=e[t],n}function Oa(i){let e=i[1],t,n=Na(i);return{c(){n.c(),t=Ke()},l(r){n.l(r),t=Ke()},m(r,s){n.m(r,s),J(r,t,s)},p(r,s){s&2&&He(e,e=r[1])?(n.d(1),n=Na(r),n.c(),n.m(t.parentNode,t)):n.p(r,s)},d(r){r&&C(t),n.d(r)}}}function Ta(i){let e,t=i[9]+"",n,r,s,o;function c(){return i[7](i[9])}return{c(){e=ee("button"),n=xe(t),r=_e(),this.h()},l(f){e=te(f,"BUTTON",{class:!0});var h=G(e);n=Ue(h,t),r=we(h),h.forEach(C),this.h()},h(){E(e,"class","panel-tab svelte-143z4t9"),dt(e,"active",i[1]===i[9]),dt(e,"highlight",i[3])},m(f,h){J(f,e,h),N(e,n),N(e,r),s||(o=$t(e,"click",c),s=!0)},p(f,h){i=f,h&1&&t!==(t=i[9]+"")&&yt(n,t),h&3&&dt(e,"active",i[1]===i[9]),h&8&&dt(e,"highlight",i[3])},d(f){f&&C(e),s=!1,o()}}}function Na(i){let e,t=i[0],n=[];for(let r=0;r<t.length;r+=1)n[r]=Ta(Ba(i,t,r));return{c(){for(let r=0;r<n.length;r+=1)n[r].c();e=Ke()},l(r){for(let s=0;s<n.length;s+=1)n[s].l(r);e=Ke()},m(r,s){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(r,s);J(r,e,s)},p(r,s){if(s&27){t=r[0];let o;for(o=0;o<t.length;o+=1){const c=Ba(r,t,o);n[o]?n[o].p(c,s):(n[o]=Ta(c),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(r){ur(n,r),r&&C(e)}}}function za(i){let e,t;return{c(){e=ee("span"),t=xe(i[2]),this.h()},l(n){e=te(n,"SPAN",{class:!0});var r=G(e);t=Ue(r,i[2]),r.forEach(C),this.h()},h(){E(e,"class","z-10 absolute top-4 right-4 py-1 px-2 bg-neutral-900 shadow bg-opacity-50 text-neutral-100 text-xs")},m(n,r){J(n,e,r),N(e,t)},p(n,r){r&4&&yt(t,n[2])},d(n){n&&C(e)}}}function iu(i){let e,t,n,r,s,o,c=i[0]!==void 0&&Oa(i),f=i[2]&&za(i);const h=i[6].default,p=lr(h,i,i[5],null);return{c(){e=ee("div"),t=ee("div"),c&&c.c(),n=_e(),r=ee("div"),f&&f.c(),s=_e(),p&&p.c(),this.h()},l(w){e=te(w,"DIV",{class:!0});var k=G(e);t=te(k,"DIV",{class:!0});var O=G(t);c&&c.l(O),O.forEach(C),n=we(k),r=te(k,"DIV",{class:!0});var W=G(r);f&&f.l(W),s=we(W),p&&p.l(W),W.forEach(C),k.forEach(C),this.h()},h(){E(t,"class","panel-tabs w-full h-5 svelte-143z4t9"),E(r,"class","panel relative flex-grow w-full h-full"),E(e,"class","panel-container svelte-143z4t9")},m(w,k){J(w,e,k),N(e,t),c&&c.m(t,null),N(e,n),N(e,r),f&&f.m(r,null),N(r,s),p&&p.m(r,null),o=!0},p(w,[k]){w[0]!==void 0?c?c.p(w,k):(c=Oa(w),c.c(),c.m(t,null)):c&&(c.d(1),c=null),w[2]?f?f.p(w,k):(f=za(w),f.c(),f.m(r,s)):f&&(f.d(1),f=null),p&&p.p&&(!o||k&32)&&ir(p,h,w,w[5],o?fr(h,w[5],k,null):or(w[5]),null)},i(w){o||(B(p,w),o=!0)},o(w){z(p,w),o=!1},d(w){w&&C(e),c&&c.d(),f&&f.d(),p&&p.d(w)}}}function ou(i,e,t){let{$$slots:n={},$$scope:r}=e,{tabs:s=void 0}=e,{activeTab:o=void 0}=e,{caption:c=void 0}=e,{highlightTab:f=!0}=e;const h=mr();function p(k){h("tabClick",k)}const w=k=>p(k);return i.$$set=k=>{"tabs"in k&&t(0,s=k.tabs),"activeTab"in k&&t(1,o=k.activeTab),"caption"in k&&t(2,c=k.caption),"highlightTab"in k&&t(3,f=k.highlightTab),"$$scope"in k&&t(5,r=k.$$scope)},[s,o,c,f,p,r,n,w]}class cr extends rt{constructor(e){super(),nt(this,e,ou,iu,He,{tabs:0,activeTab:1,caption:2,highlightTab:3})}}function xa(i,e,t){const n=i.slice();return n[5]=e[t],n}function Ua(i){let e,t=i[5]+"",n,r,s;return{c(){e=ee("option"),n=xe(t),this.h()},l(o){e=te(o,"OPTION",{});var c=G(e);n=Ue(c,t),c.forEach(C),this.h()},h(){e.__value=r=i[5],e.value=e.__value,e.selected=s=i[2]===i[5]},m(o,c){J(o,e,c),N(e,n)},p(o,c){c&2&&t!==(t=o[5]+"")&&yt(n,t),c&2&&r!==(r=o[5])&&(e.__value=r,e.value=e.__value),c&6&&s!==(s=o[2]===o[5])&&(e.selected=s)},d(o){o&&C(e)}}}function fu(i){let e,t,n,r,s,o,c,f=i[1],h=[];for(let p=0;p<f.length;p+=1)h[p]=Ua(xa(i,f,p));return{c(){e=ee("label"),t=xe(i[0]),n=xe(":"),r=_e(),s=ee("select");for(let p=0;p<h.length;p+=1)h[p].c();this.h()},l(p){e=te(p,"LABEL",{class:!0});var w=G(e);t=Ue(w,i[0]),n=Ue(w,":"),w.forEach(C),r=we(p),s=te(p,"SELECT",{name:!0,id:!0,class:!0});var k=G(s);for(let O=0;O<h.length;O+=1)h[O].l(k);k.forEach(C),this.h()},h(){E(e,"class","w-1/3 pr-2 text-xs text-neutral-400 text-right"),E(s,"name",i[0]),E(s,"id",i[0]),E(s,"class","emboss py-1 px-2 bg-neutral-700 border border-neutral-800 text-xs text-neutral-200")},m(p,w){J(p,e,w),N(e,t),N(e,n),J(p,r,w),J(p,s,w);for(let k=0;k<h.length;k+=1)h[k]&&h[k].m(s,null);o||(c=$t(s,"change",i[3]),o=!0)},p(p,[w]){if(w&1&&yt(t,p[0]),w&6){f=p[1];let k;for(k=0;k<f.length;k+=1){const O=xa(p,f,k);h[k]?h[k].p(O,w):(h[k]=Ua(O),h[k].c(),h[k].m(s,null))}for(;k<h.length;k+=1)h[k].d(1);h.length=f.length}w&1&&E(s,"name",p[0]),w&1&&E(s,"id",p[0])},i:je,o:je,d(p){p&&C(e),p&&C(r),p&&C(s),ur(h,p),o=!1,c()}}}function uu(i,e,t){let{name:n}=e,{options:r}=e,{selected:s=void 0}=e;const o=mr();function c(f){if(f.target){const h=f.target;o("change",h.value)}}return i.$$set=f=>{"name"in f&&t(0,n=f.name),"options"in f&&t(1,r=f.options),"selected"in f&&t(2,s=f.selected)},[n,r,s,c]}class cu extends rt{constructor(e){super(),nt(this,e,uu,fu,He,{name:0,options:1,selected:2})}}function hu(i){let e;return{c(){e=ee("td"),this.h()},l(t){e=te(t,"TD",{class:!0});var n=G(e);n.forEach(C),this.h()},h(){E(e,"class","py-1 px-2 border-l border-neutral-800 text-neutral-100 text-xs")},m(t,n){J(t,e,n),e.innerHTML=i[0]},p(t,[n]){n&1&&(e.innerHTML=t[0])},i:je,o:je,d(t){t&&C(e)}}}function gu(i,e,t){let{value:n}=e,{formatter:r=void 0}=e,s;if(r)s=r(n);else if(typeof n=="string")s=n;else if(n.toString)s=n.toString();else throw"Error: Cannot format value.";return i.$$set=o=>{"value"in o&&t(1,n=o.value),"formatter"in o&&t(2,r=o.formatter)},[s,n,r]}class pu extends rt{constructor(e){super(),nt(this,e,gu,hu,He,{value:1,formatter:2})}}function ja(i,e,t){const n=i.slice();return n[3]=e[t],n}function qa(i){let e,t;const n=[i[3]];let r={};for(let s=0;s<n.length;s+=1)r=Ht(r,n[s]);return e=new pu({props:r}),{c(){ge(e.$$.fragment)},l(s){pe(e.$$.fragment,s)},m(s,o){de(e,s,o),t=!0},p(s,o){const c=o&1?fn(n,[un(s[3])]):{};e.$set(c)},i(s){t||(B(e.$$.fragment,s),t=!0)},o(s){z(e.$$.fragment,s),t=!1},d(s){ve(e,s)}}}function du(i){let e,t,n,r,s=i[0],o=[];for(let f=0;f<s.length;f+=1)o[f]=qa(ja(i,s,f));const c=f=>z(o[f],1,1,()=>{o[f]=null});return{c(){e=ee("tr");for(let f=0;f<o.length;f+=1)o[f].c();this.h()},l(f){e=te(f,"TR",{class:!0});var h=G(e);for(let p=0;p<o.length;p+=1)o[p].l(h);h.forEach(C),this.h()},h(){E(e,"class","hover:bg-neutral-600 border-b last:border-b-0 border-neutral-800")},m(f,h){J(f,e,h);for(let p=0;p<o.length;p+=1)o[p]&&o[p].m(e,null);t=!0,n||(r=[$t(e,"mouseenter",i[1]),$t(e,"mouseleave",i[2])],n=!0)},p(f,[h]){if(h&1){s=f[0];let p;for(p=0;p<s.length;p+=1){const w=ja(f,s,p);o[p]?(o[p].p(w,h),B(o[p],1)):(o[p]=qa(w),o[p].c(),B(o[p],1),o[p].m(e,null))}for(it(),p=s.length;p<o.length;p+=1)c(p);ot()}},i(f){if(!t){for(let h=0;h<s.length;h+=1)B(o[h]);t=!0}},o(f){o=o.filter(Boolean);for(let h=0;h<o.length;h+=1)z(o[h]);t=!1},d(f){f&&C(e),ur(o,f),n=!1,on(r)}}}function vu(i,e,t){let{cells:n}=e;function r(o){Ar.call(this,i,o)}function s(o){Ar.call(this,i,o)}return i.$$set=o=>{"cells"in o&&t(0,n=o.cells)},[n,r,s]}class mu extends rt{constructor(e){super(),nt(this,e,vu,du,He,{cells:0})}}function Ga(i,e,t){const n=i.slice();return n[10]=e[t],n[12]=t,n}function Wa(i,e,t){const n=i.slice();return n[13]=e[t],n}function Ha(i){let e,t,n=i[1],r=[];for(let s=0;s<n.length;s+=1)r[s]=Va(Wa(i,n,s));return{c(){e=ee("thead"),t=ee("tr");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=te(s,"THEAD",{});var o=G(e);t=te(o,"TR",{class:!0});var c=G(t);for(let f=0;f<r.length;f+=1)r[f].l(c);c.forEach(C),o.forEach(C),this.h()},h(){E(t,"class","sticky top-0 bg-gradient-to-t from-neutral-600 to-neutral-500 border-b border-neutral-800")},m(s,o){J(s,e,o),N(e,t);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(t,null)},p(s,o){if(o&2){n=s[1];let c;for(c=0;c<n.length;c+=1){const f=Wa(s,n,c);r[c]?r[c].p(f,o):(r[c]=Va(f),r[c].c(),r[c].m(t,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=n.length}},d(s){s&&C(e),ur(r,s)}}}function Va(i){let e,t=i[13]+"",n;return{c(){e=ee("th"),n=xe(t),this.h()},l(r){e=te(r,"TH",{class:!0});var s=G(e);n=Ue(s,t),s.forEach(C),this.h()},h(){E(e,"class","px-2 border-l border-neutral-800 text-neutral-300 text-[0.6875rem] font-medium lowercase small-caps svelte-2meyxc")},m(r,s){J(r,e,s),N(e,n)},p(r,s){s&2&&t!==(t=r[13]+"")&&yt(n,t)},d(r){r&&C(e)}}}function Ya(i){let e,t;const n=[i[10]];function r(){return i[7](i[12])}function s(){return i[8](i[12])}let o={};for(let c=0;c<n.length;c+=1)o=Ht(o,n[c]);return e=new mu({props:o}),e.$on("mouseenter",r),e.$on("mouseleave",s),{c(){ge(e.$$.fragment)},l(c){pe(e.$$.fragment,c)},m(c,f){de(e,c,f),t=!0},p(c,f){i=c;const h=f&4?fn(n,[un(i[10])]):{};e.$set(h)},i(c){t||(B(e.$$.fragment,c),t=!0)},o(c){z(e.$$.fragment,c),t=!1},d(c){ve(e,c)}}}function Qa(i){let e,t,n=i[2],r=[];for(let o=0;o<n.length;o+=1)r[o]=Ya(Ga(i,n,o));const s=o=>z(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=Ke()},l(o){for(let c=0;c<r.length;c+=1)r[c].l(o);e=Ke()},m(o,c){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(o,c);J(o,e,c),t=!0},p(o,c){if(c&52){n=o[2];let f;for(f=0;f<n.length;f+=1){const h=Ga(o,n,f);r[f]?(r[f].p(h,c),B(r[f],1)):(r[f]=Ya(h),r[f].c(),B(r[f],1),r[f].m(e.parentNode,e))}for(it(),f=n.length;f<r.length;f+=1)s(f);ot()}},i(o){if(!t){for(let c=0;c<n.length;c+=1)B(r[c]);t=!0}},o(o){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)z(r[c]);t=!1},d(o){ur(r,o),o&&C(e)}}}function bu(i){let e,t,n,r,s,o,c=i[2],f,h,p=i[3]&&Ha(i),w=Qa(i);return{c(){e=ee("label"),t=xe(i[0]),n=_e(),r=ee("table"),p&&p.c(),s=_e(),o=ee("tbody"),w.c(),this.h()},l(k){e=te(k,"LABEL",{class:!0});var O=G(e);t=Ue(O,i[0]),O.forEach(C),n=we(k),r=te(k,"TABLE",{class:!0});var W=G(r);p&&p.l(W),s=we(W),o=te(W,"TBODY",{});var I=G(o);w.l(I),I.forEach(C),W.forEach(C),this.h()},h(){E(e,"class","w-1/3 pr-2 text-xs text-neutral-400 text-right"),E(r,"class",f=i[6].class+" table-shadow w-fit my-1 bg-neutral-700 border border-neutral-800 svelte-2meyxc")},m(k,O){J(k,e,O),N(e,t),J(k,n,O),J(k,r,O),p&&p.m(r,null),N(r,s),N(r,o),w.m(o,null),h=!0},p(k,[O]){(!h||O&1)&&yt(t,k[0]),k[3]?p?p.p(k,O):(p=Ha(k),p.c(),p.m(r,s)):p&&(p.d(1),p=null),O&4&&He(c,c=k[2])?(it(),z(w,1,1,je),ot(),w=Qa(k),w.c(),B(w,1),w.m(o,null)):w.p(k,O),(!h||O&64&&f!==(f=k[6].class+" table-shadow w-fit my-1 bg-neutral-700 border border-neutral-800 svelte-2meyxc"))&&E(r,"class",f)},i(k){h||(B(w),h=!0)},o(k){z(w),h=!1},d(k){k&&C(e),k&&C(n),k&&C(r),p&&p.d(),w.d(k)}}}function _u(i,e,t){let{name:n}=e,{columns:r}=e,{rows:s}=e,{showColumns:o=!0}=e;const c=mr();function f(k){c("rowHover",k)}function h(k){c("rowLeave",k)}const p=k=>f(k),w=k=>h(k);return i.$$set=k=>{t(6,e=Ht(Ht({},e),Sr(k))),"name"in k&&t(0,n=k.name),"columns"in k&&t(1,r=k.columns),"rows"in k&&t(2,s=k.rows),"showColumns"in k&&t(3,o=k.showColumns)},e=Sr(e),[n,r,s,o,f,h,e,p,w]}class wu extends rt{constructor(e){super(),nt(this,e,_u,bu,He,{name:0,columns:1,rows:2,showColumns:3})}}function ku(i){let e,t,n,r,s,o;return{c(){e=ee("label"),t=xe(i[0]),n=xe(":"),r=_e(),s=ee("span"),o=xe(i[1]),this.h()},l(c){e=te(c,"LABEL",{class:!0});var f=G(e);t=Ue(f,i[0]),n=Ue(f,":"),f.forEach(C),r=we(c),s=te(c,"SPAN",{class:!0});var h=G(s);o=Ue(h,i[1]),h.forEach(C),this.h()},h(){E(e,"class","text-xs text-neutral-400 text-right"),E(s,"class","text-xs text-neutral-200")},m(c,f){J(c,e,f),N(e,t),N(e,n),J(c,r,f),J(c,s,f),N(s,o)},p(c,[f]){f&1&&yt(t,c[0]),f&2&&yt(o,c[1])},i:je,o:je,d(c){c&&C(e),c&&C(r),c&&C(s)}}}function $u(i,e,t){let{name:n}=e,{label:r}=e;return i.$$set=s=>{"name"in s&&t(0,n=s.name),"label"in s&&t(1,r=s.label)},[n,r]}class Wt extends rt{constructor(e){super(),nt(this,e,$u,ku,He,{name:0,label:1})}}function Xa(i){let e,t,n,r,s,o;return{c(){e=ee("div"),t=ct("svg"),n=ct("circle"),r=ct("path"),s=_e(),o=xe(i[0]),this.h()},l(c){e=te(c,"DIV",{class:!0});var f=G(e);t=ht(f,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var h=G(t);n=ht(h,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),G(n).forEach(C),r=ht(h,"path",{class:!0,fill:!0,d:!0}),G(r).forEach(C),h.forEach(C),s=we(f),o=Ue(f,i[0]),f.forEach(C),this.h()},h(){E(n,"class","opacity-25"),E(n,"cx","12"),E(n,"cy","12"),E(n,"r","10"),E(n,"stroke","currentColor"),E(n,"stroke-width","4"),E(r,"class","opacity-75"),E(r,"fill","currentColor"),E(r,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),E(t,"class","animate-spin mr-1 h-4 w-4 text-white"),E(t,"xmlns","http://www.w3.org/2000/svg"),E(t,"fill","none"),E(t,"viewBox","0 0 24 24"),E(e,"class","z-20 absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 flex items-center py-1.5 px-2 bg-neutral-900 bg-opacity-75 text-white text-xs font-medium")},m(c,f){J(c,e,f),N(e,t),N(t,n),N(t,r),N(e,s),N(e,o)},p(c,f){f&1&&yt(o,c[0])},d(c){c&&C(e)}}}function yu(i){let e,t,n,r,s,o,c,f,h,p=i[0]&&Xa(i);return{c(){e=ee("div"),t=ee("img"),r=_e(),s=ee("canvas"),o=_e(),p&&p.c(),this.h()},l(w){e=te(w,"DIV",{class:!0});var k=G(e);t=te(k,"IMG",{src:!0,class:!0}),r=we(k),s=te(k,"CANVAS",{class:!0}),G(s).forEach(C),o=we(k),p&&p.l(k),k.forEach(C),this.h()},h(){If(t.src,n=i[4])||E(t,"src",n),E(t,"class","absolute left-1/2 -translate-x-1/2 h-full object-contain"),E(s,"class","z-10 absolute left-1/2 -translate-x-1/2 h-full"),E(e,"class",c=(i[6].class??"")+" relative w-full h-full bg-white")},m(w,k){J(w,e,k),N(e,t),i[15](t),N(e,r),N(e,s),i[16](s),N(e,o),p&&p.m(e,null),i[17](e),f||(h=$t(t,"load",i[5]),f=!0)},p(w,[k]){w[0]?p?p.p(w,k):(p=Xa(w),p.c(),p.m(e,null)):p&&(p.d(1),p=null),k&64&&c!==(c=(w[6].class??"")+" relative w-full h-full bg-white")&&E(e,"class",c)},i:je,o:je,d(w){w&&C(e),i[15](null),i[16](null),p&&p.d(),i[17](null),f=!1,h()}}}function Cu(i,e,t){let{personaSide:n}=e;function r(){return W.toDataURL("image/png")}function s(){return W}function o(){return le}function c(m){t(0,k=m)}function f(){t(0,k=void 0)}function h(){Ia(oe,W,I,ne)}function p(m){const v=W.getContext("2d");if(v==null)throw"Could not get context to draw strokes.";for(let M of m){let R=M.points,j=M.brushSize;if(le!==void 0)R=_s(M.points,le),j*=le;else{const re="Could not draw strokes because the scale factor is unknown.";throw alert(re),re}bs(R,v,M.brushColor,j)}}const w=mr();let k="Loading persona...",O=ms[n],W,I=0,ne=0,le=1,oe,T;function S(){const{imgWidth:m,imgHeight:v}=Rf(oe);I=Math.ceil(m),ne=Math.ceil(v),le=I/oe.naturalWidth,Bf(W,I,ne),Ia(oe,W,I,ne),f(),w("ready",{personaSide:n,canvas:W,width:I,height:ne,imgWidth:m,imgHeight:v,scaleFactor:le})}function x(m){lt[m?"unshift":"push"](()=>{oe=m,t(2,oe)})}function L(m){lt[m?"unshift":"push"](()=>{W=m,t(1,W)})}function H(m){lt[m?"unshift":"push"](()=>{T=m,t(3,T)})}return i.$$set=m=>{t(6,e=Ht(Ht({},e),Sr(m))),"personaSide"in m&&t(7,n=m.personaSide)},e=Sr(e),[k,W,oe,T,O,S,e,n,r,s,o,c,f,h,p,x,L,H]}class sr extends rt{constructor(e){super(),nt(this,e,Cu,yu,He,{personaSide:7,getImage:8,getCanvas:9,getScaleFactor:10,setMessage:11,clearMessage:12,clear:13,drawStrokes:14})}get getImage(){return this.$$.ctx[8]}get getCanvas(){return this.$$.ctx[9]}get getScaleFactor(){return this.$$.ctx[10]}get setMessage(){return this.$$.ctx[11]}get clearMessage(){return this.$$.ctx[12]}get clear(){return this.$$.ctx[13]}get drawStrokes(){return this.$$.ctx[14]}}function Ja(i,e,t){const n=i.slice();return n[17]=e[t],n}function Za(i){let e=i[1],t,n,r=es(i);return{c(){r.c(),t=Ke()},l(s){r.l(s),t=Ke()},m(s,o){r.m(s,o),J(s,t,o),n=!0},p(s,o){o&2&&He(e,e=s[1])?(it(),z(r,1,1,je),ot(),r=es(s),r.c(),B(r,1),r.m(t.parentNode,t)):r.p(s,o)},i(s){n||(B(r),n=!0)},o(s){z(r),n=!1},d(s){s&&C(t),r.d(s)}}}function Eu(i){let e,t,n={personaSide:i[17]};return e=new sr({props:n}),i[12](e),e.$on("ready",i[8]),{c(){ge(e.$$.fragment)},l(r){pe(e.$$.fragment,r)},m(r,s){de(e,r,s),t=!0},p(r,s){const o={};s&4&&(o.personaSide=r[17]),e.$set(o)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){i[12](null),ve(e,r)}}}function Mu(i){let e,t,n={personaSide:i[17]};return e=new sr({props:n}),i[11](e),e.$on("ready",i[8]),{c(){ge(e.$$.fragment)},l(r){pe(e.$$.fragment,r)},m(r,s){de(e,r,s),t=!0},p(r,s){const o={};s&4&&(o.personaSide=r[17]),e.$set(o)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){i[11](null),ve(e,r)}}}function Ka(i){let e,t,n,r,s;const o=[Mu,Eu],c=[];function f(h,p){return p&4&&(e=null),e==null&&(e=!!h[17].includes("Front")),e?0:1}return t=f(i,-1),n=c[t]=o[t](i),{c(){n.c(),r=Ke()},l(h){n.l(h),r=Ke()},m(h,p){c[t].m(h,p),J(h,r,p),s=!0},p(h,p){let w=t;t=f(h,p),t===w?c[t].p(h,p):(it(),z(c[w],1,1,()=>{c[w]=null}),ot(),n=c[t],n?n.p(h,p):(n=c[t]=o[t](h),n.c()),B(n,1),n.m(r.parentNode,r))},i(h){s||(B(n),s=!0)},o(h){z(n),s=!1},d(h){c[t].d(h),h&&C(r)}}}function Fu(i){let e,t,n=i[2],r=[];for(let o=0;o<n.length;o+=1)r[o]=Ka(Ja(i,n,o));const s=o=>z(r[o],1,1,()=>{r[o]=null});return{c(){e=ee("div");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){e=te(o,"DIV",{class:!0});var c=G(e);for(let f=0;f<r.length;f+=1)r[f].l(c);c.forEach(C),this.h()},h(){E(e,"class","flex w-full h-full")},m(o,c){J(o,e,c);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);t=!0},p(o,c){if(c&452){n=o[2];let f;for(f=0;f<n.length;f+=1){const h=Ja(o,n,f);r[f]?(r[f].p(h,c),B(r[f],1)):(r[f]=Ka(h),r[f].c(),B(r[f],1),r[f].m(e,null))}for(it(),f=n.length;f<r.length;f+=1)s(f);ot()}},i(o){if(!t){for(let c=0;c<n.length;c+=1)B(r[c]);t=!0}},o(o){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)z(r[c]);t=!1},d(o){o&&C(e),ur(r,o)}}}function Iu(i){let e,t;return e=new cr({props:{caption:"Looking Glass",$$slots:{default:[Fu]},$$scope:{ctx:i}}}),{c(){ge(e.$$.fragment)},l(n){pe(e.$$.fragment,n)},m(n,r){de(e,n,r),t=!0},p(n,r){const s={};r&1048772&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){ve(e,n)}}}function Au(i){let e,t,n,r,s,o,c,f,h,p,w,k,O,W,I,ne;n=new cu({props:{name:"Participant",options:Object.keys(i[0].participants),selected:i[1].id}}),n.$on("change",i[9]),o=new Wt({props:{name:"Drawing area",label:`${i[1].totalDrawingArea} pixels`}}),h=new Wt({props:{name:"Avg valence",label:i[3].toString()}}),k=new Wt({props:{name:"Avg intensity",label:i[4].toString()}});const le=[{class:"block h-64 overflow-auto"},i[5]];let oe={};for(let T=0;T<le.length;T+=1)oe=Ht(oe,le[T]);return I=new wu({props:oe}),{c(){e=ee("ul"),t=ee("li"),ge(n.$$.fragment),r=_e(),s=ee("li"),ge(o.$$.fragment),c=_e(),f=ee("li"),ge(h.$$.fragment),p=_e(),w=ee("li"),ge(k.$$.fragment),O=_e(),W=ee("li"),ge(I.$$.fragment),this.h()},l(T){e=te(T,"UL",{class:!0});var S=G(e);t=te(S,"LI",{});var x=G(t);pe(n.$$.fragment,x),x.forEach(C),r=we(S),s=te(S,"LI",{});var L=G(s);pe(o.$$.fragment,L),L.forEach(C),c=we(S),f=te(S,"LI",{});var H=G(f);pe(h.$$.fragment,H),H.forEach(C),p=we(S),w=te(S,"LI",{});var m=G(w);pe(k.$$.fragment,m),m.forEach(C),O=we(S),W=te(S,"LI",{});var v=G(W);pe(I.$$.fragment,v),v.forEach(C),S.forEach(C),this.h()},h(){E(e,"class","p-2")},m(T,S){J(T,e,S),N(e,t),de(n,t,null),N(e,r),N(e,s),de(o,s,null),N(e,c),N(e,f),de(h,f,null),N(e,p),N(e,w),de(k,w,null),N(e,O),N(e,W),de(I,W,null),ne=!0},p(T,S){const x={};S&1&&(x.options=Object.keys(T[0].participants)),S&2&&(x.selected=T[1].id),n.$set(x);const L={};S&2&&(L.label=`${T[1].totalDrawingArea} pixels`),o.$set(L);const H={};S&8&&(H.label=T[3].toString()),h.$set(H);const m={};S&16&&(m.label=T[4].toString()),k.$set(m);const v=S&32?fn(le,[le[0],un(T[5])]):{};I.$set(v)},i(T){ne||(B(n.$$.fragment,T),B(o.$$.fragment,T),B(h.$$.fragment,T),B(k.$$.fragment,T),B(I.$$.fragment,T),ne=!0)},o(T){z(n.$$.fragment,T),z(o.$$.fragment,T),z(h.$$.fragment,T),z(k.$$.fragment,T),z(I.$$.fragment,T),ne=!1},d(T){T&&C(e),ve(n),ve(o),ve(h),ve(k),ve(I)}}}function Su(i){let e,t;return e=new cr({props:{tabs:["Details"],highlightTab:!1,$$slots:{default:[Au]},$$scope:{ctx:i}}}),{c(){ge(e.$$.fragment)},l(n){pe(e.$$.fragment,n)},m(n,r){de(e,n,r),t=!0},p(n,r){const s={};r&1048635&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){ve(e,n)}}}function es(i){let e,t;return e=new cn({props:{$$slots:{settings:[Su],panels:[Iu]},$$scope:{ctx:i}}}),{c(){ge(e.$$.fragment)},l(n){pe(e.$$.fragment,n)},m(n,r){de(e,n,r),t=!0},p(n,r){const s={};r&1048831&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){ve(e,n)}}}function Lu(i){let e,t,n=i[1]&&Za(i);return{c(){n&&n.c(),e=Ke()},l(r){n&&n.l(r),e=Ke()},m(r,s){n&&n.m(r,s),J(r,e,s),t=!0},p(r,[s]){r[1]?n?(n.p(r,s),s&2&&B(n,1)):(n=Za(r),n.c(),B(n,1),n.m(e.parentNode,e)):n&&(it(),z(n,1,1,()=>{n=null}),ot())},i(r){t||(B(n),t=!0)},o(r){z(n),t=!1},d(r){n&&n.d(r),r&&C(e)}}}function ts(i){const e={name:"Areas table",columns:["Valence","Intensity","Size"],rows:[]};for(const t in i.areas){const[n,r]=t.split(":");e.rows.push({cells:[{value:n},{value:r},{value:i.areas[t]}]})}return e}function rs(i,e){const t={};for(const o in i.areas){const[c,f]=o.split(":"),h=i.areas[o];e==="valence"?(t[c]??(t[c]=0),t[c]+=h):(t[f]??(t[f]=0),t[f]+=h)}let n=0;for(let o in t){const c=parseInt(o);n+=c*t[o]}const r=i.totalDrawingArea>0?n/i.totalDrawingArea:0;return Math.round(r*100)/100}function ns(i,e){const t=i.drawing[e];if(t===void 0)throw`Could not get ${e} drawing of participant ${i.id}.`;return t.strokes}function Pu(i,e,t){let{survey:n}=e,r,s,o,c,f={name:"Areas",columns:[],rows:[]},h,p,w;function k(){const T=`Participant${r.id+1}-${r.persona}`;return[{name:`LookingGlass-${T}Front.png`,dataUrl:h.getImage()},{name:`LookingGlass-${T}Back.png`,dataUrl:p.getImage()}]}function O(T){const{personaSide:S}=T.detail,x=ns(r,S);let L;S.includes("Front")?L=h:L=p,L.drawStrokes(x)}function W(T){const S=n.participants[T],x=Object.keys(S.drawing),L=[{id:S.id,drawing:S.drawing}];Promise.all([zt.getPersonaBitmaps("Female"),zt.getPersonaBitmaps("Male")]).then(([H,m])=>{w==null||w.postMessage({command:"get-areas",params:{data:L,femaleFrontBitmap:H.frontBitmap,femaleBackBitmap:H.backBitmap,maleFrontBitmap:m.frontBitmap,maleBackBitmap:m.backBitmap}},[H.frontBitmap,H.backBitmap,m.frontBitmap,m.backBitmap])}),t(1,r=S),t(2,s=x),t(3,o=0),t(4,c=0),t(5,f=ts(r))}function I({detail:T}){W(T)}async function ne(){const T=await hs(()=>import("../chunks/export.worker.e2567c66.js"),[],import.meta.url);w=new T.default,w.onmessage=S=>{if(S.data.event==="areas-done"){const x=S.data.params,L=new vr({id:r.id,drawing:r.drawing,areas:x[0].areas,totalDrawingArea:x[0].totalDrawingArea,computed:!0});n.updateParticipant(L),t(1,r=L);let H=[];s.forEach(M=>{H=H.concat(ns(r,M))});const m=rs(r,"valence"),v=rs(r,"intensity");t(3,o=m),t(4,c=v),t(5,f=ts(r))}}}Lr(async()=>{await ne(),await zt.preloadAllCanvases(),W(Object.keys(n.participants)[0])});function le(T){lt[T?"unshift":"push"](()=>{h=T,t(6,h)})}function oe(T){lt[T?"unshift":"push"](()=>{p=T,t(7,p)})}return i.$$set=T=>{"survey"in T&&t(0,n=T.survey)},[n,r,s,o,c,f,h,p,O,I,k,le,oe]}class Du extends rt{constructor(e){super(),nt(this,e,Pu,Lu,He,{survey:0,getImages:10})}get survey(){return this.$$.ctx[0]}set survey(e){this.$$set({survey:e}),gs()}get getImages(){return this.$$.ctx[10]}}var $s={exports:{}};/**
 * chroma.js - JavaScript library for color conversions
 *
 * Copyright (c) 2011-2019, Gregor Aisch
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 * derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * -------------------------------------------------------
 *
 * chroma.js includes colors from colorbrewer2.org, which are released under
 * the following license:
 *
 * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,
 * and The Pennsylvania State University.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific
 * language governing permissions and limitations under the License.
 *
 * ------------------------------------------------------
 *
 * Named colors are taken from X11 Color Names.
 * http://www.w3.org/TR/css3-color/#svg-color
 *
 * @preserve
 */(function(i,e){(function(t,n){i.exports=n()})(ps,function(){for(var t=function(a,l,u){return l===void 0&&(l=0),u===void 0&&(u=1),a<l?l:a>u?u:a},n=t,r=function(a){a._clipped=!1,a._unclipped=a.slice(0);for(var l=0;l<=3;l++)l<3?((a[l]<0||a[l]>255)&&(a._clipped=!0),a[l]=n(a[l],0,255)):l===3&&(a[l]=n(a[l],0,1));return a},s={},o=0,c=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];o<c.length;o+=1){var f=c[o];s["[object "+f+"]"]=f.toLowerCase()}var h=function(a){return s[Object.prototype.toString.call(a)]||"object"},p=h,w=function(a,l){return l===void 0&&(l=null),a.length>=3?Array.prototype.slice.call(a):p(a[0])=="object"&&l?l.split("").filter(function(u){return a[0][u]!==void 0}).map(function(u){return a[0][u]}):a[0]},k=h,O=function(a){if(a.length<2)return null;var l=a.length-1;return k(a[l])=="string"?a[l].toLowerCase():null},W=Math.PI,I={clip_rgb:r,limit:t,type:h,unpack:w,last:O,PI:W,TWOPI:W*2,PITHIRD:W/3,DEG2RAD:W/180,RAD2DEG:180/W},ne={format:{},autodetect:[]},le=I.last,oe=I.clip_rgb,T=I.type,S=ne,x=function(){for(var l=[],u=arguments.length;u--;)l[u]=arguments[u];var g=this;if(T(l[0])==="object"&&l[0].constructor&&l[0].constructor===this.constructor)return l[0];var b=le(l),_=!1;if(!b){_=!0,S.sorted||(S.autodetect=S.autodetect.sort(function(A,q){return q.p-A.p}),S.sorted=!0);for(var d=0,$=S.autodetect;d<$.length;d+=1){var y=$[d];if(b=y.test.apply(y,l),b)break}}if(S.format[b]){var F=S.format[b].apply(null,_?l:l.slice(0,-1));g._rgb=oe(F)}else throw new Error("unknown format: "+l);g._rgb.length===3&&g._rgb.push(1)};x.prototype.toString=function(){return T(this.hex)=="function"?this.hex():"["+this._rgb.join(",")+"]"};var L=x,H=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(H.Color,[null].concat(a)))};H.Color=L,H.version="2.4.2";var m=H,v=I.unpack,M=Math.max,R=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=v(a,"rgb"),g=u[0],b=u[1],_=u[2];g=g/255,b=b/255,_=_/255;var d=1-M(g,M(b,_)),$=d<1?1/(1-d):0,y=(1-g-d)*$,F=(1-b-d)*$,A=(1-_-d)*$;return[y,F,A,d]},j=R,re=I.unpack,fe=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=re(a,"cmyk");var u=a[0],g=a[1],b=a[2],_=a[3],d=a.length>4?a[4]:1;return _===1?[0,0,0,d]:[u>=1?0:255*(1-u)*(1-_),g>=1?0:255*(1-g)*(1-_),b>=1?0:255*(1-b)*(1-_),d]},Be=fe,De=m,Z=L,Oe=ne,ae=I.unpack,at=I.type,Ve=j;Z.prototype.cmyk=function(){return Ve(this._rgb)},De.cmyk=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(Z,[null].concat(a,["cmyk"])))},Oe.format.cmyk=Be,Oe.autodetect.push({p:2,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=ae(a,"cmyk"),at(a)==="array"&&a.length===4)return"cmyk"}});var Q=I.unpack,ke=I.last,U=function(a){return Math.round(a*100)/100},V=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Q(a,"hsla"),g=ke(a)||"lsa";return u[0]=U(u[0]||0),u[1]=U(u[1]*100)+"%",u[2]=U(u[2]*100)+"%",g==="hsla"||u.length>3&&u[3]<1?(u[3]=u.length>3?u[3]:1,g="hsla"):u.length=3,g+"("+u.join(",")+")"},ie=V,Le=I.unpack,ue=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=Le(a,"rgba");var u=a[0],g=a[1],b=a[2];u/=255,g/=255,b/=255;var _=Math.min(u,g,b),d=Math.max(u,g,b),$=(d+_)/2,y,F;return d===_?(y=0,F=Number.NaN):y=$<.5?(d-_)/(d+_):(d-_)/(2-d-_),u==d?F=(g-b)/(d-_):g==d?F=2+(b-u)/(d-_):b==d&&(F=4+(u-g)/(d-_)),F*=60,F<0&&(F+=360),a.length>3&&a[3]!==void 0?[F,y,$,a[3]]:[F,y,$]},K=ue,$e=I.unpack,Me=I.last,qe=ie,Re=K,Ye=Math.round,Ge=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=$e(a,"rgba"),g=Me(a)||"rgb";return g.substr(0,3)=="hsl"?qe(Re(u),g):(u[0]=Ye(u[0]),u[1]=Ye(u[1]),u[2]=Ye(u[2]),(g==="rgba"||u.length>3&&u[3]<1)&&(u[3]=u.length>3?u[3]:1,g="rgba"),g+"("+u.slice(0,g==="rgb"?3:4).join(",")+")")},Te=Ge,vt=I.unpack,st=Math.round,_t=function(){for(var a,l=[],u=arguments.length;u--;)l[u]=arguments[u];l=vt(l,"hsl");var g=l[0],b=l[1],_=l[2],d,$,y;if(b===0)d=$=y=_*255;else{var F=[0,0,0],A=[0,0,0],q=_<.5?_*(1+b):_+b-_*b,P=2*_-q,X=g/360;F[0]=X+1/3,F[1]=X,F[2]=X-1/3;for(var Y=0;Y<3;Y++)F[Y]<0&&(F[Y]+=1),F[Y]>1&&(F[Y]-=1),6*F[Y]<1?A[Y]=P+(q-P)*6*F[Y]:2*F[Y]<1?A[Y]=q:3*F[Y]<2?A[Y]=P+(q-P)*(2/3-F[Y])*6:A[Y]=P;a=[st(A[0]*255),st(A[1]*255),st(A[2]*255)],d=a[0],$=a[1],y=a[2]}return l.length>3?[d,$,y,l[3]]:[d,$,y,1]},wt=_t,ft=wt,Ne=ne,We=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,At=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,Ie=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,Pt=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,kt=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,St=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Ct=Math.round,Et=function(a){a=a.toLowerCase().trim();var l;if(Ne.format.named)try{return Ne.format.named(a)}catch{}if(l=a.match(We)){for(var u=l.slice(1,4),g=0;g<3;g++)u[g]=+u[g];return u[3]=1,u}if(l=a.match(At)){for(var b=l.slice(1,5),_=0;_<4;_++)b[_]=+b[_];return b}if(l=a.match(Ie)){for(var d=l.slice(1,4),$=0;$<3;$++)d[$]=Ct(d[$]*2.55);return d[3]=1,d}if(l=a.match(Pt)){for(var y=l.slice(1,5),F=0;F<3;F++)y[F]=Ct(y[F]*2.55);return y[3]=+y[3],y}if(l=a.match(kt)){var A=l.slice(1,4);A[1]*=.01,A[2]*=.01;var q=ft(A);return q[3]=1,q}if(l=a.match(St)){var P=l.slice(1,4);P[1]*=.01,P[2]*=.01;var X=ft(P);return X[3]=+l[4],X}};Et.test=function(a){return We.test(a)||At.test(a)||Ie.test(a)||Pt.test(a)||kt.test(a)||St.test(a)};var Lt=Et,gt=m,Ut=L,ut=ne,br=I.type,hr=Te,hn=Lt;Ut.prototype.css=function(a){return hr(this._rgb,a)},gt.css=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(Ut,[null].concat(a,["css"])))},ut.format.css=hn,ut.autodetect.push({p:5,test:function(a){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];if(!l.length&&br(a)==="string"&&hn.test(a))return"css"}});var gn=L,ys=m,Cs=ne,Es=I.unpack;Cs.format.gl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Es(a,"rgba");return u[0]*=255,u[1]*=255,u[2]*=255,u},ys.gl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(gn,[null].concat(a,["gl"])))},gn.prototype.gl=function(){var a=this._rgb;return[a[0]/255,a[1]/255,a[2]/255,a[3]]};var Ms=I.unpack,Fs=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Ms(a,"rgb"),g=u[0],b=u[1],_=u[2],d=Math.min(g,b,_),$=Math.max(g,b,_),y=$-d,F=y*100/255,A=d/(255-y)*100,q;return y===0?q=Number.NaN:(g===$&&(q=(b-_)/y),b===$&&(q=2+(_-g)/y),_===$&&(q=4+(g-b)/y),q*=60,q<0&&(q+=360)),[q,F,A]},Is=Fs,As=I.unpack,Ss=Math.floor,Ls=function(){for(var a,l,u,g,b,_,d=[],$=arguments.length;$--;)d[$]=arguments[$];d=As(d,"hcg");var y=d[0],F=d[1],A=d[2],q,P,X;A=A*255;var Y=F*255;if(F===0)q=P=X=A;else{y===360&&(y=0),y>360&&(y-=360),y<0&&(y+=360),y/=60;var ce=Ss(y),be=y-ce,Ce=A*(1-F),Fe=Ce+Y*(1-be),et=Ce+Y*be,Ze=Ce+Y;switch(ce){case 0:a=[Ze,et,Ce],q=a[0],P=a[1],X=a[2];break;case 1:l=[Fe,Ze,Ce],q=l[0],P=l[1],X=l[2];break;case 2:u=[Ce,Ze,et],q=u[0],P=u[1],X=u[2];break;case 3:g=[Ce,Fe,Ze],q=g[0],P=g[1],X=g[2];break;case 4:b=[et,Ce,Ze],q=b[0],P=b[1],X=b[2];break;case 5:_=[Ze,Ce,Fe],q=_[0],P=_[1],X=_[2];break}}return[q,P,X,d.length>3?d[3]:1]},Ps=Ls,Ds=I.unpack,Rs=I.type,Bs=m,pn=L,dn=ne,Os=Is;pn.prototype.hcg=function(){return Os(this._rgb)},Bs.hcg=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(pn,[null].concat(a,["hcg"])))},dn.format.hcg=Ps,dn.autodetect.push({p:1,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=Ds(a,"hcg"),Rs(a)==="array"&&a.length===3)return"hcg"}});var Ts=I.unpack,Ns=I.last,_r=Math.round,zs=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Ts(a,"rgba"),g=u[0],b=u[1],_=u[2],d=u[3],$=Ns(a)||"auto";d===void 0&&(d=1),$==="auto"&&($=d<1?"rgba":"rgb"),g=_r(g),b=_r(b),_=_r(_);var y=g<<16|b<<8|_,F="000000"+y.toString(16);F=F.substr(F.length-6);var A="0"+_r(d*255).toString(16);switch(A=A.substr(A.length-2),$.toLowerCase()){case"rgba":return"#"+F+A;case"argb":return"#"+A+F;default:return"#"+F}},vn=zs,xs=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,Us=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,js=function(a){if(a.match(xs)){(a.length===4||a.length===7)&&(a=a.substr(1)),a.length===3&&(a=a.split(""),a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]);var l=parseInt(a,16),u=l>>16,g=l>>8&255,b=l&255;return[u,g,b,1]}if(a.match(Us)){(a.length===5||a.length===9)&&(a=a.substr(1)),a.length===4&&(a=a.split(""),a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]+a[3]+a[3]);var _=parseInt(a,16),d=_>>24&255,$=_>>16&255,y=_>>8&255,F=Math.round((_&255)/255*100)/100;return[d,$,y,F]}throw new Error("unknown hex color: "+a)},mn=js,qs=m,bn=L,Gs=I.type,_n=ne,Ws=vn;bn.prototype.hex=function(a){return Ws(this._rgb,a)},qs.hex=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(bn,[null].concat(a,["hex"])))},_n.format.hex=mn,_n.autodetect.push({p:4,test:function(a){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];if(!l.length&&Gs(a)==="string"&&[3,4,5,6,7,8,9].indexOf(a.length)>=0)return"hex"}});var Hs=I.unpack,wn=I.TWOPI,Vs=Math.min,Ys=Math.sqrt,Qs=Math.acos,Xs=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Hs(a,"rgb"),g=u[0],b=u[1],_=u[2];g/=255,b/=255,_/=255;var d,$=Vs(g,b,_),y=(g+b+_)/3,F=y>0?1-$/y:0;return F===0?d=NaN:(d=(g-b+(g-_))/2,d/=Ys((g-b)*(g-b)+(g-_)*(b-_)),d=Qs(d),_>b&&(d=wn-d),d/=wn),[d*360,F,y]},Js=Xs,Zs=I.unpack,Pr=I.limit,Vt=I.TWOPI,Dr=I.PITHIRD,Yt=Math.cos,Ks=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=Zs(a,"hsi");var u=a[0],g=a[1],b=a[2],_,d,$;return isNaN(u)&&(u=0),isNaN(g)&&(g=0),u>360&&(u-=360),u<0&&(u+=360),u/=360,u<1/3?($=(1-g)/3,_=(1+g*Yt(Vt*u)/Yt(Dr-Vt*u))/3,d=1-($+_)):u<2/3?(u-=1/3,_=(1-g)/3,d=(1+g*Yt(Vt*u)/Yt(Dr-Vt*u))/3,$=1-(_+d)):(u-=2/3,d=(1-g)/3,$=(1+g*Yt(Vt*u)/Yt(Dr-Vt*u))/3,_=1-(d+$)),_=Pr(b*_*3),d=Pr(b*d*3),$=Pr(b*$*3),[_*255,d*255,$*255,a.length>3?a[3]:1]},el=Ks,tl=I.unpack,rl=I.type,nl=m,kn=L,$n=ne,al=Js;kn.prototype.hsi=function(){return al(this._rgb)},nl.hsi=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(kn,[null].concat(a,["hsi"])))},$n.format.hsi=el,$n.autodetect.push({p:2,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=tl(a,"hsi"),rl(a)==="array"&&a.length===3)return"hsi"}});var sl=I.unpack,ll=I.type,il=m,yn=L,Cn=ne,ol=K;yn.prototype.hsl=function(){return ol(this._rgb)},il.hsl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(yn,[null].concat(a,["hsl"])))},Cn.format.hsl=wt,Cn.autodetect.push({p:2,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=sl(a,"hsl"),ll(a)==="array"&&a.length===3)return"hsl"}});var fl=I.unpack,ul=Math.min,cl=Math.max,hl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=fl(a,"rgb");var u=a[0],g=a[1],b=a[2],_=ul(u,g,b),d=cl(u,g,b),$=d-_,y,F,A;return A=d/255,d===0?(y=Number.NaN,F=0):(F=$/d,u===d&&(y=(g-b)/$),g===d&&(y=2+(b-u)/$),b===d&&(y=4+(u-g)/$),y*=60,y<0&&(y+=360)),[y,F,A]},gl=hl,pl=I.unpack,dl=Math.floor,vl=function(){for(var a,l,u,g,b,_,d=[],$=arguments.length;$--;)d[$]=arguments[$];d=pl(d,"hsv");var y=d[0],F=d[1],A=d[2],q,P,X;if(A*=255,F===0)q=P=X=A;else{y===360&&(y=0),y>360&&(y-=360),y<0&&(y+=360),y/=60;var Y=dl(y),ce=y-Y,be=A*(1-F),Ce=A*(1-F*ce),Fe=A*(1-F*(1-ce));switch(Y){case 0:a=[A,Fe,be],q=a[0],P=a[1],X=a[2];break;case 1:l=[Ce,A,be],q=l[0],P=l[1],X=l[2];break;case 2:u=[be,A,Fe],q=u[0],P=u[1],X=u[2];break;case 3:g=[be,Ce,A],q=g[0],P=g[1],X=g[2];break;case 4:b=[Fe,be,A],q=b[0],P=b[1],X=b[2];break;case 5:_=[A,be,Ce],q=_[0],P=_[1],X=_[2];break}}return[q,P,X,d.length>3?d[3]:1]},ml=vl,bl=I.unpack,_l=I.type,wl=m,En=L,Mn=ne,kl=gl;En.prototype.hsv=function(){return kl(this._rgb)},wl.hsv=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(En,[null].concat(a,["hsv"])))},Mn.format.hsv=ml,Mn.autodetect.push({p:2,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=bl(a,"hsv"),_l(a)==="array"&&a.length===3)return"hsv"}});var wr={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},Qt=wr,$l=I.unpack,Fn=Math.pow,yl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=$l(a,"rgb"),g=u[0],b=u[1],_=u[2],d=Cl(g,b,_),$=d[0],y=d[1],F=d[2],A=116*y-16;return[A<0?0:A,500*($-y),200*(y-F)]},Rr=function(a){return(a/=255)<=.04045?a/12.92:Fn((a+.055)/1.055,2.4)},Br=function(a){return a>Qt.t3?Fn(a,1/3):a/Qt.t2+Qt.t0},Cl=function(a,l,u){a=Rr(a),l=Rr(l),u=Rr(u);var g=Br((.4124564*a+.3575761*l+.1804375*u)/Qt.Xn),b=Br((.2126729*a+.7151522*l+.072175*u)/Qt.Yn),_=Br((.0193339*a+.119192*l+.9503041*u)/Qt.Zn);return[g,b,_]},In=yl,Xt=wr,El=I.unpack,Ml=Math.pow,Fl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=El(a,"lab");var u=a[0],g=a[1],b=a[2],_,d,$,y,F,A;return d=(u+16)/116,_=isNaN(g)?d:d+g/500,$=isNaN(b)?d:d-b/200,d=Xt.Yn*Tr(d),_=Xt.Xn*Tr(_),$=Xt.Zn*Tr($),y=Or(3.2404542*_-1.5371385*d-.4985314*$),F=Or(-.969266*_+1.8760108*d+.041556*$),A=Or(.0556434*_-.2040259*d+1.0572252*$),[y,F,A,a.length>3?a[3]:1]},Or=function(a){return 255*(a<=.00304?12.92*a:1.055*Ml(a,1/2.4)-.055)},Tr=function(a){return a>Xt.t1?a*a*a:Xt.t2*(a-Xt.t0)},An=Fl,Il=I.unpack,Al=I.type,Sl=m,Sn=L,Ln=ne,Ll=In;Sn.prototype.lab=function(){return Ll(this._rgb)},Sl.lab=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(Sn,[null].concat(a,["lab"])))},Ln.format.lab=An,Ln.autodetect.push({p:2,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=Il(a,"lab"),Al(a)==="array"&&a.length===3)return"lab"}});var Pl=I.unpack,Dl=I.RAD2DEG,Rl=Math.sqrt,Bl=Math.atan2,Ol=Math.round,Tl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Pl(a,"lab"),g=u[0],b=u[1],_=u[2],d=Rl(b*b+_*_),$=(Bl(_,b)*Dl+360)%360;return Ol(d*1e4)===0&&($=Number.NaN),[g,d,$]},Pn=Tl,Nl=I.unpack,zl=In,xl=Pn,Ul=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Nl(a,"rgb"),g=u[0],b=u[1],_=u[2],d=zl(g,b,_),$=d[0],y=d[1],F=d[2];return xl($,y,F)},jl=Ul,ql=I.unpack,Gl=I.DEG2RAD,Wl=Math.sin,Hl=Math.cos,Vl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=ql(a,"lch"),g=u[0],b=u[1],_=u[2];return isNaN(_)&&(_=0),_=_*Gl,[g,Hl(_)*b,Wl(_)*b]},Dn=Vl,Yl=I.unpack,Ql=Dn,Xl=An,Jl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=Yl(a,"lch");var u=a[0],g=a[1],b=a[2],_=Ql(u,g,b),d=_[0],$=_[1],y=_[2],F=Xl(d,$,y),A=F[0],q=F[1],P=F[2];return[A,q,P,a.length>3?a[3]:1]},Rn=Jl,Zl=I.unpack,Kl=Rn,ei=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Zl(a,"hcl").reverse();return Kl.apply(void 0,u)},ti=ei,ri=I.unpack,ni=I.type,Bn=m,kr=L,Nr=ne,On=jl;kr.prototype.lch=function(){return On(this._rgb)},kr.prototype.hcl=function(){return On(this._rgb).reverse()},Bn.lch=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(kr,[null].concat(a,["lch"])))},Bn.hcl=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(kr,[null].concat(a,["hcl"])))},Nr.format.lch=Rn,Nr.format.hcl=ti,["lch","hcl"].forEach(function(a){return Nr.autodetect.push({p:2,test:function(){for(var l=[],u=arguments.length;u--;)l[u]=arguments[u];if(l=ri(l,a),ni(l)==="array"&&l.length===3)return a}})});var ai={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Tn=ai,si=L,Nn=ne,li=I.type,gr=Tn,ii=mn,oi=vn;si.prototype.name=function(){for(var a=oi(this._rgb,"rgb"),l=0,u=Object.keys(gr);l<u.length;l+=1){var g=u[l];if(gr[g]===a)return g.toLowerCase()}return a},Nn.format.named=function(a){if(a=a.toLowerCase(),gr[a])return ii(gr[a]);throw new Error("unknown color name: "+a)},Nn.autodetect.push({p:5,test:function(a){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];if(!l.length&&li(a)==="string"&&gr[a.toLowerCase()])return"named"}});var fi=I.unpack,ui=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=fi(a,"rgb"),g=u[0],b=u[1],_=u[2];return(g<<16)+(b<<8)+_},ci=ui,hi=I.type,gi=function(a){if(hi(a)=="number"&&a>=0&&a<=16777215){var l=a>>16,u=a>>8&255,g=a&255;return[l,u,g,1]}throw new Error("unknown num color: "+a)},pi=gi,di=m,zn=L,xn=ne,vi=I.type,mi=ci;zn.prototype.num=function(){return mi(this._rgb)},di.num=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(zn,[null].concat(a,["num"])))},xn.format.num=pi,xn.autodetect.push({p:5,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a.length===1&&vi(a[0])==="number"&&a[0]>=0&&a[0]<=16777215)return"num"}});var bi=m,zr=L,Un=ne,jn=I.unpack,qn=I.type,Gn=Math.round;zr.prototype.rgb=function(a){return a===void 0&&(a=!0),a===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Gn)},zr.prototype.rgba=function(a){return a===void 0&&(a=!0),this._rgb.slice(0,4).map(function(l,u){return u<3?a===!1?l:Gn(l):l})},bi.rgb=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(zr,[null].concat(a,["rgb"])))},Un.format.rgb=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=jn(a,"rgba");return u[3]===void 0&&(u[3]=1),u},Un.autodetect.push({p:3,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=jn(a,"rgba"),qn(a)==="array"&&(a.length===3||a.length===4&&qn(a[3])=="number"&&a[3]>=0&&a[3]<=1))return"rgb"}});var $r=Math.log,_i=function(a){var l=a/100,u,g,b;return l<66?(u=255,g=l<6?0:-155.25485562709179-.44596950469579133*(g=l-2)+104.49216199393888*$r(g),b=l<20?0:-254.76935184120902+.8274096064007395*(b=l-10)+115.67994401066147*$r(b)):(u=351.97690566805693+.114206453784165*(u=l-55)-40.25366309332127*$r(u),g=325.4494125711974+.07943456536662342*(g=l-50)-28.0852963507957*$r(g),b=255),[u,g,b,1]},Wn=_i,wi=Wn,ki=I.unpack,$i=Math.round,yi=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];for(var u=ki(a,"rgb"),g=u[0],b=u[2],_=1e3,d=4e4,$=.4,y;d-_>$;){y=(d+_)*.5;var F=wi(y);F[2]/F[0]>=b/g?d=y:_=y}return $i(y)},Ci=yi,xr=m,yr=L,Ur=ne,Ei=Ci;yr.prototype.temp=yr.prototype.kelvin=yr.prototype.temperature=function(){return Ei(this._rgb)},xr.temp=xr.kelvin=xr.temperature=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(yr,[null].concat(a,["temp"])))},Ur.format.temp=Ur.format.kelvin=Ur.format.temperature=Wn;var Mi=I.unpack,jr=Math.cbrt,Fi=Math.pow,Ii=Math.sign,Ai=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Mi(a,"rgb"),g=u[0],b=u[1],_=u[2],d=[qr(g/255),qr(b/255),qr(_/255)],$=d[0],y=d[1],F=d[2],A=jr(.4122214708*$+.5363325363*y+.0514459929*F),q=jr(.2119034982*$+.6806995451*y+.1073969566*F),P=jr(.0883024619*$+.2817188376*y+.6299787005*F);return[.2104542553*A+.793617785*q-.0040720468*P,1.9779984951*A-2.428592205*q+.4505937099*P,.0259040371*A+.7827717662*q-.808675766*P]},Hn=Ai;function qr(a){var l=Math.abs(a);return l<.04045?a/12.92:(Ii(a)||1)*Fi((l+.055)/1.055,2.4)}var Si=I.unpack,Cr=Math.pow,Li=Math.sign,Pi=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=Si(a,"lab");var u=a[0],g=a[1],b=a[2],_=Cr(u+.3963377774*g+.2158037573*b,3),d=Cr(u-.1055613458*g-.0638541728*b,3),$=Cr(u-.0894841775*g-1.291485548*b,3);return[255*Gr(4.0767416621*_-3.3077115913*d+.2309699292*$),255*Gr(-1.2684380046*_+2.6097574011*d-.3413193965*$),255*Gr(-.0041960863*_-.7034186147*d+1.707614701*$),a.length>3?a[3]:1]},Vn=Pi;function Gr(a){var l=Math.abs(a);return l>.0031308?(Li(a)||1)*(1.055*Cr(l,1/2.4)-.055):a*12.92}var Di=I.unpack,Ri=I.type,Bi=m,Yn=L,Qn=ne,Oi=Hn;Yn.prototype.oklab=function(){return Oi(this._rgb)},Bi.oklab=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(Yn,[null].concat(a,["oklab"])))},Qn.format.oklab=Vn,Qn.autodetect.push({p:3,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=Di(a,"oklab"),Ri(a)==="array"&&a.length===3)return"oklab"}});var Ti=I.unpack,Ni=Hn,zi=Pn,xi=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=Ti(a,"rgb"),g=u[0],b=u[1],_=u[2],d=Ni(g,b,_),$=d[0],y=d[1],F=d[2];return zi($,y,F)},Ui=xi,ji=I.unpack,qi=Dn,Gi=Vn,Wi=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];a=ji(a,"lch");var u=a[0],g=a[1],b=a[2],_=qi(u,g,b),d=_[0],$=_[1],y=_[2],F=Gi(d,$,y),A=F[0],q=F[1],P=F[2];return[A,q,P,a.length>3?a[3]:1]},Hi=Wi,Vi=I.unpack,Yi=I.type,Qi=m,Xn=L,Jn=ne,Xi=Ui;Xn.prototype.oklch=function(){return Xi(this._rgb)},Qi.oklch=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return new(Function.prototype.bind.apply(Xn,[null].concat(a,["oklch"])))},Jn.format.oklch=Hi,Jn.autodetect.push({p:3,test:function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];if(a=Vi(a,"oklch"),Yi(a)==="array"&&a.length===3)return"oklch"}});var Zn=L,Ji=I.type;Zn.prototype.alpha=function(a,l){return l===void 0&&(l=!1),a!==void 0&&Ji(a)==="number"?l?(this._rgb[3]=a,this):new Zn([this._rgb[0],this._rgb[1],this._rgb[2],a],"rgb"):this._rgb[3]};var Zi=L;Zi.prototype.clipped=function(){return this._rgb._clipped||!1};var jt=L,Ki=wr;jt.prototype.darken=function(a){a===void 0&&(a=1);var l=this,u=l.lab();return u[0]-=Ki.Kn*a,new jt(u,"lab").alpha(l.alpha(),!0)},jt.prototype.brighten=function(a){return a===void 0&&(a=1),this.darken(-a)},jt.prototype.darker=jt.prototype.darken,jt.prototype.brighter=jt.prototype.brighten;var eo=L;eo.prototype.get=function(a){var l=a.split("."),u=l[0],g=l[1],b=this[u]();if(g){var _=u.indexOf(g)-(u.substr(0,2)==="ok"?2:0);if(_>-1)return b[_];throw new Error("unknown channel "+g+" in mode "+u)}else return b};var Jt=L,to=I.type,ro=Math.pow,no=1e-7,ao=20;Jt.prototype.luminance=function(a){if(a!==void 0&&to(a)==="number"){if(a===0)return new Jt([0,0,0,this._rgb[3]],"rgb");if(a===1)return new Jt([255,255,255,this._rgb[3]],"rgb");var l=this.luminance(),u="rgb",g=ao,b=function(d,$){var y=d.interpolate($,.5,u),F=y.luminance();return Math.abs(a-F)<no||!g--?y:F>a?b(d,y):b(y,$)},_=(l>a?b(new Jt([0,0,0]),this):b(this,new Jt([255,255,255]))).rgb();return new Jt(_.concat([this._rgb[3]]))}return so.apply(void 0,this._rgb.slice(0,3))};var so=function(a,l,u){return a=Wr(a),l=Wr(l),u=Wr(u),.2126*a+.7152*l+.0722*u},Wr=function(a){return a/=255,a<=.03928?a/12.92:ro((a+.055)/1.055,2.4)},mt={},Kn=L,ea=I.type,Er=mt,ta=function(a,l,u){u===void 0&&(u=.5);for(var g=[],b=arguments.length-3;b-- >0;)g[b]=arguments[b+3];var _=g[0]||"lrgb";if(!Er[_]&&!g.length&&(_=Object.keys(Er)[0]),!Er[_])throw new Error("interpolation mode "+_+" is not defined");return ea(a)!=="object"&&(a=new Kn(a)),ea(l)!=="object"&&(l=new Kn(l)),Er[_](a,l,u).alpha(a.alpha()+u*(l.alpha()-a.alpha()))},ra=L,lo=ta;ra.prototype.mix=ra.prototype.interpolate=function(a,l){l===void 0&&(l=.5);for(var u=[],g=arguments.length-2;g-- >0;)u[g]=arguments[g+2];return lo.apply(void 0,[this,a,l].concat(u))};var na=L;na.prototype.premultiply=function(a){a===void 0&&(a=!1);var l=this._rgb,u=l[3];return a?(this._rgb=[l[0]*u,l[1]*u,l[2]*u,u],this):new na([l[0]*u,l[1]*u,l[2]*u,u],"rgb")};var Hr=L,io=wr;Hr.prototype.saturate=function(a){a===void 0&&(a=1);var l=this,u=l.lch();return u[1]+=io.Kn*a,u[1]<0&&(u[1]=0),new Hr(u,"lch").alpha(l.alpha(),!0)},Hr.prototype.desaturate=function(a){return a===void 0&&(a=1),this.saturate(-a)};var aa=L,sa=I.type;aa.prototype.set=function(a,l,u){u===void 0&&(u=!1);var g=a.split("."),b=g[0],_=g[1],d=this[b]();if(_){var $=b.indexOf(_)-(b.substr(0,2)==="ok"?2:0);if($>-1){if(sa(l)=="string")switch(l.charAt(0)){case"+":d[$]+=+l;break;case"-":d[$]+=+l;break;case"*":d[$]*=+l.substr(1);break;case"/":d[$]/=+l.substr(1);break;default:d[$]=+l}else if(sa(l)==="number")d[$]=l;else throw new Error("unsupported value for Color.set");var y=new aa(d,b);return u?(this._rgb=y._rgb,this):y}throw new Error("unknown channel "+_+" in mode "+b)}else return d};var oo=L,fo=function(a,l,u){var g=a._rgb,b=l._rgb;return new oo(g[0]+u*(b[0]-g[0]),g[1]+u*(b[1]-g[1]),g[2]+u*(b[2]-g[2]),"rgb")};mt.rgb=fo;var uo=L,Vr=Math.sqrt,Zt=Math.pow,co=function(a,l,u){var g=a._rgb,b=g[0],_=g[1],d=g[2],$=l._rgb,y=$[0],F=$[1],A=$[2];return new uo(Vr(Zt(b,2)*(1-u)+Zt(y,2)*u),Vr(Zt(_,2)*(1-u)+Zt(F,2)*u),Vr(Zt(d,2)*(1-u)+Zt(A,2)*u),"rgb")};mt.lrgb=co;var ho=L,go=function(a,l,u){var g=a.lab(),b=l.lab();return new ho(g[0]+u*(b[0]-g[0]),g[1]+u*(b[1]-g[1]),g[2]+u*(b[2]-g[2]),"lab")};mt.lab=go;var la=L,Kt=function(a,l,u,g){var b,_,d,$;g==="hsl"?(d=a.hsl(),$=l.hsl()):g==="hsv"?(d=a.hsv(),$=l.hsv()):g==="hcg"?(d=a.hcg(),$=l.hcg()):g==="hsi"?(d=a.hsi(),$=l.hsi()):g==="lch"||g==="hcl"?(g="hcl",d=a.hcl(),$=l.hcl()):g==="oklch"&&(d=a.oklch().reverse(),$=l.oklch().reverse());var y,F,A,q,P,X;(g.substr(0,1)==="h"||g==="oklch")&&(b=d,y=b[0],A=b[1],P=b[2],_=$,F=_[0],q=_[1],X=_[2]);var Y,ce,be,Ce;return!isNaN(y)&&!isNaN(F)?(F>y&&F-y>180?Ce=F-(y+360):F<y&&y-F>180?Ce=F+360-y:Ce=F-y,ce=y+u*Ce):isNaN(y)?isNaN(F)?ce=Number.NaN:(ce=F,(P==1||P==0)&&g!="hsv"&&(Y=q)):(ce=y,(X==1||X==0)&&g!="hsv"&&(Y=A)),Y===void 0&&(Y=A+u*(q-A)),be=P+u*(X-P),g==="oklch"?new la([be,Y,ce],g):new la([ce,Y,be],g)},po=Kt,ia=function(a,l,u){return po(a,l,u,"lch")};mt.lch=ia,mt.hcl=ia;var vo=L,mo=function(a,l,u){var g=a.num(),b=l.num();return new vo(g+u*(b-g),"num")};mt.num=mo;var bo=Kt,_o=function(a,l,u){return bo(a,l,u,"hcg")};mt.hcg=_o;var wo=Kt,ko=function(a,l,u){return wo(a,l,u,"hsi")};mt.hsi=ko;var $o=Kt,yo=function(a,l,u){return $o(a,l,u,"hsl")};mt.hsl=yo;var Co=Kt,Eo=function(a,l,u){return Co(a,l,u,"hsv")};mt.hsv=Eo;var Mo=L,Fo=function(a,l,u){var g=a.oklab(),b=l.oklab();return new Mo(g[0]+u*(b[0]-g[0]),g[1]+u*(b[1]-g[1]),g[2]+u*(b[2]-g[2]),"oklab")};mt.oklab=Fo;var Io=Kt,Ao=function(a,l,u){return Io(a,l,u,"oklch")};mt.oklch=Ao;var Yr=L,So=I.clip_rgb,Qr=Math.pow,Xr=Math.sqrt,Jr=Math.PI,oa=Math.cos,fa=Math.sin,Lo=Math.atan2,Po=function(a,l,u){l===void 0&&(l="lrgb"),u===void 0&&(u=null);var g=a.length;u||(u=Array.from(new Array(g)).map(function(){return 1}));var b=g/u.reduce(function(ce,be){return ce+be});if(u.forEach(function(ce,be){u[be]*=b}),a=a.map(function(ce){return new Yr(ce)}),l==="lrgb")return Do(a,u);for(var _=a.shift(),d=_.get(l),$=[],y=0,F=0,A=0;A<d.length;A++)if(d[A]=(d[A]||0)*u[0],$.push(isNaN(d[A])?0:u[0]),l.charAt(A)==="h"&&!isNaN(d[A])){var q=d[A]/180*Jr;y+=oa(q)*u[0],F+=fa(q)*u[0]}var P=_.alpha()*u[0];a.forEach(function(ce,be){var Ce=ce.get(l);P+=ce.alpha()*u[be+1];for(var Fe=0;Fe<d.length;Fe++)if(!isNaN(Ce[Fe]))if($[Fe]+=u[be+1],l.charAt(Fe)==="h"){var et=Ce[Fe]/180*Jr;y+=oa(et)*u[be+1],F+=fa(et)*u[be+1]}else d[Fe]+=Ce[Fe]*u[be+1]});for(var X=0;X<d.length;X++)if(l.charAt(X)==="h"){for(var Y=Lo(F/$[X],y/$[X])/Jr*180;Y<0;)Y+=360;for(;Y>=360;)Y-=360;d[X]=Y}else d[X]=d[X]/$[X];return P/=g,new Yr(d,l).alpha(P>.99999?1:P,!0)},Do=function(a,l){for(var u=a.length,g=[0,0,0,0],b=0;b<a.length;b++){var _=a[b],d=l[b]/u,$=_._rgb;g[0]+=Qr($[0],2)*d,g[1]+=Qr($[1],2)*d,g[2]+=Qr($[2],2)*d,g[3]+=$[3]*d}return g[0]=Xr(g[0]),g[1]=Xr(g[1]),g[2]=Xr(g[2]),g[3]>.9999999&&(g[3]=1),new Yr(So(g))},Mt=m,er=I.type,Ro=Math.pow,Zr=function(a){var l="rgb",u=Mt("#ccc"),g=0,b=[0,1],_=[],d=[0,0],$=!1,y=[],F=!1,A=0,q=1,P=!1,X={},Y=!0,ce=1,be=function(D){if(D=D||["#fff","#000"],D&&er(D)==="string"&&Mt.brewer&&Mt.brewer[D.toLowerCase()]&&(D=Mt.brewer[D.toLowerCase()]),er(D)==="array"){D.length===1&&(D=[D[0],D[0]]),D=D.slice(0);for(var se=0;se<D.length;se++)D[se]=Mt(D[se]);_.length=0;for(var me=0;me<D.length;me++)_.push(me/(D.length-1))}return pt(),y=D},Ce=function(D){if($!=null){for(var se=$.length-1,me=0;me<se&&D>=$[me];)me++;return me-1}return 0},Fe=function(D){return D},et=function(D){return D},Ze=function(D,se){var me,he;if(se==null&&(se=!1),isNaN(D)||D===null)return u;if(se)he=D;else if($&&$.length>2){var tt=Ce(D);he=tt/($.length-2)}else q!==A?he=(D-A)/(q-A):he=1;he=et(he),se||(he=Fe(he)),ce!==1&&(he=Ro(he,ce)),he=d[0]+he*(1-d[0]-d[1]),he=Math.min(1,Math.max(0,he));var ze=Math.floor(he*1e4);if(Y&&X[ze])me=X[ze];else{if(er(y)==="array")for(var Ee=0;Ee<_.length;Ee++){var Ae=_[Ee];if(he<=Ae){me=y[Ee];break}if(he>=Ae&&Ee===_.length-1){me=y[Ee];break}if(he>Ae&&he<_[Ee+1]){he=(he-Ae)/(_[Ee+1]-Ae),me=Mt.interpolate(y[Ee],y[Ee+1],he,l);break}}else er(y)==="function"&&(me=y(he));Y&&(X[ze]=me)}return me},pt=function(){return X={}};be(a);var ye=function(D){var se=Mt(Ze(D));return F&&se[F]?se[F]():se};return ye.classes=function(D){if(D!=null){if(er(D)==="array")$=D,b=[D[0],D[D.length-1]];else{var se=Mt.analyze(b);D===0?$=[se.min,se.max]:$=Mt.limits(se,"e",D)}return ye}return $},ye.domain=function(D){if(!arguments.length)return b;A=D[0],q=D[D.length-1],_=[];var se=y.length;if(D.length===se&&A!==q)for(var me=0,he=Array.from(D);me<he.length;me+=1){var tt=he[me];_.push((tt-A)/(q-A))}else{for(var ze=0;ze<se;ze++)_.push(ze/(se-1));if(D.length>2){var Ee=D.map(function(Se,Pe){return Pe/(D.length-1)}),Ae=D.map(function(Se){return(Se-A)/(q-A)});Ae.every(function(Se,Pe){return Ee[Pe]===Se})||(et=function(Se){if(Se<=0||Se>=1)return Se;for(var Pe=0;Se>=Ae[Pe+1];)Pe++;var It=(Se-Ae[Pe])/(Ae[Pe+1]-Ae[Pe]),Tt=Ee[Pe]+It*(Ee[Pe+1]-Ee[Pe]);return Tt})}}return b=[A,q],ye},ye.mode=function(D){return arguments.length?(l=D,pt(),ye):l},ye.range=function(D,se){return be(D),ye},ye.out=function(D){return F=D,ye},ye.spread=function(D){return arguments.length?(g=D,ye):g},ye.correctLightness=function(D){return D==null&&(D=!0),P=D,pt(),P?Fe=function(se){for(var me=Ze(0,!0).lab()[0],he=Ze(1,!0).lab()[0],tt=me>he,ze=Ze(se,!0).lab()[0],Ee=me+(he-me)*se,Ae=ze-Ee,Se=0,Pe=1,It=20;Math.abs(Ae)>.01&&It-- >0;)(function(){return tt&&(Ae*=-1),Ae<0?(Se=se,se+=(Pe-se)*.5):(Pe=se,se+=(Se-se)*.5),ze=Ze(se,!0).lab()[0],Ae=ze-Ee})();return se}:Fe=function(se){return se},ye},ye.padding=function(D){return D!=null?(er(D)==="number"&&(D=[D,D]),d=D,ye):d},ye.colors=function(D,se){arguments.length<2&&(se="hex");var me=[];if(arguments.length===0)me=y.slice(0);else if(D===1)me=[ye(.5)];else if(D>1){var he=b[0],tt=b[1]-he;me=Bo(0,D,!1).map(function(Pe){return ye(he+Pe/(D-1)*tt)})}else{a=[];var ze=[];if($&&$.length>2)for(var Ee=1,Ae=$.length,Se=1<=Ae;Se?Ee<Ae:Ee>Ae;Se?Ee++:Ee--)ze.push(($[Ee-1]+$[Ee])*.5);else ze=b;me=ze.map(function(Pe){return ye(Pe)})}return Mt[se]&&(me=me.map(function(Pe){return Pe[se]()})),me},ye.cache=function(D){return D!=null?(Y=D,ye):Y},ye.gamma=function(D){return D!=null?(ce=D,ye):ce},ye.nodata=function(D){return D!=null?(u=Mt(D),ye):u},ye};function Bo(a,l,u){for(var g=[],b=a<l,_=u?b?l+1:l-1:l,d=a;b?d<_:d>_;b?d++:d--)g.push(d);return g}var pr=L,Oo=Zr,To=function(a){for(var l=[1,1],u=1;u<a;u++){for(var g=[1],b=1;b<=l.length;b++)g[b]=(l[b]||0)+l[b-1];l=g}return l},No=function(a){var l,u,g,b,_,d,$;if(a=a.map(function(P){return new pr(P)}),a.length===2)l=a.map(function(P){return P.lab()}),_=l[0],d=l[1],b=function(P){var X=[0,1,2].map(function(Y){return _[Y]+P*(d[Y]-_[Y])});return new pr(X,"lab")};else if(a.length===3)u=a.map(function(P){return P.lab()}),_=u[0],d=u[1],$=u[2],b=function(P){var X=[0,1,2].map(function(Y){return(1-P)*(1-P)*_[Y]+2*(1-P)*P*d[Y]+P*P*$[Y]});return new pr(X,"lab")};else if(a.length===4){var y;g=a.map(function(P){return P.lab()}),_=g[0],d=g[1],$=g[2],y=g[3],b=function(P){var X=[0,1,2].map(function(Y){return(1-P)*(1-P)*(1-P)*_[Y]+3*(1-P)*(1-P)*P*d[Y]+3*(1-P)*P*P*$[Y]+P*P*P*y[Y]});return new pr(X,"lab")}}else if(a.length>=5){var F,A,q;F=a.map(function(P){return P.lab()}),q=a.length-1,A=To(q),b=function(P){var X=1-P,Y=[0,1,2].map(function(ce){return F.reduce(function(be,Ce,Fe){return be+A[Fe]*Math.pow(X,q-Fe)*Math.pow(P,Fe)*Ce[ce]},0)});return new pr(Y,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return b},zo=function(a){var l=No(a);return l.scale=function(){return Oo(l)},l},Kr=m,Ft=function(a,l,u){if(!Ft[u])throw new Error("unknown blend mode "+u);return Ft[u](a,l)},Bt=function(a){return function(l,u){var g=Kr(u).rgb(),b=Kr(l).rgb();return Kr.rgb(a(g,b))}},Ot=function(a){return function(l,u){var g=[];return g[0]=a(l[0],u[0]),g[1]=a(l[1],u[1]),g[2]=a(l[2],u[2]),g}},xo=function(a){return a},Uo=function(a,l){return a*l/255},jo=function(a,l){return a>l?l:a},qo=function(a,l){return a>l?a:l},Go=function(a,l){return 255*(1-(1-a/255)*(1-l/255))},Wo=function(a,l){return l<128?2*a*l/255:255*(1-2*(1-a/255)*(1-l/255))},Ho=function(a,l){return 255*(1-(1-l/255)/(a/255))},Vo=function(a,l){return a===255?255:(a=255*(l/255)/(1-a/255),a>255?255:a)};Ft.normal=Bt(Ot(xo)),Ft.multiply=Bt(Ot(Uo)),Ft.screen=Bt(Ot(Go)),Ft.overlay=Bt(Ot(Wo)),Ft.darken=Bt(Ot(jo)),Ft.lighten=Bt(Ot(qo)),Ft.dodge=Bt(Ot(Vo)),Ft.burn=Bt(Ot(Ho));for(var Yo=Ft,en=I.type,Qo=I.clip_rgb,Xo=I.TWOPI,Jo=Math.pow,Zo=Math.sin,Ko=Math.cos,ua=m,ef=function(a,l,u,g,b){a===void 0&&(a=300),l===void 0&&(l=-1.5),u===void 0&&(u=1),g===void 0&&(g=1),b===void 0&&(b=[0,1]);var _=0,d;en(b)==="array"?d=b[1]-b[0]:(d=0,b=[b,b]);var $=function(y){var F=Xo*((a+120)/360+l*y),A=Jo(b[0]+d*y,g),q=_!==0?u[0]+y*_:u,P=q*A*(1-A)/2,X=Ko(F),Y=Zo(F),ce=A+P*(-.14861*X+1.78277*Y),be=A+P*(-.29227*X-.90649*Y),Ce=A+P*(1.97294*X);return ua(Qo([ce*255,be*255,Ce*255,1]))};return $.start=function(y){return y==null?a:(a=y,$)},$.rotations=function(y){return y==null?l:(l=y,$)},$.gamma=function(y){return y==null?g:(g=y,$)},$.hue=function(y){return y==null?u:(u=y,en(u)==="array"?(_=u[1]-u[0],_===0&&(u=u[1])):_=0,$)},$.lightness=function(y){return y==null?b:(en(y)==="array"?(b=y,d=y[1]-y[0]):(b=[y,y],d=0),$)},$.scale=function(){return ua.scale($)},$.hue(u),$},tf=L,rf="0123456789abcdef",nf=Math.floor,af=Math.random,sf=function(){for(var a="#",l=0;l<6;l++)a+=rf.charAt(nf(af()*16));return new tf(a,"hex")},tn=h,ca=Math.log,lf=Math.pow,of=Math.floor,ff=Math.abs,ha=function(a,l){l===void 0&&(l=null);var u={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return tn(a)==="object"&&(a=Object.values(a)),a.forEach(function(g){l&&tn(g)==="object"&&(g=g[l]),g!=null&&!isNaN(g)&&(u.values.push(g),u.sum+=g,g<u.min&&(u.min=g),g>u.max&&(u.max=g),u.count+=1)}),u.domain=[u.min,u.max],u.limits=function(g,b){return ga(u,g,b)},u},ga=function(a,l,u){l===void 0&&(l="equal"),u===void 0&&(u=7),tn(a)=="array"&&(a=ha(a));var g=a.min,b=a.max,_=a.values.sort(function(nn,an){return nn-an});if(u===1)return[g,b];var d=[];if(l.substr(0,1)==="c"&&(d.push(g),d.push(b)),l.substr(0,1)==="e"){d.push(g);for(var $=1;$<u;$++)d.push(g+$/u*(b-g));d.push(b)}else if(l.substr(0,1)==="l"){if(g<=0)throw new Error("Logarithmic scales are only possible for values > 0");var y=Math.LOG10E*ca(g),F=Math.LOG10E*ca(b);d.push(g);for(var A=1;A<u;A++)d.push(lf(10,y+A/u*(F-y)));d.push(b)}else if(l.substr(0,1)==="q"){d.push(g);for(var q=1;q<u;q++){var P=(_.length-1)*q/u,X=of(P);if(X===P)d.push(_[X]);else{var Y=P-X;d.push(_[X]*(1-Y)+_[X+1]*Y)}}d.push(b)}else if(l.substr(0,1)==="k"){var ce,be=_.length,Ce=new Array(be),Fe=new Array(u),et=!0,Ze=0,pt=null;pt=[],pt.push(g);for(var ye=1;ye<u;ye++)pt.push(g+ye/u*(b-g));for(pt.push(b);et;){for(var D=0;D<u;D++)Fe[D]=0;for(var se=0;se<be;se++)for(var me=_[se],he=Number.MAX_VALUE,tt=void 0,ze=0;ze<u;ze++){var Ee=ff(pt[ze]-me);Ee<he&&(he=Ee,tt=ze),Fe[tt]++,Ce[se]=tt}for(var Ae=new Array(u),Se=0;Se<u;Se++)Ae[Se]=null;for(var Pe=0;Pe<be;Pe++)ce=Ce[Pe],Ae[ce]===null?Ae[ce]=_[Pe]:Ae[ce]+=_[Pe];for(var It=0;It<u;It++)Ae[It]*=1/Fe[It];et=!1;for(var Tt=0;Tt<u;Tt++)if(Ae[Tt]!==pt[Tt]){et=!0;break}pt=Ae,Ze++,Ze>200&&(et=!1)}for(var Nt={},tr=0;tr<u;tr++)Nt[tr]=[];for(var rr=0;rr<be;rr++)ce=Ce[rr],Nt[ce].push(_[rr]);for(var Rt=[],qt=0;qt<u;qt++)Rt.push(Nt[qt][0]),Rt.push(Nt[qt][Nt[qt].length-1]);Rt=Rt.sort(function(nn,an){return nn-an}),d.push(Rt[0]);for(var dr=1;dr<Rt.length;dr+=2){var Gt=Rt[dr];!isNaN(Gt)&&d.indexOf(Gt)===-1&&d.push(Gt)}}return d},pa={analyze:ha,limits:ga},da=L,uf=function(a,l){a=new da(a),l=new da(l);var u=a.luminance(),g=l.luminance();return u>g?(u+.05)/(g+.05):(g+.05)/(u+.05)},va=L,Dt=Math.sqrt,Qe=Math.pow,cf=Math.min,hf=Math.max,ma=Math.atan2,ba=Math.abs,Mr=Math.cos,_a=Math.sin,gf=Math.exp,wa=Math.PI,pf=function(a,l,u,g,b){u===void 0&&(u=1),g===void 0&&(g=1),b===void 0&&(b=1);var _=function(Gt){return 360*Gt/(2*wa)},d=function(Gt){return 2*wa*Gt/360};a=new va(a),l=new va(l);var $=Array.from(a.lab()),y=$[0],F=$[1],A=$[2],q=Array.from(l.lab()),P=q[0],X=q[1],Y=q[2],ce=(y+P)/2,be=Dt(Qe(F,2)+Qe(A,2)),Ce=Dt(Qe(X,2)+Qe(Y,2)),Fe=(be+Ce)/2,et=.5*(1-Dt(Qe(Fe,7)/(Qe(Fe,7)+Qe(25,7)))),Ze=F*(1+et),pt=X*(1+et),ye=Dt(Qe(Ze,2)+Qe(A,2)),D=Dt(Qe(pt,2)+Qe(Y,2)),se=(ye+D)/2,me=_(ma(A,Ze)),he=_(ma(Y,pt)),tt=me>=0?me:me+360,ze=he>=0?he:he+360,Ee=ba(tt-ze)>180?(tt+ze+360)/2:(tt+ze)/2,Ae=1-.17*Mr(d(Ee-30))+.24*Mr(d(2*Ee))+.32*Mr(d(3*Ee+6))-.2*Mr(d(4*Ee-63)),Se=ze-tt;Se=ba(Se)<=180?Se:ze<=tt?Se+360:Se-360,Se=2*Dt(ye*D)*_a(d(Se)/2);var Pe=P-y,It=D-ye,Tt=1+.015*Qe(ce-50,2)/Dt(20+Qe(ce-50,2)),Nt=1+.045*se,tr=1+.015*se*Ae,rr=30*gf(-Qe((Ee-275)/25,2)),Rt=2*Dt(Qe(se,7)/(Qe(se,7)+Qe(25,7))),qt=-Rt*_a(2*d(rr)),dr=Dt(Qe(Pe/(u*Tt),2)+Qe(It/(g*Nt),2)+Qe(Se/(b*tr),2)+qt*(It/(g*Nt))*(Se/(b*tr)));return hf(0,cf(100,dr))},ka=L,df=function(a,l,u){u===void 0&&(u="lab"),a=new ka(a),l=new ka(l);var g=a.get(u),b=l.get(u),_=0;for(var d in g){var $=(g[d]||0)-(b[d]||0);_+=$*$}return Math.sqrt(_)},vf=L,mf=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];try{return new(Function.prototype.bind.apply(vf,[null].concat(a))),!0}catch{return!1}},$a=m,ya=Zr,bf={cool:function(){return ya([$a.hsl(180,1,.9),$a.hsl(250,.7,.4)])},hot:function(){return ya(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Fr={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},rn=0,Ca=Object.keys(Fr);rn<Ca.length;rn+=1){var Ea=Ca[rn];Fr[Ea.toLowerCase()]=Fr[Ea]}var _f=Fr,Je=m;Je.average=Po,Je.bezier=zo,Je.blend=Yo,Je.cubehelix=ef,Je.mix=Je.interpolate=ta,Je.random=sf,Je.scale=Zr,Je.analyze=pa.analyze,Je.contrast=uf,Je.deltaE=pf,Je.distance=df,Je.limits=pa.limits,Je.valid=mf,Je.scales=bf,Je.colors=Tn,Je.brewer=_f;var wf=Je;return wf})})($s);var Ru=$s.exports;const ar=ds(Ru);function Bu(i){let e,t,n,r,s,o,c,f;return{c(){e=ee("div"),t=ee("label"),n=xe(i[1]),r=xe(":"),s=_e(),o=ee("input"),this.h()},l(h){e=te(h,"DIV",{class:!0});var p=G(e);t=te(p,"LABEL",{class:!0});var w=G(t);n=Ue(w,i[1]),r=Ue(w,":"),w.forEach(C),s=we(p),o=te(p,"INPUT",{type:!0,name:!0,id:!0,class:!0}),p.forEach(C),this.h()},h(){E(t,"class","pr-2 text-xs text-neutral-400 text-right"),E(o,"type","color"),E(o,"name",i[1]),E(o,"id",i[1]),E(o,"class","emboss py-1 px-2 bg-neutral-700 border border-neutral-800 text-xs text-neutral-200"),E(e,"class","flex items-center")},m(h,p){J(h,e,p),N(e,t),N(t,n),N(t,r),N(e,s),N(e,o),Ma(o,i[0]),c||(f=[$t(o,"input",i[2]),$t(o,"input",i[3])],c=!0)},p(h,[p]){p&2&&yt(n,h[1]),p&2&&E(o,"name",h[1]),p&2&&E(o,"id",h[1]),p&1&&Ma(o,h[0])},i:je,o:je,d(h){h&&C(e),c=!1,on(f)}}}function Ou(i,e,t){let{name:n}=e,{value:r="#0000FF"}=e;const s=mr();function o(f){if(f.target){const h=f.target;s("change",h.value)}}function c(){r=this.value,t(0,r)}return i.$$set=f=>{"name"in f&&t(1,n=f.name),"value"in f&&t(0,r=f.value)},[r,n,o,c]}class Tu extends rt{constructor(e){super(),nt(this,e,Ou,Bu,He,{name:1,value:0})}}function Nu(i){let e,t,n,r,s,o={personaSide:`${i[4]}Front`};t=new sr({props:o}),i[10](t),t.$on("ready",i[8]);let c={personaSide:`${i[4]}Back`};return r=new sr({props:c}),i[11](r),r.$on("ready",i[8]),{c(){e=ee("div"),ge(t.$$.fragment),n=_e(),ge(r.$$.fragment),this.h()},l(f){e=te(f,"DIV",{class:!0});var h=G(e);pe(t.$$.fragment,h),n=we(h),pe(r.$$.fragment,h),h.forEach(C),this.h()},h(){E(e,"class","flex w-full h-full")},m(f,h){J(f,e,h),de(t,e,null),N(e,n),de(r,e,null),s=!0},p(f,h){const p={};h&16&&(p.personaSide=`${f[4]}Front`),t.$set(p);const w={};h&16&&(w.personaSide=`${f[4]}Back`),r.$set(w)},i(f){s||(B(t.$$.fragment,f),B(r.$$.fragment,f),s=!0)},o(f){z(t.$$.fragment,f),z(r.$$.fragment,f),s=!1},d(f){f&&C(e),i[10](null),ve(t),i[11](null),ve(r)}}}function zu(i){let e,t;return e=new cr({props:{tabs:["Female","Male"],activeTab:i[4],caption:"Density Map",$$slots:{default:[Nu]},$$scope:{ctx:i}}}),e.$on("tabClick",i[7]),{c(){ge(e.$$.fragment)},l(n){pe(e.$$.fragment,n)},m(n,r){de(e,n,r),t=!0},p(n,r){const s={};r&16&&(s.activeTab=n[4]),r&4194332&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){ve(e,n)}}}function xu(i){let e,t,n,r,s,o,c,f,h,p;return n=new Tu({props:{value:i[1],name:"Color"}}),n.$on("change",i[6]),o=new Wt({props:{name:"Participants count",label:Object.keys(i[0].participants).length.toString()}}),h=new Wt({props:{name:`${i[4]} participants count`,label:i[5].toString()}}),{c(){e=ee("ul"),t=ee("li"),ge(n.$$.fragment),r=_e(),s=ee("li"),ge(o.$$.fragment),c=_e(),f=ee("li"),ge(h.$$.fragment),this.h()},l(w){e=te(w,"UL",{class:!0});var k=G(e);t=te(k,"LI",{});var O=G(t);pe(n.$$.fragment,O),O.forEach(C),r=we(k),s=te(k,"LI",{});var W=G(s);pe(o.$$.fragment,W),W.forEach(C),c=we(k),f=te(k,"LI",{});var I=G(f);pe(h.$$.fragment,I),I.forEach(C),k.forEach(C),this.h()},h(){E(e,"class","p-2")},m(w,k){J(w,e,k),N(e,t),de(n,t,null),N(e,r),N(e,s),de(o,s,null),N(e,c),N(e,f),de(h,f,null),p=!0},p(w,k){const O={};k&2&&(O.value=w[1]),n.$set(O);const W={};k&1&&(W.label=Object.keys(w[0].participants).length.toString()),o.$set(W);const I={};k&16&&(I.name=`${w[4]} participants count`),k&32&&(I.label=w[5].toString()),h.$set(I)},i(w){p||(B(n.$$.fragment,w),B(o.$$.fragment,w),B(h.$$.fragment,w),p=!0)},o(w){z(n.$$.fragment,w),z(o.$$.fragment,w),z(h.$$.fragment,w),p=!1},d(w){w&&C(e),ve(n),ve(o),ve(h)}}}function Uu(i){let e,t;return e=new cr({props:{tabs:["Details"],highlightTab:!1,$$slots:{default:[xu]},$$scope:{ctx:i}}}),{c(){ge(e.$$.fragment)},l(n){pe(e.$$.fragment,n)},m(n,r){de(e,n,r),t=!0},p(n,r){const s={};r&4194355&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){ve(e,n)}}}function as(i){let e,t;return e=new cn({props:{$$slots:{settings:[Uu],panels:[zu]},$$scope:{ctx:i}}}),{c(){ge(e.$$.fragment)},l(n){pe(e.$$.fragment,n)},m(n,r){de(e,n,r),t=!0},p(n,r){const s={};r&4194367&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){ve(e,n)}}}function ju(i){let e=i[4],t,n,r=as(i);return{c(){r.c(),t=Ke()},l(s){r.l(s),t=Ke()},m(s,o){r.m(s,o),J(s,t,o),n=!0},p(s,[o]){o&16&&He(e,e=s[4])?(it(),z(r,1,1,je),ot(),r=as(s),r.c(),B(r,1),r.m(t.parentNode,t)):r.p(s,o)},i(s){n||(B(r),n=!0)},o(s){z(r),n=!1},d(s){s&&C(t),r.d(s)}}}function qu(i,e,t){let n,{survey:r}=e,s,o,c="Female",f="#0000ff",h,p,w=0,k=0;const O=new Worker(new URL(""+new URL("../workers/binning.worker-0c4c5efe.js",import.meta.url).href,self.location),{type:"module"});function W(){return[{name:`DensityMap-${c}Front.png`,dataUrl:s.getImage()},{name:`DensityMap-${c}Back.png`,dataUrl:o.getImage()}]}function I(v){const M=[];for(const R of Object.values(r.participants)){const j=R.drawing[v];j&&M.push(j)}x(v,"Grouping drawings"),v.includes("Female"),t(5,w=M.length),w>0?(x(v,"Waiting"),O.postMessage({command:"getBins",params:{drawings:M,side:v.includes("Front")?"Front":"Back"}})):(k--,L(v))}function ne(v,M){let R,j;const re=n.domain([0,w]);x(v,"Drawing density map"),v==="Front"?(R=s.getCanvas(),j=s.getScaleFactor(),s.clear()):(R=o.getCanvas(),j=o.getScaleFactor(),o.clear());const fe=R.getContext("2d");if(fe==null)throw"Could not get context to draw density map.";for(let Be of M)fe.fillStyle=re(Be.length).hex(),fe.fillRect(Be.x*j,Be.y*j,j,j);L(v)}function le({detail:v}){t(1,f=v),ne("Front",h),ne("Back",p)}function oe({detail:v}){if(k>0){alert("Please wait until computations have completed.");return}t(4,c=v)}function T(v){const{personaSide:M}=v.detail;x(M,"Starting density computation"),k++,I(M)}function S(){O.onmessage=v=>{if(v.data.event==="bins"){const{side:M,bins:R}=v.data.params;M==="Front"?h=R:p=R,k--,ne(M,R)}else if(v.data.event==="progress"){const{side:M,msg:R}=v.data.params;x(M,R)}}}function x(v,M){v.includes("Front")?s.setMessage(M):o.setMessage(M)}function L(v){v.includes("Front")?s.clearMessage():o.clearMessage()}Lr(()=>{S()});function H(v){lt[v?"unshift":"push"](()=>{s=v,t(2,s)})}function m(v){lt[v?"unshift":"push"](()=>{o=v,t(3,o)})}return i.$$set=v=>{"survey"in v&&t(0,r=v.survey)},i.$$.update=()=>{i.$$.dirty&2&&(n=ar.scale([ar(f).alpha(0),ar(f)]))},[r,f,s,o,c,w,le,oe,T,W,H,m]}class Gu extends rt{constructor(e){super(),nt(this,e,qu,ju,He,{survey:0,getImages:9})}get survey(){return this.$$.ctx[0]}set survey(e){this.$$set({survey:e}),gs()}get getImages(){return this.$$.ctx[9]}}function Wu(i){let e,t,n,r,s,o={personaSide:`${i[3]}Front`};t=new sr({props:o}),i[8](t),t.$on("ready",i[6]);let c={personaSide:`${i[3]}Back`};return r=new sr({props:c}),i[9](r),r.$on("ready",i[6]),{c(){e=ee("div"),ge(t.$$.fragment),n=_e(),ge(r.$$.fragment),this.h()},l(f){e=te(f,"DIV",{class:!0});var h=G(e);pe(t.$$.fragment,h),n=we(h),pe(r.$$.fragment,h),h.forEach(C),this.h()},h(){E(e,"class","flex w-full h-full")},m(f,h){J(f,e,h),de(t,e,null),N(e,n),de(r,e,null),s=!0},p(f,h){const p={};h&8&&(p.personaSide=`${f[3]}Front`),t.$set(p);const w={};h&8&&(w.personaSide=`${f[3]}Back`),r.$set(w)},i(f){s||(B(t.$$.fragment,f),B(r.$$.fragment,f),s=!0)},o(f){z(t.$$.fragment,f),z(r.$$.fragment,f),s=!1},d(f){f&&C(e),i[8](null),ve(t),i[9](null),ve(r)}}}function Hu(i){let e,t;return e=new cr({props:{tabs:["Female","Male"],activeTab:i[3],caption:"Valence Map",$$slots:{default:[Wu]},$$scope:{ctx:i}}}),e.$on("tabClick",i[5]),{c(){ge(e.$$.fragment)},l(n){pe(e.$$.fragment,n)},m(n,r){de(e,n,r),t=!0},p(n,r){const s={};r&8&&(s.activeTab=n[3]),r&524302&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){ve(e,n)}}}function Vu(i){let e,t,n,r,s,o,c;return n=new Wt({props:{name:"Participants count",label:Object.keys(i[0].participants).length.toString()}}),o=new Wt({props:{name:`${i[3]} participants count`,label:i[4].toString()}}),{c(){e=ee("ul"),t=ee("li"),ge(n.$$.fragment),r=_e(),s=ee("li"),ge(o.$$.fragment),this.h()},l(f){e=te(f,"UL",{class:!0});var h=G(e);t=te(h,"LI",{});var p=G(t);pe(n.$$.fragment,p),p.forEach(C),r=we(h),s=te(h,"LI",{});var w=G(s);pe(o.$$.fragment,w),w.forEach(C),h.forEach(C),this.h()},h(){E(e,"class","p-2")},m(f,h){J(f,e,h),N(e,t),de(n,t,null),N(e,r),N(e,s),de(o,s,null),c=!0},p(f,h){const p={};h&1&&(p.label=Object.keys(f[0].participants).length.toString()),n.$set(p);const w={};h&8&&(w.name=`${f[3]} participants count`),h&16&&(w.label=f[4].toString()),o.$set(w)},i(f){c||(B(n.$$.fragment,f),B(o.$$.fragment,f),c=!0)},o(f){z(n.$$.fragment,f),z(o.$$.fragment,f),c=!1},d(f){f&&C(e),ve(n),ve(o)}}}function Yu(i){let e,t;return e=new cr({props:{tabs:["Details"],highlightTab:!1,$$slots:{default:[Vu]},$$scope:{ctx:i}}}),{c(){ge(e.$$.fragment)},l(n){pe(e.$$.fragment,n)},m(n,r){de(e,n,r),t=!0},p(n,r){const s={};r&524313&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){ve(e,n)}}}function ss(i){let e,t;return e=new cn({props:{$$slots:{settings:[Yu],panels:[Hu]},$$scope:{ctx:i}}}),{c(){ge(e.$$.fragment)},l(n){pe(e.$$.fragment,n)},m(n,r){de(e,n,r),t=!0},p(n,r){const s={};r&524319&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){ve(e,n)}}}function Qu(i){let e=i[3],t,n,r=ss(i);return{c(){r.c(),t=Ke()},l(s){r.l(s),t=Ke()},m(s,o){r.m(s,o),J(s,t,o),n=!0},p(s,[o]){o&8&&He(e,e=s[3])?(it(),z(r,1,1,je),ot(),r=ss(s),r.c(),B(r,1),r.m(t.parentNode,t)):r.p(s,o)},i(s){n||(B(r),n=!0)},o(s){z(r),n=!1},d(s){s&&C(t),r.d(s)}}}let Xu=1,Ju=1;function Zu(i,e,t){let{survey:n}=e,r,s,o="Female",c=0,f=0;const h=new Worker(new URL(""+new URL("../workers/binning.worker-0c4c5efe.js",import.meta.url).href,self.location),{type:"module"});function p(){return[{name:`ValenceMap-${o}Front.png`,dataUrl:r.getImage()},{name:`ValenceMap-${o}Back.png`,dataUrl:s.getImage()}]}function w(S){const x=[];for(const L of Object.values(n.participants)){const H=L.drawing[S];H&&x.push(H)}t(4,c=x.length),c>0?(ne(S,"Waiting"),h.postMessage({command:"getBins",params:{drawings:x,side:S.includes("Front")?"Front":"Back"}})):(f--,S.includes("Front")?r.clearMessage():s.clearMessage())}function k(S,x){const H=ar.scale(["red","green"]).domain([1,11]);let m,v;ne(S,"Drawing valence map"),S==="Front"?(m=r.getCanvas(),v=r.getScaleFactor()):(m=s.getCanvas(),v=s.getScaleFactor());const M=m.getContext("2d");if(M==null)throw"Could not get context to draw density map.";for(let R of x){const j=R.map(ke=>ke.valence),re=R.map(ke=>ke.intensity),fe=j.reduce((ke,U)=>ke+U,0)/R.length,Be=re.reduce((ke,U)=>ke+U,0)/R.length,De=H(fe),ae=ar.scale(["white",De]).domain([1,11])(Be),Q=ar.scale([ae.alpha(0),ae]).domain([0,c])(R.length);M.fillStyle=Q.hex(),M.fillRect(R.x*v,R.y*v,Xu,Ju)}le(S)}function O({detail:S}){if(f>0){alert("Please wait until computations have completed.");return}t(3,o=S)}function W(S){const{personaSide:x,width:L,height:H}=S.detail;ne(x,"Starting valence map computation"),f++,w(x)}function I(){h.onmessage=S=>{if(S.data.event==="bins"){const{side:x,bins:L}=S.data.params;x==="Front"?r.clearMessage():s.clearMessage(),f--,k(x,L)}else if(S.data.event==="progress"){const{side:x,msg:L}=S.data.params;ne(x,L)}}}function ne(S,x){S.includes("Front")?r.setMessage(x):s.setMessage(x)}function le(S){S.includes("Front")?r.clearMessage():s.clearMessage()}Lr(()=>{I()});function oe(S){lt[S?"unshift":"push"](()=>{r=S,t(1,r)})}function T(S){lt[S?"unshift":"push"](()=>{s=S,t(2,s)})}return i.$$set=S=>{"survey"in S&&t(0,n=S.survey)},[n,r,s,o,c,O,W,p,oe,T]}class Ku extends rt{constructor(e){super(),nt(this,e,Zu,Qu,He,{survey:0,getImages:7})}get getImages(){return this.$$.ctx[7]}}function ec(i){let e,t,n,r,s;return{c(){e=ee("div"),t=ee("button"),n=xe("Load Survey Data"),this.h()},l(o){e=te(o,"DIV",{class:!0});var c=G(e);t=te(c,"BUTTON",{class:!0});var f=G(t);n=Ue(f,"Load Survey Data"),f.forEach(C),c.forEach(C),this.h()},h(){E(t,"class","py-1 px-2 bg-neutral-600 hover:bg-neutral-700 border border-neutral-900 shadow text-neutral-100 text-xs"),E(e,"class","flex items-center justify-center w-full h-full bg-neutral-800")},m(o,c){J(o,e,c),N(e,t),N(t,n),r||(s=$t(t,"click",i[0]),r=!0)},p:je,i:je,o:je,d(o){o&&C(e),r=!1,s()}}}function tc(i){function e(t){Ar.call(this,i,t)}return[e]}class rc extends rt{constructor(e){super(),nt(this,e,tc,ec,He,{})}}function ls(i){let e,t,n={title:"Project",$$slots:{default:[oc]},$$scope:{ctx:i}};return e=new ks({props:n}),i[16](e),{c(){ge(e.$$.fragment)},l(r){pe(e.$$.fragment,r)},m(r,s){de(e,r,s),t=!0},p(r,s){const o={};s[0]&68|s[1]&128&&(o.$$scope={dirty:s,ctx:r}),e.$set(o)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){i[16](null),ve(e,r)}}}function nc(i){let e;return{c(){e=xe("Load Survey Data")},l(t){e=Ue(t,"Load Survey Data")},m(t,n){J(t,e,n)},d(t){t&&C(e)}}}function is(i){let e,t,n,r,s,o,c;e=new xt({props:{$$slots:{default:[ac]},$$scope:{ctx:i}}}),e.$on("click",i[13]);let f=i[6]===Xe.LookingGlass&&os(i);return r=new ru({}),o=new xt({props:{$$slots:{default:[ic]},$$scope:{ctx:i}}}),o.$on("click",i[10]),{c(){ge(e.$$.fragment),t=_e(),f&&f.c(),n=_e(),ge(r.$$.fragment),s=_e(),ge(o.$$.fragment)},l(h){pe(e.$$.fragment,h),t=we(h),f&&f.l(h),n=we(h),pe(r.$$.fragment,h),s=we(h),pe(o.$$.fragment,h)},m(h,p){de(e,h,p),J(h,t,p),f&&f.m(h,p),J(h,n,p),de(r,h,p),J(h,s,p),de(o,h,p),c=!0},p(h,p){const w={};p[1]&128&&(w.$$scope={dirty:p,ctx:h}),e.$set(w),h[6]===Xe.LookingGlass?f?(f.p(h,p),p[0]&64&&B(f,1)):(f=os(h),f.c(),B(f,1),f.m(n.parentNode,n)):f&&(it(),z(f,1,1,()=>{f=null}),ot());const k={};p[1]&128&&(k.$$scope={dirty:p,ctx:h}),o.$set(k)},i(h){c||(B(e.$$.fragment,h),B(f),B(r.$$.fragment,h),B(o.$$.fragment,h),c=!0)},o(h){z(e.$$.fragment,h),z(f),z(r.$$.fragment,h),z(o.$$.fragment,h),c=!1},d(h){ve(e,h),h&&C(t),f&&f.d(h),h&&C(n),ve(r,h),h&&C(s),ve(o,h)}}}function ac(i){let e;return{c(){e=xe("Export images")},l(t){e=Ue(t,"Export images")},m(t,n){J(t,e,n)},d(t){t&&C(e)}}}function os(i){let e,t,n,r;return e=new xt({props:{$$slots:{default:[sc]},$$scope:{ctx:i}}}),e.$on("click",i[14]),n=new xt({props:{$$slots:{default:[lc]},$$scope:{ctx:i}}}),n.$on("click",i[15]),{c(){ge(e.$$.fragment),t=_e(),ge(n.$$.fragment)},l(s){pe(e.$$.fragment,s),t=we(s),pe(n.$$.fragment,s)},m(s,o){de(e,s,o),J(s,t,o),de(n,s,o),r=!0},p(s,o){const c={};o[1]&128&&(c.$$scope={dirty:o,ctx:s}),e.$set(c);const f={};o[1]&128&&(f.$$scope={dirty:o,ctx:s}),n.$set(f)},i(s){r||(B(e.$$.fragment,s),B(n.$$.fragment,s),r=!0)},o(s){z(e.$$.fragment,s),z(n.$$.fragment,s),r=!1},d(s){ve(e,s),s&&C(t),ve(n,s)}}}function sc(i){let e;return{c(){e=xe("Export strokes")},l(t){e=Ue(t,"Export strokes")},m(t,n){J(t,e,n)},d(t){t&&C(e)}}}function lc(i){let e;return{c(){e=xe("Export pixel maps")},l(t){e=Ue(t,"Export pixel maps")},m(t,n){J(t,e,n)},d(t){t&&C(e)}}}function ic(i){let e;return{c(){e=xe("Close project")},l(t){e=Ue(t,"Close project")},m(t,n){J(t,e,n)},d(t){t&&C(e)}}}function oc(i){let e,t,n,r;e=new xt({props:{$$slots:{default:[nc]},$$scope:{ctx:i}}}),e.$on("click",i[9]);let s=i[2]&&is(i);return{c(){ge(e.$$.fragment),t=_e(),s&&s.c(),n=Ke()},l(o){pe(e.$$.fragment,o),t=we(o),s&&s.l(o),n=Ke()},m(o,c){de(e,o,c),J(o,t,c),s&&s.m(o,c),J(o,n,c),r=!0},p(o,c){const f={};c[1]&128&&(f.$$scope={dirty:c,ctx:o}),e.$set(f),o[2]?s?(s.p(o,c),c[0]&4&&B(s,1)):(s=is(o),s.c(),B(s,1),s.m(n.parentNode,n)):s&&(it(),z(s,1,1,()=>{s=null}),ot())},i(o){r||(B(e.$$.fragment,o),B(s),r=!0)},o(o){z(e.$$.fragment,o),z(s),r=!1},d(o){ve(e,o),o&&C(t),s&&s.d(o),o&&C(n)}}}function fs(i){let e,t,n={title:"Tools",enableIcon:!0,$$slots:{default:[dc]},$$scope:{ctx:i}};return e=new ks({props:n}),i[20](e),{c(){ge(e.$$.fragment)},l(r){pe(e.$$.fragment,r)},m(r,s){de(e,r,s),t=!0},p(r,s){const o={};s[0]&64|s[1]&128&&(o.$$scope={dirty:s,ctx:r}),e.$set(o)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){i[20](null),ve(e,r)}}}function fc(i){let e=Xe.LookingGlass+"",t;return{c(){t=xe(e)},l(n){t=Ue(n,e)},m(n,r){J(n,t,r)},p:je,d(n){n&&C(t)}}}function uc(i){let e,t,n;return{c(){e=ct("svg"),t=ct("path"),n=ct("path"),this.h()},l(r){e=ht(r,"svg",{slot:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0});var s=G(e);t=ht(s,"path",{stroke:!0,d:!0,fill:!0}),G(t).forEach(C),n=ht(s,"path",{d:!0}),G(n).forEach(C),s.forEach(C),this.h()},h(){E(t,"stroke","none"),E(t,"d","M0 0h24v24H0z"),E(t,"fill","none"),E(n,"d","M5 12l5 5l10 -10"),E(e,"slot","icon"),E(e,"xmlns","http://www.w3.org/2000/svg"),E(e,"width","14"),E(e,"height","14"),E(e,"viewBox","0 0 24 24"),E(e,"stroke-width","2"),E(e,"stroke","currentColor"),E(e,"fill","none"),E(e,"stroke-linecap","round"),E(e,"stroke-linejoin","round"),dt(e,"hidden",!i[37])},m(r,s){J(r,e,s),N(e,t),N(e,n)},p(r,s){s[1]&64&&dt(e,"hidden",!r[37])},d(r){r&&C(e)}}}function cc(i){let e=Xe.DensityMap+"",t;return{c(){t=xe(e)},l(n){t=Ue(n,e)},m(n,r){J(n,t,r)},p:je,d(n){n&&C(t)}}}function hc(i){let e,t,n;return{c(){e=ct("svg"),t=ct("path"),n=ct("path"),this.h()},l(r){e=ht(r,"svg",{slot:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0});var s=G(e);t=ht(s,"path",{stroke:!0,d:!0,fill:!0}),G(t).forEach(C),n=ht(s,"path",{d:!0}),G(n).forEach(C),s.forEach(C),this.h()},h(){E(t,"stroke","none"),E(t,"d","M0 0h24v24H0z"),E(t,"fill","none"),E(n,"d","M5 12l5 5l10 -10"),E(e,"slot","icon"),E(e,"xmlns","http://www.w3.org/2000/svg"),E(e,"width","16"),E(e,"height","16"),E(e,"viewBox","0 0 24 24"),E(e,"stroke-width","2"),E(e,"stroke","currentColor"),E(e,"fill","none"),E(e,"stroke-linecap","round"),E(e,"stroke-linejoin","round"),dt(e,"hidden",!i[37])},m(r,s){J(r,e,s),N(e,t),N(e,n)},p(r,s){s[1]&64&&dt(e,"hidden",!r[37])},d(r){r&&C(e)}}}function gc(i){let e=Xe.ValenceMap+"",t;return{c(){t=xe(e)},l(n){t=Ue(n,e)},m(n,r){J(n,t,r)},p:je,d(n){n&&C(t)}}}function pc(i){let e,t,n;return{c(){e=ct("svg"),t=ct("path"),n=ct("path"),this.h()},l(r){e=ht(r,"svg",{slot:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0});var s=G(e);t=ht(s,"path",{stroke:!0,d:!0,fill:!0}),G(t).forEach(C),n=ht(s,"path",{d:!0}),G(n).forEach(C),s.forEach(C),this.h()},h(){E(t,"stroke","none"),E(t,"d","M0 0h24v24H0z"),E(t,"fill","none"),E(n,"d","M5 12l5 5l10 -10"),E(e,"slot","icon"),E(e,"xmlns","http://www.w3.org/2000/svg"),E(e,"width","16"),E(e,"height","16"),E(e,"viewBox","0 0 24 24"),E(e,"stroke-width","2"),E(e,"stroke","currentColor"),E(e,"fill","none"),E(e,"stroke-linecap","round"),E(e,"stroke-linejoin","round"),dt(e,"hidden",!i[37])},m(r,s){J(r,e,s),N(e,t),N(e,n)},p(r,s){s[1]&64&&dt(e,"hidden",!r[37])},d(r){r&&C(e)}}}function dc(i){let e,t,n,r,s,o;return e=new xt({props:{isActive:i[6]===Xe.LookingGlass,$$slots:{icon:[uc,({isActive:c})=>({37:c}),({isActive:c})=>[0,c?64:0]],default:[fc]},$$scope:{ctx:i}}}),e.$on("click",i[17]),n=new xt({props:{isActive:i[6]===Xe.DensityMap,$$slots:{icon:[hc,({isActive:c})=>({37:c}),({isActive:c})=>[0,c?64:0]],default:[cc]},$$scope:{ctx:i}}}),n.$on("click",i[18]),s=new xt({props:{isActive:i[6]===Xe.ValenceMap,$$slots:{icon:[pc,({isActive:c})=>({37:c}),({isActive:c})=>[0,c?64:0]],default:[gc]},$$scope:{ctx:i}}}),s.$on("click",i[19]),{c(){ge(e.$$.fragment),t=_e(),ge(n.$$.fragment),r=_e(),ge(s.$$.fragment)},l(c){pe(e.$$.fragment,c),t=we(c),pe(n.$$.fragment,c),r=we(c),pe(s.$$.fragment,c)},m(c,f){de(e,c,f),J(c,t,f),de(n,c,f),J(c,r,f),de(s,c,f),o=!0},p(c,f){const h={};f[0]&64&&(h.isActive=c[6]===Xe.LookingGlass),f[1]&192&&(h.$$scope={dirty:f,ctx:c}),e.$set(h);const p={};f[0]&64&&(p.isActive=c[6]===Xe.DensityMap),f[1]&192&&(p.$$scope={dirty:f,ctx:c}),n.$set(p);const w={};f[0]&64&&(w.isActive=c[6]===Xe.ValenceMap),f[1]&192&&(w.$$scope={dirty:f,ctx:c}),s.$set(w)},i(c){o||(B(e.$$.fragment,c),B(n.$$.fragment,c),B(s.$$.fragment,c),o=!0)},o(c){z(e.$$.fragment,c),z(n.$$.fragment,c),z(s.$$.fragment,c),o=!1},d(c){ve(e,c),c&&C(t),ve(n,c),c&&C(r),ve(s,c)}}}function us(i){let e,t,n,r,s,o;return{c(){e=ee("div"),t=ct("svg"),n=ct("circle"),r=ct("path"),s=_e(),o=xe(i[8]),this.h()},l(c){e=te(c,"DIV",{class:!0});var f=G(e);t=ht(f,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var h=G(t);n=ht(h,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),G(n).forEach(C),r=ht(h,"path",{class:!0,fill:!0,d:!0}),G(r).forEach(C),h.forEach(C),s=we(f),o=Ue(f,i[8]),f.forEach(C),this.h()},h(){E(n,"class","opacity-25"),E(n,"cx","12"),E(n,"cy","12"),E(n,"r","10"),E(n,"stroke","currentColor"),E(n,"stroke-width","4"),E(r,"class","opacity-75"),E(r,"fill","currentColor"),E(r,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),E(t,"class","animate-spin -ml-1 mr-3 h-5 w-5 text-white"),E(t,"xmlns","http://www.w3.org/2000/svg"),E(t,"fill","none"),E(t,"viewBox","0 0 24 24"),E(e,"class","z-20 absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 flex items-center justify-center py-2 px-4 bg-neutral-800 text-neutral-400")},m(c,f){J(c,e,f),N(e,t),N(t,n),N(t,r),N(e,s),N(e,o)},p(c,f){f[0]&256&&yt(o,c[8])},d(c){c&&C(e)}}}function cs(i){let e,t;return e=new rc({}),e.$on("click",i[9]),{c(){ge(e.$$.fragment)},l(n){pe(e.$$.fragment,n)},m(n,r){de(e,n,r),t=!0},p:je,i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){ve(e,n)}}}function vc(i){let e,t,n,r,s,o,c,f,h,p,w,k,O,W,I,ne,le=i[3]===!1&&ls(i),oe=i[2]&&fs(i),T=i[3]&&us(i),S=i[7]===void 0&&cs(i);return{c(){e=ee("section"),t=ee("header"),le&&le.c(),n=_e(),oe&&oe.c(),r=_e(),s=ee("span"),o=_e(),c=ee("h1"),f=xe("InteroMap"),h=_e(),p=ee("main"),T&&T.c(),w=_e(),S&&S.c(),k=_e(),O=ee("input"),this.h()},l(x){e=te(x,"SECTION",{class:!0});var L=G(e);t=te(L,"HEADER",{class:!0});var H=G(t);le&&le.l(H),n=we(H),oe&&oe.l(H),r=we(H),s=te(H,"SPAN",{class:!0}),G(s).forEach(C),o=we(H),c=te(H,"H1",{class:!0,style:!0});var m=G(c);f=Ue(m,"InteroMap"),m.forEach(C),H.forEach(C),h=we(L),p=te(L,"MAIN",{class:!0});var v=G(p);T&&T.l(v),w=we(v),S&&S.l(v),v.forEach(C),L.forEach(C),k=we(x),O=te(x,"INPUT",{type:!0,class:!0,accept:!0}),this.h()},h(){E(s,"class","flex-grow"),E(c,"class","flex items-center h-full px-2 bg-gradient-to-t from-orange-600 to-orange-500 text-neutral-100 font-bold text-xs lowercase tracking-wider"),ln(c,"font-variant","small-caps"),E(t,"class","emboss z-20 flex items-center bg-neutral-600 border-b border-neutral-800"),E(p,"class","relative row-start-2 row-end-4"),E(e,"class","app-layout w-screen h-screen svelte-14urve1"),E(O,"type","file"),E(O,"class","hidden"),E(O,"accept",".csv")},m(x,L){J(x,e,L),N(e,t),le&&le.m(t,null),N(t,n),oe&&oe.m(t,null),N(t,r),N(t,s),N(t,o),N(t,c),N(c,f),N(e,h),N(e,p),T&&T.m(p,null),N(p,w),S&&S.m(p,null),i[21](p),J(x,k,L),J(x,O,L),i[22](O),W=!0,I||(ne=$t(O,"change",i[11]),I=!0)},p(x,L){x[3]===!1?le?(le.p(x,L),L[0]&8&&B(le,1)):(le=ls(x),le.c(),B(le,1),le.m(t,n)):le&&(it(),z(le,1,1,()=>{le=null}),ot()),x[2]?oe?(oe.p(x,L),L[0]&4&&B(oe,1)):(oe=fs(x),oe.c(),B(oe,1),oe.m(t,r)):oe&&(it(),z(oe,1,1,()=>{oe=null}),ot()),x[3]?T?T.p(x,L):(T=us(x),T.c(),T.m(p,w)):T&&(T.d(1),T=null),x[7]===void 0?S?(S.p(x,L),L[0]&128&&B(S,1)):(S=cs(x),S.c(),B(S,1),S.m(p,null)):S&&(it(),z(S,1,1,()=>{S=null}),ot())},i(x){W||(B(le),B(oe),B(S),W=!0)},o(x){z(le),z(oe),z(S),W=!1},d(x){x&&C(e),le&&le.d(),oe&&oe.d(),T&&T.d(),S&&S.d(),i[21](null),x&&C(k),x&&C(O),i[22](null),I=!1,ne()}}}function mc(i){return JSON.parse(i)}function sn(i,e){const t=document.createElement("a");t.href=e,t.target="_blank",t.download=i,t.click()}function bc(i,e,t){let n,r,s=!1,o=!1,c,f,h=Xe.LookingGlass,p=new Vf,w,k="Loading",O,W;function I(){r.click()}function ne(){w&&(w.$destroy(),t(7,w=void 0)),t(2,s=!1),t(3,o=!1),W=null}function le(){if(r.files&&r.files.length>0){if(ne(),W=prompt("Specify the Qualtrics variable you wish to load:"),W==null||W==="")throw alert("Error: You did not specify the Qualtrics variable."),ne(),"No Qualtrics variable specified. Aborting.";t(3,o=!0),oe(r.files[0])}}function oe(U){t(8,k="Reading file..."),Fa.parse(U,{worker:!0,header:!0,step:T,complete:S})}function T(U){const V=U.data;if(W&&W in V&&"ResponseId"in V)try{const ie=mc(V[W]);if(Object.keys(ie).every(ue=>["FemaleFront","FemaleBack","MaleFront","MaleBack"].includes(ue))){const ue=V.ResponseId,K=new vr({id:ue,drawing:ie});p.addParticipant(K)}}catch{return}}function S(){if(Object.keys(p.participants).length===0){const U=`Sorry, we could not parse any InteroMap data from your file.
      Maybe the Qualtrics variable is incorrect?`;throw alert(U),ne(),U}t(7,w=v(Xe.LookingGlass))}function x(U){U!==h&&t(7,w=v(U)),c.close()}function L(U){return new Du({target:n,props:{survey:U}})}function H(U){return new Gu({target:n,props:{survey:U}})}function m(U){return new Ku({target:n,props:{survey:U}})}function v(U){let V;switch(w&&w.$destroy(),U){case Xe.LookingGlass:V=L(p);break;case Xe.DensityMap:V=H(p);break;case Xe.ValenceMap:V=m(p);break;default:throw`Unknown tool: ${U}.`}return t(6,h=U),t(3,o=!1),t(2,s=!0),V}function M(){const U=w==null?void 0:w.getImages();U==null||U.forEach(V=>{sn(V.name,V.dataUrl)}),f.close()}function R(U){const ie=[["Participant ID","Stroke Valence","Stroke Intensity","Area (pixels)"]];for(const ue of U)for(const K in ue.areas){const[$e,Me]=K.split(":");ie.push([ue.id,$e,Me,ue.areas[K].toString()])}const Le=Fa.unparse(ie);return"data:text/csv;base64,"+btoa(Le)}function j(){const U=Object.values(p.participants).filter(V=>!V.computed);U.length>0?re(U):fe(),f.close()}async function re(U){t(3,o=!0),t(8,k="Loading persona bitmaps...");try{const[V,ie]=await Promise.all([zt.getPersonaBitmaps("Female"),zt.getPersonaBitmaps("Male")]);t(8,k="Computing stroke areas...");const Le=U.map(ue=>({id:ue.id,drawing:ue.drawing}));O==null||O.postMessage({command:"get-areas",params:{data:Le,femaleFrontBitmap:V.frontBitmap,femaleBackBitmap:V.backBitmap,maleFrontBitmap:ie.frontBitmap,maleBackBitmap:ie.backBitmap}},[V.frontBitmap,V.backBitmap,ie.frontBitmap,ie.backBitmap])}catch(V){console.error("Failed to load persona bitmaps:",V),alert("Failed to load persona images. Please try again."),t(3,o=!1)}}function fe(){const U=Object.values(p.participants).map(ie=>({id:ie.id,areas:ie.areas})),V=R(U);sn("InteroMap-Strokes.csv",V)}async function Be(){const U=await window.showSaveFilePicker({suggestedName:`pixel-maps-${W}.zip`});t(3,o=!0),t(8,k="Loading persona bitmaps...");try{const[V,ie]=await Promise.all([zt.getPersonaBitmaps("Female"),zt.getPersonaBitmaps("Male")]);t(8,k="Exporting pixel maps..."),O==null||O.postMessage({command:"get-pixelmaps-zip",params:{survey:p,fileHandle:U,femaleFrontBitmap:V.frontBitmap,femaleBackBitmap:V.backBitmap,maleFrontBitmap:ie.frontBitmap,maleBackBitmap:ie.backBitmap}},[V.frontBitmap,V.backBitmap,ie.frontBitmap,ie.backBitmap])}catch(V){console.error("Failed to load persona bitmaps:",V),alert("Failed to load persona images. Please try again."),t(3,o=!1)}f.close()}async function De(){const U=await hs(()=>import("../chunks/export.worker.e2567c66.js"),[],import.meta.url);O=new U.default,O.onmessage=V=>{if(V.data.event==="pixelmaps-zip-progress"||V.data.event==="areas-progress"){const{current:ie,total:Le,msg:ue}=V.data.params;t(8,k=`(${Math.round(100*ie/Le)}%) ${ue}`)}else if(V.data.event==="pixelmaps-done")t(3,o=!1);else if(V.data.event==="areas-done"){let ie=V.data.params;ie.forEach(({id:ue,areas:K,totalDrawingArea:$e})=>{const Me=p.getParticipant(ue);if(Me){const qe=new vr({id:Me.id,drawing:Me.drawing,areas:K,totalDrawingArea:$e,computed:!0});p.updateParticipant(qe)}}),ie=Object.values(p.participants).map(ue=>({id:ue.id,areas:ue.areas,totalDrawingArea:ue.totalDrawingArea}));const Le=R(ie);sn("InteroMap-Strokes.csv",Le),t(3,o=!1)}}}Lr(async()=>{De();try{await zt.preloadAllCanvases()}catch(U){console.warn("Failed to preload some persona bitmaps:",U)}});function Z(U){lt[U?"unshift":"push"](()=>{f=U,t(5,f)})}const Oe=()=>x(Xe.LookingGlass),ae=()=>x(Xe.DensityMap),at=()=>x(Xe.ValenceMap);function Ve(U){lt[U?"unshift":"push"](()=>{c=U,t(4,c)})}function Q(U){lt[U?"unshift":"push"](()=>{n=U,t(0,n)})}function ke(U){lt[U?"unshift":"push"](()=>{r=U,t(1,r)})}return[n,r,s,o,c,f,h,w,k,I,ne,le,x,M,j,Be,Z,Oe,ae,at,Ve,Q,ke]}class $c extends rt{constructor(e){super(),nt(this,e,bc,vc,He,{},null,[-1,-1])}}export{$c as default};
